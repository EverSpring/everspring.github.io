<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JRebel 2025.4.1æ¿€æ´»</title>
      <link href="/2025/11/16/jrebel-ji-huo/"/>
      <url>/2025/11/16/jrebel-ji-huo/</url>
      
        <content type="html"><![CDATA[<br/><h1 id="ç¯å¢ƒä¸èƒŒæ™¯"><a href="#ç¯å¢ƒä¸èƒŒæ™¯" class="headerlink" title="ç¯å¢ƒä¸èƒŒæ™¯"></a>ç¯å¢ƒä¸èƒŒæ™¯</h1><p>IDEA 2023.3.6ï¼ŒJRebel 2024.2.4ï¼Œä»£ç å·¥ç¨‹ springboot 3.4.7<br>é€šè¿‡JRebelå¯åŠ¨æ—¶å‡ºç°ä»¥ä¸‹å¼‚å¸¸ï¼ŒåŸå› å°±æ˜¯å½“å‰çš„JRebelç‰ˆæœ¬ä¸æ”¯æŒTomcat 10ï¼Œæœ€å¥½æ˜¯å‡çº§JRebelç‰ˆæœ¬ï¼Œä¸è¦å»åŠ¨ä»£ç </p><pre class="line-numbers language-none"><code class="language-none">org.apache.catalina.core.ContainerBase   : A child container failed during startjava.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to initialize component [StandardEngine[Tomcat].StandardHost[localhost].TomcatEmbeddedContext[]]    at java.base&#x2F;java.util.concurrent.FutureTask.report(FutureTask.java:122)    at java.base&#x2F;java.util.concurrent.FutureTask.get(FutureTask.java:191)    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:756)    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)    at java.base&#x2F;java.util.concurrent.FutureTask.run(FutureTask.java:264)    at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)    at java.base&#x2F;java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:412)    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)    at org.apache.catalina.startup.Tomcat.start(Tomcat.java:438)    at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)    at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.&lt;init&gt;(TomcatWebServer.java:107)    at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:517)    at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:219)    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:193)    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:167)    at org.springframework.context.support.AbstractApplicationContext.__refresh(AbstractApplicationContext.java:621)    at org.springframework.context.support.AbstractApplicationContext.jrLockAndRefresh(AbstractApplicationContext.java:41002)    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:42008)    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)    at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)Caused by: org.apache.catalina.LifecycleException: Failed to initialize component [StandardEngine[Tomcat].StandardHost[localhost].TomcatEmbeddedContext[]]    at org.apache.catalina.util.LifecycleBase.handleSubClassException(LifecycleBase.java:406)    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:125)    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:155)    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)    at java.base&#x2F;java.util.concurrent.FutureTask.run(FutureTask.java:264)    at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)    at java.base&#x2F;java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)    ... 31 common frames omittedCaused by: java.lang.NoSuchMethodError: &#39;boolean org.apache.catalina.webresources.TestResourceSet.isPathMounted(java.lang.String, java.lang.String)&#39;    at org.apache.catalina.webresources.TestResourceSet.listWebAppPaths(AbstractArchiveResourceSet.java:118)    at org.apache.catalina.webresources.TestResourceSet.doTest(AbstractArchiveResourceSet.java:41001)    at org.zeroturnaround.javarebel.catalina.JrTestResourceSet$1.run(SourceFile:37)    at org.zeroturnaround.javarebel.catalina.JrTestResourceSet$1.run(SourceFile:33)    at org.zeroturnaround.javarebel.integration.util.SecurityController.doWithoutSecurityManager(SourceFile:29)    at org.zeroturnaround.javarebel.catalina.JrTestResourceSet.checkPatchNeeded(SourceFile:33)    at org.apache.catalina.webresources.TestResourceSet.isPatchNeeded(AbstractArchiveResourceSet.java:42001)    at org.apache.catalina.webresources.AbstractArchiveResourceSet.&lt;clinit&gt;(AbstractArchiveResourceSet.java)    at org.apache.catalina.webresources.StandardRoot.createWebResourceSet(StandardRoot.java:396)    at org.apache.catalina.webresources.StandardRoot.createWebResourceSet(StandardRoot.java:360)    at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory$StaticResourceConfigurer.addResourceSet(TomcatServletWebServerFactory.java:864)    at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory$StaticResourceConfigurer.addResourceJars(TomcatServletWebServerFactory.java:841)    at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory$StaticResourceConfigurer.lifecycleEvent(TomcatServletWebServerFactory.java:828)    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:109)    at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:389)    at org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:121)    ... 38 common frames omitted<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="JRebelæ¿€æ´»"><a href="#JRebelæ¿€æ´»" class="headerlink" title="JRebelæ¿€æ´»"></a>JRebelæ¿€æ´»</h1><p>JRbelå‡çº§åˆ°äº†2025.4.1ï¼Œä»¥å‰ç”¨çš„æ˜¯<code>https://jrebel.qekang.com/</code>æ¥æ¿€æ´»ï¼Œè¿™ç§æ¿€æ´»ä¸ç”¨ä¸‹è½½ä»»ä½•ä¸œè¥¿ï¼Œç›´æ¥é…ç½®å°±å¯ä»¥ã€‚ç°åœ¨å‡çº§éœ€è¦å…ˆä¸‹è½½ä¸€ä¸ªä»£ç†  </p><ul><li>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½JRebelæ¿€æ´»æœåŠ¡å™¨<br>è®¿é—®GitHubå¼€æºé¡¹ç›®ï¼š<a href="https://github.com/yu-xiaoyao/jrebel-license-active-server">https://github.com/yu-xiaoyao/jrebel-license-active-server</a><br>æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿé€‰æ‹©å¯¹åº”ç‰ˆæœ¬ä¸‹è½½ã€‚</li><li>ç¬¬äºŒæ­¥ï¼šç”Ÿæˆguidï¼Œå¯é€šè¿‡ <a href="https://www.guidgen.com/">https://www.guidgen.com/</a> ç”Ÿæˆ</li><li>ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œæ¿€æ´»æœåŠ¡å™¨<br>ä¸‹è½½å®Œæˆåï¼Œç›´æ¥åŒå‡»è¿è¡Œå³å¯ã€‚ç¨‹åºå¯åŠ¨åä¼šæ˜¾ç¤ºä»£ç†ç«¯å£ä¿¡æ¯ï¼ˆé»˜è®¤ç«¯å£ä¸º12345ï¼‰<br><img src="/jrebel/img.png" alt="img.png"></li><li>ç¬¬å››æ­¥ï¼šJRebelä¸­æ¿€æ´»ï¼Œåœ°å€ä¸º<a href="http://127.0.0.1:12345/%E7%94%9F%E6%88%90%E7%9A%84guid%EF%BC%8C%E9%82%AE%E7%AE%B1%E9%9A%8F%E4%BE%BF%E5%A1%AB">http://127.0.0.1:12345/ç”Ÿæˆçš„guidï¼Œé‚®ç®±éšä¾¿å¡«</a><br><img src="/jrebel/img_1.png" alt="img_1.png"></li></ul><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><ul><li>å…³é—­è‡ªåŠ¨æ¿€æ´»</li></ul><p>ğŸ‘½ä¸ªäººåšå®¢ï¼š<a href="https://everspring.github.io/">https://everspring.github.io/</a><br>ğŸ‘½å…¬ä¼—å·ï¼šçˆ±å†å²çš„ITç”·</p>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JRebel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºLogback+MyBatisæ—¥å¿—è¾“å‡ºçš„ä¸€äº›æ€è€ƒ</title>
      <link href="/2022/09/29/guan-yu-mybatis-ri-zhi-shu-chu-de-yi-xie-si-kao/"/>
      <url>/2022/09/29/guan-yu-mybatis-ri-zhi-shu-chu-de-yi-xie-si-kao/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-ç¯å¢ƒ"><a href="#ä¸€-ç¯å¢ƒ" class="headerlink" title="ä¸€.ç¯å¢ƒ"></a>ä¸€.ç¯å¢ƒ</h1><p>MyBatis-Plusï¼š3.4.3.4</p><p>SpringBootï¼š2.5.8</p><p>Logbackï¼š1.2.9ï¼ˆSpringBootè‡ªåŠ¨ä¾èµ–ï¼‰</p><h1 id="äºŒ-é—®é¢˜"><a href="#äºŒ-é—®é¢˜" class="headerlink" title="äºŒ.é—®é¢˜"></a>äºŒ.é—®é¢˜</h1><ol><li>sqlè¯­å¥å’Œä¸šåŠ¡æ—¥å¿—åˆåœ¨ä¸€èµ·ï¼Œsqlå¤ªå¤šä¼šå½±å“ä¸šåŠ¡æ—¥å¿—åˆ†æï¼Œå› ä¸ºå¹³æ—¶ä¸éœ€è¦çœ‹ï¼Œå‡ºé—®é¢˜çš„æ—¶å€™æ‰ç”¨ä¸Šï¼Œæ‰€ä»¥sqlæ—¥å¿—å’Œä¸šåŠ¡æ—¥å¿—åº”è¯¥åˆ†æˆä¸åŒçš„æ–‡ä»¶è®°å½•</li><li>æœ‰äº›åœºæ™¯éœ€è¦å¼€å‘çš„æ—¶å€™åŒæ—¶åœ¨IDEæ§åˆ¶å°æ‰“å°sqlæ‰§è¡Œè¯­å¥ã€è¾“å‡ºsqlåˆ°æ—¥å¿—æ–‡ä»¶ä¸­</li><li>æ—¥å¿—åˆ†å¼€åï¼Œåˆä¼šå¯¼è‡´æŸ¥é—®é¢˜æ—¶ä¸å®¹æ˜“åˆ†æ¸…æ¥šæ˜¯å¦æ˜¯åŒä¸€æ¬¡è¯·æ±‚äº¤æ˜“ï¼Œç®€å•é€šè¿‡çº¿ç¨‹åã€æ—¶é—´ç‚¹æ¥åŒºåˆ†ä¹Ÿä¸æ–¹ä¾¿è€Œä¸”å®¹æ˜“å‡ºé”™</li><li>æœ‰æ—¶æ•°æ®ä¼šå› ä¸ºäº‹åŠ¡ç­‰åŸå› å¯¼è‡´å†™å…¥å¤±æ•ˆï¼Œéœ€è¦æŸ¥çœ‹äº‹åŠ¡æ—¥å¿—</li><li>ä¸šåŠ¡æ¨¡å—å¾ˆå¤šçš„å•ä½“åº”ç”¨ï¼Œæ‰€ä»¥æ—¥å¿—ç³…æ‚åœ¨ä¸€èµ·ï¼ŒæŸ¥çœ‹ä¸æ–¹ä¾¿ï¼ŒæŒ‰ç…§ä¸šåŠ¡æ¨¡å—è®°å½•åˆ°ä¸åŒçš„æ—¥å¿—æ–‡ä»¶ä¸­</li></ol><h1 id="ä¸‰-è§£ç­”"><a href="#ä¸‰-è§£ç­”" class="headerlink" title="ä¸‰.è§£ç­”"></a>ä¸‰.è§£ç­”</h1><p>å…ˆè´´å‡ºlogback.xmlçš„é…ç½®ï¼Œåé¢çš„è§£ç­”å°±æ˜¯æ­¤é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹</p><details><summary><b>å±•å¼€æŸ¥çœ‹logbacké…ç½®</b></summary><pre><code><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>60 seconds<span class="token punctuation">"</span></span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logger.path<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/home/logs<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment">&lt;!-- å½©è‰²æ—¥å¿— --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionRule</span> <span class="token attr-name">conversionWord</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clr<span class="token punctuation">"</span></span> <span class="token attr-name">converterClass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.boot.logging.logback.ColorConverter<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionRule</span> <span class="token attr-name">conversionWord</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wex<span class="token punctuation">"</span></span> <span class="token attr-name">converterClass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionRule</span> <span class="token attr-name">conversionWord</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wEx<span class="token punctuation">"</span></span> <span class="token attr-name">converterClass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment">&lt;!-- å½©è‰²æ—¥å¿—æ ¼å¼ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>CONSOLE_LOG_PATTERN<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;CONSOLE_LOG_PATTERN:-%clr(%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;)&#123;faint&#125; %clr($&#123;LOG_LEVEL_PATTERN:-%5p&#125;) %clr($&#123;PID:- &#125;)&#123;magenta&#125; %clr(---)&#123;faint&#125; %clr([%15.15t])&#123;faint&#125; %clr(%-40.40logger&#123;39&#125;-%line)&#123;cyan&#125; %clr(:)&#123;faint&#125; %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>CONSOLE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>DEBUG<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Pattern</span><span class="token punctuation">></span></span>$&#123;CONSOLE_LOG_PATTERN&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--></span>    <span class="token comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º DEBUG æ—¥å¿— --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG_FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/log_debug.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125;-%line - %m%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- è®¾ç½®å­—ç¬¦é›† --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- æ—¥å¿—å½’æ¡£ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/debug/log-debug-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•debugçº§åˆ«çš„ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>debug<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º INFO æ—¥å¿— --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO_FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/log_info.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125;-%line - %m%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/info/log-info-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•infoçº§åˆ«çš„ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º WARN æ—¥å¿— --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>WARN_FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/log_warn.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125;-%line - %m%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/warn/log-warn-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•warnçº§åˆ«çš„ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>warn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º ERROR æ—¥å¿— --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ERROR_FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/log_error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125;-%line - %m%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/error/log-error-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±æ€§        level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œ        ä¸èƒ½è®¾ç½®ä¸ºINHERITEDæˆ–è€…åŒä¹‰è¯NULLã€‚é»˜è®¤æ˜¯DEBUG        å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªloggerã€‚    --></span>    <span class="token comment">&lt;!-- æ‰“å°sqlï¼Œä½†ä¸æ‰“å°äº‹åŠ¡ç­‰ com.bank.mapperä¸ºæˆ‘è‡ªå·±mapperå­˜æ”¾çš„åŒ…å--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.bank.mapper<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>CONSOLE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG_FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ‰“å°äº‹åŠ¡ã€mapperæ³¨å†Œç­‰ä¿¡æ¯ï¼Œæ‰“å°åˆ°æ§åˆ¶å°ã€è®°å½•åˆ°debug_file --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.spring.SqlSessionUtils<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>CONSOLE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG_FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>CONSOLE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEBUG_FILE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO_FILE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>WARN_FILE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ERROR_FILE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></code></pre></details><ol><li>æŠŠä¸šåŠ¡æ—¥å¿—ä»£ç è®°å½•åˆ°infoçº§åˆ«çš„logä¸­ï¼Œå³é…ç½®ä¸­çš„log_info.logï¼›sqlæ—¥å¿—å’Œäº‹åŠ¡æ—¥å¿—è®°å½•åˆ°debugçº§åˆ«ä¸­ï¼Œå³log_debug.logã€‚é€šè¿‡ä¸¤ä¸ªä¸åŒçš„appenderå®ç°ã€‚</li><li>MyBatis-Plusçš„é…ç½®ä¸­é»˜è®¤æ”¯æŒæ‰“å°æ—¥å¿—åˆ°æ§åˆ¶å°æˆ–è€…è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼Œä½†ä¸èƒ½åŒæ—¶æ”¯æŒï¼Œè¦ä¹ˆåªåœ¨æ§åˆ¶å°æ‰“å°ï¼Œè¦ä¹ˆåªè¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ã€‚é»˜è®¤é…ç½®å³å¯èƒ½ä»¥ä¸‹é…ç½®å®ç°ï¼š</li></ol><pre class="line-numbers language-none"><code class="language-none">mybatis-plus:  configuration:    logImpl: org.apache.ibatis.logging.slf4j.Slf4jImpl # é»˜è®¤è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶    logImpl: org.apache.ibatis.logging.stdout.StdOutImpl #é»˜è®¤è¾“å‡ºåˆ°æ§åˆ¶å°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¸¥æ ¼åŒºåˆ†ç¯å¢ƒï¼Œä¸€èˆ¬æ˜¯ä¸éœ€è¦åŒæ—¶è¾“å‡ºçš„ã€‚</p><p>è§£å†³æ–¹å¼ï¼Œé€šè¿‡logbacké…ç½®å¤„ç†</p><ul><li>a) æ§åˆ¶å°çš„appenderçš„filter levelä¸ºdebugï¼Œå› ä¸ºmybatisä»£ç ä¸­äº‹åŠ¡æ‰“å°å’Œsqlæ‰“å°éƒ½æ˜¯debugçº§åˆ«ï¼›</li><li>b)æŒ‡å®š<code>&lt;logger&gt;</code>é…ç½®ã€‚<pre class="line-numbers language-none"><code class="language-none">&lt;logger name&#x3D;&quot;com.bank.mapper&quot; level&#x3D;&quot;DEBUG&quot;&gt;        &lt;appender-ref ref&#x3D;&quot;CONSOLE&quot;&#x2F;&gt;        &lt;appender-ref ref&#x3D;&quot;DEBUG_FILE&quot;&#x2F;&gt;    &lt;&#x2F;logger&gt;    &lt;!-- æ‰“å°äº‹åŠ¡ã€mapperæ³¨å†Œç­‰ä¿¡æ¯ï¼Œæ‰“å°åˆ°æ§åˆ¶å°ã€è®°å½•åˆ°debug_file --&gt;    &lt;logger name&#x3D;&quot;org.mybatis.spring.SqlSessionUtils&quot; level&#x3D;&quot;DEBUG&quot;&gt;        &lt;appender-ref ref&#x3D;&quot;CONSOLE&quot;&#x2F;&gt;        &lt;appender-ref ref&#x3D;&quot;DEBUG_FILE&quot;&#x2F;&gt;    &lt;&#x2F;logger&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>å…¶ä¸­<code>org.mybatis.spring.SqlSessionUtils</code>æ˜¯äº‹åŠ¡å¼€å¯ã€å…³é—­çš„æ—¥å¿—æ‰“å°ç±»ï¼Œå¦‚æœè¿˜éœ€æ‰“å°mapperçš„æ³¨å†Œä¿¡æ¯ç­‰ï¼Œå¯ä»¥æŒ‰packageæ‰“å°<code>org.mybatis.spring</code>ã€‚ä»¥ä¸‹ä¸ºäº‹åŠ¡æ‰“å°çš„å®ç°æ–¹æ³•ï¼Œå¯ä»¥çœ‹å‡ºéƒ½æ˜¯debugçº§åˆ«çš„<pre class="line-numbers language-none"><code class="language-none">if (environment.getTransactionFactory() instanceof SpringManagedTransactionFactory) &#123;        LOGGER.debug(() -&gt; &quot;Registering transaction synchronization for SqlSession [&quot; + session + &quot;]&quot;);        holder &#x3D; new SqlSessionHolder(session, executorType, exceptionTranslator);        TransactionSynchronizationManager.bindResource(sessionFactory, holder);        TransactionSynchronizationManager            .registerSynchronization(new SqlSessionSynchronization(holder, sessionFactory));        holder.setSynchronizedWithTransaction(true);        holder.requested();      &#125; else &#123;        if (TransactionSynchronizationManager.getResource(environment.getDataSource()) &#x3D;&#x3D; null) &#123;          LOGGER.debug(() -&gt; &quot;SqlSession [&quot; + session              + &quot;] was not registered for synchronization because DataSource is not transactional&quot;);        &#125; else &#123;          throw new TransientDataAccessResourceException(              &quot;SqlSessionFactory must be using a SpringManagedTransactionFactory in order to use Spring transaction synchronization&quot;);        &#125;      &#125;    &#125; else &#123;      LOGGER.debug(() -&gt; &quot;SqlSession [&quot; + session          + &quot;] was not registered for synchronization because synchronization is not active&quot;);    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ol start="3"><li><p>å…³äºsqlæ—¥å¿—å’Œä¸šåŠ¡æ—¥å¿—åˆ†æˆä¸åŒæ–‡ä»¶ï¼Œæ—¥å¿—æŸ¥çœ‹è¿è´¯æ€§å—å½±å“ï¼Œå¯ä»¥é€šè¿‡MDCå¤„ç†ï¼Œè§æˆ‘å¦ä¸€ç¯‡æ–‡ä»¶<a href="https://everspring.github.io/2022/08/23/mdc-xiang-jie/">MDCåœ¨å¤šçº¿ç¨‹ä¸­çš„ä½¿ç”¨</a>ï¼Œå†™å¥½MDCå®ç°åï¼Œåœ¨æ—¥å¿—ä¸­é…ç½®å¥½å³å¯ã€‚<br>ä¹Ÿå¯å¼•ç”¨è½»é‡æ—¥å¿—ç»„ä»¶<a href="https://gitee.com/dromara/TLog.git">TLog</a>ï¼Œå°±å¯ä»¥ä¸ç”¨å†è‡ªå·±å®ç°MDCï¼Œå‚è€ƒæ–‡ç« ï¼š<a href="https://tlog.yomahub.com/pages/eea781/">TLog MDCæ¨¡å¼ä¸‹logbackçš„é…ç½®</a></p></li><li><p>Logbackçš„<code>&lt;appender&gt;</code>+<code>&lt;logger&gt;</code>å¯ä»¥å¾ˆå¥½çš„è§£å†³æŒ‰ç…§ä¸åŒæ¨¡å—è®°å½•æ—¥å¿—ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼š</p></li></ol><ul><li>a) å·¥ç¨‹æŒ‰ç…§ä¸šåŠ¡æ¨¡å—åˆ’åˆ†æˆäº†ä¸åŒpackageï¼Œå¯ä»¥é€šè¿‡<code>&lt;appender&gt;</code>+<code>&lt;logger name=&quot;åŒ…å&quot;&gt;</code>ç»„åˆå®ç°ï¼Œæ­¤æ–¹å¼ä¸éœ€è¦ä¿®æ”¹javaä»£ç ï¼›</li><li>b) å¦‚æœä¸èƒ½æŒ‰ç…§packageåˆ’åˆ†ï¼Œå°±éœ€è¦é€šè¿‡ä»£ç ä¸­<code>Logger LOGGER = LoggerFactory.getLogger(&quot;logger nameçš„å€¼&quot;);</code>æ¥æŒ‡å®šï¼ˆå¦‚ç”¨äº†Lombokï¼Œå¯ç”¨<code>@Slf4j(topic=&quot;logger nameçš„å€¼&quot;)</code>ï¼‰<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º pbcæ¨¡å—INFO æ—¥å¿— --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_module_appender<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/pbc_log_info.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %C.%M-%line - %m%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>$&#123;logger.path&#125;/info/pbc_log-info-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•infoçº§åˆ«çš„ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ä¸šåŠ¡æ¨¡å— --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_module_logger<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_module_appender<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p><strong>æ³¨æ„ï¼š</strong>å¦‚æœç”¨äº†ä»£ç æ–¹å¼åŒ¹é…logger nameï¼Œæ—¥å¿—å¯èƒ½æ‰“å°å‡ºæ¥æ²¡æœ‰ç±»ã€æ–¹æ³•ä¿¡æ¯ï¼Œæ‰“å°å‡ºçš„æ˜¯<code>user_module_logger</code>ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™encoderé…ç½®çš„æ˜¯%loggerï¼Œè€Œ%loggerä¼šè¢«logger nameæ›¿æ¢ã€‚å¦‚è¦æ‰“å°å‡ºç±»ã€æ–¹æ³•ä¿¡æ¯ï¼Œ%loggeråº”æ”¹ä¸º%C.%Mï¼Œ%Cä»£è¡¨classï¼Œ%Mä»£è¡¨æ–¹æ³•ï¼Œå…·ä½“çš„å˜é‡å¯è§<code>ch.qos.logback.classic.PatternLayout</code>ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"lo"</span><span class="token punctuation">,</span> <span class="token class-name">LoggerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"logger"</span><span class="token punctuation">,</span> <span class="token class-name">LoggerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token class-name">LoggerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token class-name">ClassOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token class-name">ClassOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>CONVERTER_CLASS_TO_KEY_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ClassOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token class-name">MethodOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>DEFAULT_CONVERTER_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"method"</span><span class="token punctuation">,</span> <span class="token class-name">MethodOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>CONVERTER_CLASS_TO_KEY_MAP<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">MethodOfCallerConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¿— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MDCåœ¨å¤šçº¿ç¨‹ä¸­çš„ä½¿ç”¨</title>
      <link href="/2022/08/23/mdc-xiang-jie/"/>
      <url>/2022/08/23/mdc-xiang-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€äº†è§£MDC"><a href="#ä¸€ã€äº†è§£MDC" class="headerlink" title="ä¸€ã€äº†è§£MDC"></a>ä¸€ã€äº†è§£MDC</h1><p>MDCï¼ˆMapped Diagnostic Contextï¼Œæ˜ å°„è°ƒè¯•ä¸Šä¸‹æ–‡ï¼‰æ˜¯ slf4jæä¾›çš„ä¸€ç§è½»é‡çº§çš„æ—¥å¿—è·Ÿè¸ªå·¥å…·ã€‚Log4jã€Logbackæˆ–è€…Log4j2ç­‰æ—¥å¿—ä¸­æœ€å¸¸è§åŒºåˆ†åŒä¸€ä¸ªè¯·æ±‚çš„æ–¹å¼æ˜¯é€šè¿‡çº¿ç¨‹åï¼Œè€Œå¦‚æœ<br>è¯·æ±‚é‡å¤§ï¼Œçº¿ç¨‹ååœ¨ç›¸è¿‘çš„æ—¶é—´å†…ä¼šæœ‰å¾ˆå¤šé‡å¤çš„è€Œæ— æ³•åˆ†è¾¨ï¼Œå› æ­¤å¼•å‡ºäº†trace-idï¼Œå³åœ¨æ¥æ”¶åˆ°çš„æ—¶å€™ç”Ÿæˆå”¯ä¸€çš„è¯·æ±‚idï¼Œåœ¨æ•´ä¸ªæ‰§è¡Œé“¾è·¯ä¸­å¸¦ä¸Šæ­¤å”¯ä¸€id.<br>MDC.javaæœ¬èº«ä¸æä¾›ä¼ é€’traceIdçš„èƒ½åŠ›ï¼ŒçœŸæ­£æä¾›èƒ½åŠ›çš„æ˜¯<code>MDCAdapter</code>æ¥å£çš„å®ç°ã€‚æ¯”å¦‚Log4jçš„æ˜¯<code>Log4jMDCAdapter</code>ï¼ŒLogbackçš„æ˜¯<code>LogbackMDCAdapter</code>ã€‚</p><h1 id="äºŒã€MDCæ™®é€šä½¿ç”¨"><a href="#äºŒã€MDCæ™®é€šä½¿ç”¨" class="headerlink" title="äºŒã€MDCæ™®é€šä½¿ç”¨"></a>äºŒã€MDCæ™®é€šä½¿ç”¨</h1><ol><li>MDC.put(â€œtrace-idâ€, traceId); &#x2F;&#x2F; æ·»åŠ traceId</li><li>MDC.remove(â€œtrace-idâ€); &#x2F;&#x2F; ç§»é™¤traceId</li><li>åœ¨æ—¥å¿—é…ç½®æ–‡ä»¶ä¸­<code>&lt;pattern&gt;</code>èŠ‚ç‚¹ä¸­ä»¥<code>%X&#123;trace-id&#125;</code>å–å‡ºï¼Œæ¯”å¦‚ï¼š<code>&lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level [uniqid-%X&#123;trace-id&#125;] %logger&#123;50&#125;-%line - %m%n&lt;/pattern&gt;</code><br>ä»¥ä¸Šæ–¹å¼ï¼Œåªèƒ½åœ¨åšputæ“ä½œçš„å½“å‰çº¿ç¨‹ä¸­è·å–åˆ°å€¼ã€‚é‚£æ˜¯å› ä¸ºMDCçš„å®ç°åŸç†ä¸»è¦å°±æ˜¯ThreadLocalï¼ŒThreadLocalåªå¯¹å½“å‰çº¿ç¨‹æœ‰æ•ˆã€‚</li></ol><h1 id="ä¸‰ã€å¤šçº¿ç¨‹ä¸­çš„MDC"><a href="#ä¸‰ã€å¤šçº¿ç¨‹ä¸­çš„MDC" class="headerlink" title="ä¸‰ã€å¤šçº¿ç¨‹ä¸­çš„MDC"></a>ä¸‰ã€å¤šçº¿ç¨‹ä¸­çš„MDC</h1><p>è¦ç ´é™¤ThreadLocalåªå¯¹å½“å‰çº¿ç¨‹æœ‰çº¿çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š<br>ä¸€ç§æ˜¯JDKè‡ªå¸¦çš„ã€ThreadLocalçš„æ‰©å±•ç±»<code>InheritableThreadLocal</code>ï¼Œå­çº¿ç¨‹ä¼šæ‹·è´çˆ¶çº¿ç¨‹ä¸­çš„å˜é‡å€¼<br>ä¸€ç§æ˜¯å¼•å…¥alibaba<code>transmittable-thread-local</code>åŒ…çš„<code>TransmittableThreadLocal</code>å®ç°  </p><blockquote><p>æ®æˆ‘æ‰€çŸ¥ï¼Œåªæœ‰å­çº¿ç¨‹è·å–çˆ¶çº¿ç¨‹ï¼Œä¸èƒ½çˆ¶çº¿ç¨‹è·å–å­çº¿ç¨‹çš„å˜é‡ï¼Œå¦‚æœæœ‰çŸ¥é“çˆ¶è·å–å­çš„æ–¹æ³•ï¼Œéº»çƒ¦è¯´ä¸€ä¸‹ï¼Œè°¢è°¢</p></blockquote><p>Sl4jæœ¬èº«çš„æä¾›çš„<code>BasicMDCAdapter</code>å°±æ˜¯åŸºäº<code>InheritableThreadLocal</code>å®ç°äº†çº¿ç¨‹é—´ä¼ é€’ï¼Œä½†log4jã€logbackè¿™ä¸¤ä¸ªå®é™…çš„æ—¥å¿—å®ç°æ²¡æœ‰æä¾›ï¼Œlog4j2æä¾›äº†ä½†é»˜è®¤å…³é—­ã€‚</p><ol><li>log4j2ä¸»è¦æ˜¯æ ¹æ®<code>isThreadContextMapInheritable</code>å˜é‡æ§åˆ¶çš„ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š<ul><li>log4j2.component.propertiesæ–‡ä»¶ä¸­é…ç½®</li><li>ç±»å‹æ¨¡å—ä¸­å®šä¹‰,<code>System.setProperty(&quot;log4j2.isThreadContextMapInherimeble&quot;, &quot;true&quot;);</code></li></ul></li><li>lob4jå’Œlogbackéœ€è¦è‡ªå·±æ‰‹åŠ¨å®ç°ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯<code>æ‰‹åŠ¨åœ¨çº¿ç¨‹ä¸­çš„å¤„ç†</code>ï¼Œä¸€ç§æ˜¯é‡å†™<code>LogbackMDCAdapter</code>ã€‚æœ¬æ–‡ä»¥åœ¨çº¿ç¨‹æ± ä¸­åˆ›å»ºä¸ºä¾‹<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span>MDC<span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CollectionUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span><span class="token punctuation">;</span><span class="token comment">/** * @desc: å®šä¹‰MDCå·¥å…·ç±»ï¼Œæ”¯æŒRunnableå’ŒCallableä¸¤ç§ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†æŠŠçˆ¶çº¿ç¨‹çš„traceIdè®¾ç½®ç»™å­çº¿ç¨‹ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MdcUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> callable<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                MDC<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                MDC<span class="token punctuation">.</span><span class="token function">setContextMap</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> callable<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// æ¸…é™¤å­çº¿ç¨‹çš„ï¼Œé¿å…å†…å­˜æº¢å‡ºï¼Œå°±å’ŒThreadLocal.remove()ä¸€ä¸ªåŸå› </span>                MDC<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Runnable</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Runnable</span> runnable<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                MDC<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                MDC<span class="token punctuation">.</span><span class="token function">setContextMap</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                runnable<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>                MDC<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Future</span><span class="token punctuation">;</span><span class="token comment">/** * @desc: æŠŠå½“å‰çš„traceIdé€ä¼ åˆ°å­çº¿ç¨‹ç‰¹æ„åŠ çš„å®ç°ã€‚é‡ç‚¹å°±æ˜¯ MDC.getCopyOfContextMap()ï¼Œæ­¤æ–¹æ³•è·å–å½“å‰çº¿ç¨‹ï¼ˆçˆ¶çº¿ç¨‹ï¼‰çš„traceId */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPoolMdcExecutor</span> <span class="token keyword">extends</span> <span class="token class-name">ThreadPoolTaskExecutor</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">MdcUtil</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> MDC<span class="token punctuation">.</span><span class="token function">getCopyOfContextMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">MdcUtil</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> MDC<span class="token punctuation">.</span><span class="token function">getCopyOfContextMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> task<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">MdcUtil</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> MDC<span class="token punctuation">.</span><span class="token function">getCopyOfContextMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnProperty</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ThreadPoolTaskExecutor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">RejectedExecutionHandler</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ScheduledExecutorService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ScheduledThreadPoolExecutor</span><span class="token punctuation">;</span><span class="token comment">/** * çº¿ç¨‹æ± é…ç½®ã€‚é‡ç‚¹å°±æ˜¯æŠŠThreadPoolTaskExecutoræ¢æˆThreadPoolMdcExecutor **/</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPoolConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> <span class="token class-name">ThreadPoolProperties</span> threadPoolProperties<span class="token punctuation">;</span>    <span class="token comment">/**     * ä¸šåŠ¡ç”¨åˆ°çš„çº¿ç¨‹æ±      * @return     */</span>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"threadPoolTaskExecutor"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">ThreadPoolTaskExecutor</span> <span class="token function">threadPoolTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ThreadPoolTaskExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolMdcExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        executor<span class="token punctuation">.</span><span class="token function">setMaxPoolSize</span><span class="token punctuation">(</span>threadPoolProperties<span class="token punctuation">.</span><span class="token function">getMaxPoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        executor<span class="token punctuation">.</span><span class="token function">setCorePoolSize</span><span class="token punctuation">(</span>threadPoolProperties<span class="token punctuation">.</span><span class="token function">getCorePoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        executor<span class="token punctuation">.</span><span class="token function">setQueueCapacity</span><span class="token punctuation">(</span>threadPoolProperties<span class="token punctuation">.</span><span class="token function">getQueueCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        executor<span class="token punctuation">.</span><span class="token function">setKeepAliveSeconds</span><span class="token punctuation">(</span>threadPoolProperties<span class="token punctuation">.</span><span class="token function">getKeepAliveSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RejectedExecutionHandler</span> handler <span class="token operator">=</span> <span class="token class-name">ReflectUtil</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>threadPoolProperties<span class="token punctuation">.</span><span class="token function">getRejectedExecutionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClazz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        executor<span class="token punctuation">.</span><span class="token function">setRejectedExecutionHandler</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> executor<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¨èæ–‡ç« ï¼š</p><ol><li><a href="https://www.cnblogs.com/yangyongjie/p/12523567.html">https://www.cnblogs.com/yangyongjie/p/12523567.html</a></li><li><a href="https://blog.csdn.net/zlt2000/article/details/99641821">https://blog.csdn.net/zlt2000/article/details/99641821</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MDC </tag>
            
            <tag> å¤šçº¿ç¨‹æ—¥å¿— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç«¯JAVAå¼€å‘è§„èŒƒ</title>
      <link href="/2022/08/14/hou-duan-java-kai-fa-gui-fan/"/>
      <url>/2022/08/14/hou-duan-java-kai-fa-gui-fan/</url>
      
        <content type="html"><![CDATA[<p>æ ¹æ®åŸå…¬å¸è§„èŒƒã€é˜¿é‡Œå·´å·´JAVAè§„èŒƒå½¢æˆ</p><h2 id="åç«¯JAVAå¼€å‘è§„èŒƒ"><a href="#åç«¯JAVAå¼€å‘è§„èŒƒ" class="headerlink" title="åç«¯JAVAå¼€å‘è§„èŒƒ"></a>åç«¯JAVAå¼€å‘è§„èŒƒ</h2><p>JAVAå¼€å‘è§„èŒƒä¸€èŠ‚å€Ÿé‰´äº†ã€Šé˜¿é‡Œå·´å·´JAVAå¼€å‘æ‰‹å†Œã€‹ï¼Œæ ¹æ®å…¬å¸æƒ…å†µåšäº†ä¸€äº›åˆ å‡ã€è¡¥å……ï¼Œå»ºè®®å¤§å®¶åœ¨ç½‘ä¸Šä¸‹è½½ã€Šé˜¿é‡Œå·´å·´JAVAå¼€å‘æ‰‹å†Œã€‹å½“å‰æœ€æ–°ç‰ˆæœ¬ä¸ºåµ©å±±ç‰ˆï¼ˆæˆªæ­¢2022.1.18ï¼‰ä»”ç»†é˜…è¯»ï¼Œå®˜æ–¹åœ°å€ï¼š<a href="https://github.com/alibaba/p3c">https://github.com/alibaba/p3c</a><br>å»ºè®®å¤§å®¶å®‰è£…ä»£ç æ£€æŸ¥å·¥å…·ï¼Œæ¯”å¦‚ï¼šAlibaba Java Coding Guidelinesã€SpotBugsã€SonarLintç­‰ï¼Œå¼€å‘å®Œæˆååšä»£ç æ‰«æ</p><h4 id="ä¸€ã€-å‘½å"><a href="#ä¸€ã€-å‘½å" class="headerlink" title="ä¸€ã€ å‘½å"></a>ä¸€ã€ å‘½å</h4><ol><li>ã€å¼ºåˆ¶ã€‘ç±»åä½¿ç”¨ UpperCamelCase é£æ ¼ï¼Œä½†ä»¥ä¸‹æƒ…å½¢ä¾‹å¤–ï¼šDO &#x2F; BO &#x2F; DTO &#x2F; VO &#x2F; AO &#x2F; PO &#x2F; UID ç­‰<br>æ­£ä¾‹ï¼šForceCode &#x2F; UserDO &#x2F; HtmlDTO &#x2F; XmlService &#x2F; TcpUdpDeal &#x2F; TaPromotion<br>åä¾‹ï¼šforcecode &#x2F; UserDo &#x2F; HTMLDto &#x2F; XMLService &#x2F; TCPUDPDeal &#x2F; TAPromotion</li><li>ã€å¼ºåˆ¶ã€‘æ–¹æ³•åã€å‚æ•°åã€æˆå‘˜å˜é‡ã€å±€éƒ¨å˜é‡éƒ½ç»Ÿä¸€ä½¿ç”¨ lowerCamelCase é£æ ¼ã€‚<br>æ­£ä¾‹ï¼š localValue &#x2F; getHttpMessage() &#x2F; inputUserId</li><li>ã€å¼ºåˆ¶ã€‘å¸¸é‡å‘½åå…¨éƒ¨å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿éš”å¼€ï¼ŒåŠ›æ±‚è¯­ä¹‰è¡¨è¾¾å®Œæ•´æ¸…æ¥šï¼Œä¸è¦å«Œåå­—é•¿ã€‚<br>æ­£ä¾‹ï¼šMAX_STOCK_COUNT &#x2F; CACHE_EXPIRED_TIME<br>åä¾‹ï¼šMAX_COUNT &#x2F; EXPIRED_TIME</li><li>ã€å¼ºåˆ¶ã€‘æŠ½è±¡ç±»å‘½åä½¿ç”¨ Abstract æˆ– Base å¼€å¤´ï¼›å¼‚å¸¸ç±»å‘½åä½¿ç”¨ Exception ç»“å°¾ï¼›æµ‹è¯•ç±»å‘½åä»¥å®ƒè¦æµ‹è¯•çš„ç±»çš„åç§°å¼€å§‹ï¼Œä»¥ Test ç»“å°¾</li><li>ã€å¼ºåˆ¶ã€‘ç±»å‹ä¸ä¸­æ‹¬å·ç´§æŒ¨ç›¸è¿æ¥è¡¨ç¤ºæ•°ç»„ã€‚<br>æ­£ä¾‹ï¼šå®šä¹‰æ•´å½¢æ•°ç»„ int[] arrayDemoã€‚<br>åä¾‹ï¼šåœ¨ main å‚æ•°ä¸­ï¼Œä½¿ç”¨ String args[]æ¥å®šä¹‰</li><li>ã€å¼ºåˆ¶ã€‘POJO ç±»ä¸­çš„ä»»ä½•å¸ƒå°”ç±»å‹çš„å˜é‡ï¼Œéƒ½ä¸è¦åŠ  is å‰ç¼€ï¼Œå¦åˆ™éƒ¨åˆ†æ¡†æ¶è§£æä¼šå¼•èµ·åºåˆ—åŒ–é”™è¯¯</li><li>ã€å¼ºåˆ¶ã€‘åŒ…åç»Ÿä¸€ä½¿ç”¨å°å†™ï¼Œç‚¹åˆ†éš”ç¬¦ä¹‹é—´æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè‡ªç„¶è¯­ä¹‰çš„è‹±è¯­å•è¯ã€‚åŒ…åç»Ÿä¸€ä½¿ç”¨å•æ•°å½¢å¼ï¼Œä½†æ˜¯ç±»åå¦‚æœæœ‰å¤æ•°å«ä¹‰ï¼Œç±»åå¯ä»¥ä½¿ç”¨å¤æ•°å½¢å¼<br>æ­£ä¾‹ï¼šåº”ç”¨å·¥å…·ç±»åŒ…åä¸º com.alibaba.ei.kunlun.aap.utilã€ç±»åä¸º MessageUtilsï¼ˆæ­¤è§„åˆ™å‚è€ƒ spring çš„æ¡†æ¶ç»“æ„ï¼‰</li><li>ã€å¼ºåˆ¶ã€‘é¿å…åœ¨å­çˆ¶ç±»çš„æˆå‘˜å˜é‡ä¹‹é—´ã€æˆ–è€…ä¸åŒä»£ç å—çš„å±€éƒ¨å˜é‡ä¹‹é—´é‡‡ç”¨å®Œå…¨ç›¸åŒçš„å‘½åï¼Œä½¿å¯ç†è§£æ€§é™ä½ã€‚è¯´æ˜ï¼šå­ç±»ã€çˆ¶ç±»æˆå‘˜å˜é‡åç›¸åŒï¼Œå³ä½¿æ˜¯ public ç±»å‹çš„å˜é‡ä¹Ÿèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œå¦å¤–ï¼Œå±€éƒ¨å˜é‡åœ¨åŒä¸€æ–¹æ³•å†…çš„ä¸åŒä»£ç å—ä¸­åŒåä¹Ÿæ˜¯åˆæ³•çš„ï¼Œè¿™äº›æƒ…å†µéƒ½è¦é¿å…ã€‚å¯¹äºé setter&#x2F;getter çš„å‚æ•°åç§°ä¹Ÿè¦é¿å…ä¸æˆå‘˜å˜é‡åç§°ç›¸åŒã€‚</li><li>ã€å‚è€ƒã€‘æšä¸¾ç±»åå¸¦ä¸Š Enum åç¼€ï¼Œæšä¸¾æˆå‘˜åç§°éœ€è¦å…¨å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿éš”å¼€<br>è¯´æ˜ï¼šæšä¸¾å…¶å®å°±æ˜¯ç‰¹æ®Šçš„å¸¸é‡ç±»ï¼Œä¸”æ„é€ æ–¹æ³•è¢«é»˜è®¤å¼ºåˆ¶æ˜¯ç§æœ‰<br>æ­£ä¾‹ï¼šæšä¸¾åå­—ä¸º ProcessStatusEnum çš„æˆå‘˜åç§°ï¼šSUCCESS &#x2F; UNKNOWN_REASON</li></ol><h4 id="äºŒã€-OOPè§„çº¦"><a href="#äºŒã€-OOPè§„çº¦" class="headerlink" title="äºŒã€ OOPè§„çº¦"></a>äºŒã€ OOPè§„çº¦</h4><ol><li>ã€å¼ºåˆ¶ã€‘é¿å…é€šè¿‡ä¸€ä¸ªç±»çš„å¯¹è±¡å¼•ç”¨è®¿é—®æ­¤ç±»çš„é™æ€å˜é‡æˆ–é™æ€æ–¹æ³•ï¼Œæ— è°“å¢åŠ ç¼–è¯‘å™¨è§£ææˆæœ¬ï¼Œç›´æ¥ç”¨ç±»åæ¥è®¿é—®å³å¯</li><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰çš„è¦†å†™æ–¹æ³•ï¼Œå¿…é¡»åŠ @Override æ³¨è§£<br>è¯´æ˜ï¼šgetObject()ä¸ get0bject()çš„é—®é¢˜ã€‚ä¸€ä¸ªæ˜¯å­—æ¯çš„ Oï¼Œä¸€ä¸ªæ˜¯æ•°å­—çš„ 0ï¼ŒåŠ @Override å¯ä»¥å‡†ç¡®åˆ¤æ–­æ˜¯å¦è¦†ç›–æˆåŠŸã€‚å¦å¤–ï¼Œå¦‚æœåœ¨æŠ½è±¡ç±»ä¸­å¯¹æ–¹æ³•ç­¾åè¿›è¡Œä¿®æ”¹ï¼Œå…¶å®ç°ç±»ä¼šé©¬ä¸Šç¼–è¯‘æŠ¥é”™</li><li>ã€å¼ºåˆ¶ã€‘ç›¸åŒå‚æ•°ç±»å‹ï¼Œç›¸åŒä¸šåŠ¡å«ä¹‰ï¼Œæ‰å¯ä»¥ä½¿ç”¨ Java çš„å¯å˜å‚æ•°ï¼Œé¿å…ä½¿ç”¨ Object<br>è¯´æ˜ï¼šå¯å˜å‚æ•°å¿…é¡»æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åï¼ˆå»ºè®®å¼€å‘è€…å°½é‡ä¸ç”¨å¯å˜å‚æ•°ç¼–ç¨‹ï¼‰<br>æ­£ä¾‹ï¼špublic List<User> listUsers(String type, Longâ€¦ ids) {â€¦}</li><li>ã€å¼ºåˆ¶ã€‘Object çš„ equals æ–¹æ³•å®¹æ˜“æŠ›ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œåº”ä½¿ç”¨å¸¸é‡æˆ–ç¡®å®šæœ‰å€¼çš„å¯¹è±¡æ¥è°ƒç”¨ equals<br>æ­£ä¾‹ï¼šâ€testâ€.equals(object)<br>åä¾‹ï¼šobject.equals(â€œtestâ€);<br>è¯´æ˜ï¼šæ¨èä½¿ç”¨ JDK7 å¼•å…¥çš„å·¥å…·ç±» java.util.Objects#equals(Object a, Object b)</li><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰æ•´å‹åŒ…è£…ç±»å¯¹è±¡ä¹‹é—´å€¼çš„æ¯”è¾ƒï¼Œå…¨éƒ¨ä½¿ç”¨ equals æ–¹æ³•æ¯”è¾ƒ</li><li>ã€å¼ºåˆ¶ã€‘ä»»ä½•è´§å¸é‡‘é¢ï¼Œå‡ä»¥æœ€å°è´§å¸å•ä½ä¸”æ•´å‹ç±»å‹æ¥è¿›è¡Œå­˜</li><li>ã€å¼ºåˆ¶ã€‘æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨&#x3D;&#x3D;æ¥æ¯”è¾ƒï¼ŒåŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨ equalsæ¥åˆ¤æ–­</li><li>ã€å¼ºåˆ¶ã€‘æµ®ç‚¹æ•°ä¹‹é—´çš„ç­‰å€¼åˆ¤æ–­ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ç”¨&#x3D;&#x3D;æ¥æ¯”è¾ƒï¼ŒåŒ…è£…æ•°æ®ç±»å‹ä¸èƒ½ç”¨ equalsæ¥åˆ¤æ–­<br>è¯´æ˜ï¼šequals()æ–¹æ³•ä¼šæ¯”è¾ƒå€¼å’Œç²¾åº¦ï¼ˆ1.0 ä¸ 1.00 è¿”å›ç»“æœä¸º falseï¼‰ï¼Œè€Œ compareTo()åˆ™ä¼šå¿½ç•¥ç²¾åº¦</li><li>ã€å¼ºåˆ¶ã€‘å®šä¹‰æ•°æ®å¯¹è±¡ DO ç±»æ—¶ï¼Œå±æ€§ç±»å‹è¦ä¸æ•°æ®åº“å­—æ®µç±»å‹ç›¸åŒ¹é…<br>æ­£ä¾‹ï¼šæ•°æ®åº“å­—æ®µçš„ bigint å¿…é¡»ä¸ç±»å±æ€§çš„ Long ç±»å‹ç›¸å¯¹åº”<br>åä¾‹ï¼šæŸä¸ªæ¡ˆä¾‹çš„æ•°æ®åº“è¡¨ id å­—æ®µå®šä¹‰ç±»å‹ bigint unsignedï¼Œå®é™…ç±»å¯¹è±¡å±æ€§ä¸º Integerï¼Œéšç€ id è¶Šæ¥è¶Šå¤§ï¼Œè¶…è¿‡ Integer çš„è¡¨ç¤ºèŒƒå›´è€Œæº¢å‡ºæˆä¸ºè´Ÿæ•°</li><li>ã€å¼ºåˆ¶ã€‘ç¦æ­¢ä½¿ç”¨æ„é€ æ–¹æ³• BigDecimal(double)çš„æ–¹å¼æŠŠ double å€¼è½¬åŒ–ä¸º BigDecimal å¯¹è±¡<br>è¯´æ˜ï¼šBigDecimal(double)å­˜åœ¨ç²¾åº¦æŸå¤±é£é™©ï¼Œåœ¨ç²¾ç¡®è®¡ç®—æˆ–å€¼æ¯”è¾ƒçš„åœºæ™¯ä¸­å¯èƒ½ä¼šå¯¼è‡´ä¸šåŠ¡é€»è¾‘å¼‚å¸¸ã€‚<br>å¦‚ï¼šBigDecimal g &#x3D; new BigDecimal(0.1F); å®é™…çš„å­˜å‚¨å€¼ä¸ºï¼š0.10000000149<br>æ­£ä¾‹ï¼šä¼˜å…ˆæ¨èå…¥å‚ä¸º String çš„æ„é€ æ–¹æ³•ï¼Œæˆ–ä½¿ç”¨ BigDecimal çš„ valueOf æ–¹æ³•ï¼Œæ­¤æ–¹æ³•å†…éƒ¨å…¶å®æ‰§è¡Œäº†Double çš„ toStringï¼Œè€Œ Double çš„ toString æŒ‰ double çš„å®é™…èƒ½è¡¨è¾¾çš„ç²¾åº¦å¯¹å°¾æ•°è¿›è¡Œäº†æˆªæ–­ã€‚<pre class="line-numbers language-none"><code class="language-none">BigDecimal recommend1 &#x3D; new BigDecimal(&quot;0.1&quot;);BigDecimal recommend2 &#x3D; BigDecimal.valueOf(0.1);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>å…³äºåŸºæœ¬æ•°æ®ç±»å‹ä¸åŒ…è£…æ•°æ®ç±»å‹çš„ä½¿ç”¨æ ‡å‡†å¦‚ä¸‹<ul><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰çš„ POJO ç±»å±æ€§å¿…é¡»ä½¿ç”¨åŒ…è£…æ•°æ®ç±»å‹</li><li>ã€å¼ºåˆ¶ã€‘RPC æ–¹æ³•çš„è¿”å›å€¼å’Œå‚æ•°å¿…é¡»ä½¿ç”¨åŒ…è£…æ•°æ®ç±»å‹<br>æ­£ä¾‹ï¼šæ•°æ®åº“çš„æŸ¥è¯¢ç»“æœå¯èƒ½æ˜¯ nullï¼Œå› ä¸ºè‡ªåŠ¨æ‹†ç®±ï¼Œç”¨åŸºæœ¬æ•°æ®ç±»å‹æ¥æ”¶æœ‰ NPE é£é™©</li></ul></li><li>ã€å¼ºåˆ¶ã€‘åºåˆ—åŒ–ç±»æ–°å¢å±æ€§æ—¶ï¼Œè¯·ä¸è¦ä¿®æ”¹ serialVersionUID å­—æ®µï¼Œé¿å…ååºåˆ—å¤±è´¥ï¼›å¦‚æœå®Œå…¨ä¸å…¼å®¹å‡çº§ï¼Œé¿å…ååºåˆ—åŒ–æ··ä¹±ï¼Œé‚£ä¹ˆè¯·ä¿®æ”¹ serialVersionUID å€¼ã€‚<br>è¯´æ˜ï¼šæ³¨æ„ serialVersionUID ä¸ä¸€è‡´ä¼šæŠ›å‡ºåºåˆ—åŒ–è¿è¡Œæ—¶å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘æ„é€ æ–¹æ³•é‡Œé¢ç¦æ­¢åŠ å…¥ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœæœ‰åˆå§‹åŒ–é€»è¾‘ï¼Œè¯·æ”¾åœ¨ init æ–¹æ³•ä¸­</li><li>ã€å¼ºåˆ¶ã€‘ç¦æ­¢åœ¨ POJO ç±»ä¸­ï¼ŒåŒæ—¶å­˜åœ¨å¯¹åº”å±æ€§ xxx çš„ isXxx()å’Œ getXxx()æ–¹æ³•<br>è¯´æ˜ï¼šæ¡†æ¶åœ¨è°ƒç”¨å±æ€§ xxx çš„æå–æ–¹æ³•æ—¶ï¼Œå¹¶ä¸èƒ½ç¡®å®šå“ªä¸ªæ–¹æ³•ä¸€å®šæ˜¯è¢«ä¼˜å…ˆè°ƒç”¨åˆ°çš„</li><li>ã€æ¨èã€‘ä½¿ç”¨ç´¢å¼•è®¿é—®ç”¨ String çš„ split æ–¹æ³•å¾—åˆ°çš„æ•°ç»„æ—¶ï¼Œéœ€åšæœ€åä¸€ä¸ªåˆ†éš”ç¬¦åæœ‰æ— å†…å®¹çš„æ£€æŸ¥ï¼Œå¦åˆ™ä¼šæœ‰æŠ› IndexOutOfBoundsException çš„é£é™©</li><li>ã€æ¨èã€‘æ…ç”¨ Object çš„ clone æ–¹æ³•æ¥æ‹·è´å¯¹è±¡<br>è¯´æ˜ï¼šå¯¹è±¡ clone æ–¹æ³•é»˜è®¤æ˜¯æµ…æ‹·è´ï¼Œè‹¥æƒ³å®ç°æ·±æ‹·è´ï¼Œéœ€è¦†å†™ clone æ–¹æ³•å®ç°åŸŸå¯¹è±¡çš„æ·±åº¦éå†å¼æ‹·è´</li></ol><h4 id="ä¸‰ã€æ—¥æœŸæ—¶é—´"><a href="#ä¸‰ã€æ—¥æœŸæ—¶é—´" class="headerlink" title="ä¸‰ã€æ—¥æœŸæ—¶é—´"></a>ä¸‰ã€æ—¥æœŸæ—¶é—´</h4><ol><li>ã€å¼ºåˆ¶ã€‘æ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œä¼ å…¥ pattern ä¸­è¡¨ç¤ºå¹´ä»½ç»Ÿä¸€ä½¿ç”¨å°å†™çš„ y<br>è¯´æ˜ï¼šæ—¥æœŸæ ¼å¼åŒ–æ—¶ï¼Œyyyy è¡¨ç¤ºå½“å¤©æ‰€åœ¨çš„å¹´ï¼Œè€Œå¤§å†™çš„ YYYY ä»£è¡¨æ˜¯ week in which yearï¼ˆJDK7 ä¹‹å å¼•å…¥çš„æ¦‚å¿µï¼‰ï¼Œæ„æ€æ˜¯å½“å¤©æ‰€åœ¨çš„å‘¨å±äºçš„å¹´ä»½ï¼Œä¸€å‘¨ä»å‘¨æ—¥å¼€å§‹ï¼Œå‘¨å…­ç»“æŸï¼Œåªè¦æœ¬å‘¨è·¨å¹´ï¼Œè¿”å›çš„ YYYY å°±æ˜¯ä¸‹ä¸€å¹´</li><li>ã€å¼ºåˆ¶ã€‘è·å–å½“å‰æ¯«ç§’æ•°ï¼šSystem.currentTimeMillis(); è€Œä¸æ˜¯ new Date().getTime()</li><li>ã€å¼ºåˆ¶ã€‘ä¸å…è®¸åœ¨ç¨‹åºä»»ä½•åœ°æ–¹ä¸­ä½¿ç”¨ï¼š1ï¼‰java.sql.Dateã€‚ 2ï¼‰java.sql.Timeï¼›3ï¼‰java.sql.Timestamp<br>è¯´æ˜ï¼šç¬¬ 1 ä¸ªä¸è®°å½•æ—¶é—´ï¼ŒgetHours()æŠ›å‡ºå¼‚å¸¸ï¼›ç¬¬ 2 ä¸ªä¸è®°å½•æ—¥æœŸï¼ŒgetYear()æŠ›å‡ºå¼‚å¸¸ï¼›ç¬¬ 3 ä¸ªåœ¨æ„é€ æ–¹æ³• super((time&#x2F;1000)*1000)ï¼Œåœ¨ Timestamp å±æ€§ fastTime å’Œ nanos åˆ†åˆ«å­˜å‚¨ç§’å’Œçº³ç§’ä¿¡æ¯</li><li>ã€å¼ºåˆ¶ã€‘ä¸è¦åœ¨ç¨‹åºä¸­å†™æ­»ä¸€å¹´ä¸º 365 å¤©ï¼Œé¿å…åœ¨å…¬å†é—°å¹´æ—¶å‡ºç°æ—¥æœŸè½¬æ¢é”™è¯¯æˆ–ç¨‹åºé€»è¾‘<br>é”™è¯¯</li></ol><h4 id="å››ã€é›†åˆå¤„ç†"><a href="#å››ã€é›†åˆå¤„ç†" class="headerlink" title="å››ã€é›†åˆå¤„ç†"></a>å››ã€é›†åˆå¤„ç†</h4><ol><li>ã€å¼ºåˆ¶ã€‘å…³äº hashCode å’Œ equals çš„å¤„ç†ï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š<br>1ï¼‰ åªè¦è¦†å†™ equalsï¼Œå°±å¿…é¡»è¦†å†™ hashCodeã€‚<br>2ï¼‰ å› ä¸º Set å­˜å‚¨çš„æ˜¯ä¸é‡å¤çš„å¯¹è±¡ï¼Œä¾æ® hashCode å’Œ equals è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥ Set å­˜å‚¨çš„å¯¹è±¡å¿…é¡»è¦†å†™è¿™ä¸¤ç§æ–¹æ³•<br>3ï¼‰ å¦‚æœè‡ªå®šä¹‰å¯¹è±¡ä½œä¸º Map çš„é”®ï¼Œé‚£ä¹ˆå¿…é¡»è¦†å†™ hashCode å’Œ equals</li><li>ã€å¼ºåˆ¶ã€‘åˆ¤æ–­æ‰€æœ‰é›†åˆå†…éƒ¨çš„å…ƒç´ æ˜¯å¦ä¸ºç©ºï¼Œä½¿ç”¨ isEmpty()æ–¹æ³•ï¼Œè€Œä¸æ˜¯ size()&#x3D;&#x3D;0 çš„æ–¹å¼</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ä½¿ç”¨ java.util.stream.Collectors ç±»çš„ toMap()æ–¹æ³•è½¬ä¸º Map é›†åˆæ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨å«æœ‰å‚æ•°ç±»å‹ä¸º BinaryOperatorï¼Œå‚æ•°åä¸º mergeFunction çš„æ–¹æ³•ï¼Œå¦åˆ™å½“å‡ºç°ç›¸åŒ keyå€¼æ—¶ä¼šæŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚<br>è¯´æ˜ï¼šJDK1.8åçš„ç‰ˆæœ¬</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ä½¿ç”¨ java.util.stream.Collectors ç±»çš„ toMap()æ–¹æ³•è½¬ä¸º Map é›†åˆæ—¶ï¼Œä¸€å®šè¦æ³¨æ„å½“ value ä¸º null æ—¶ä¼šæŠ› NPE å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘ArrayList çš„ subList ç»“æœä¸å¯å¼ºè½¬æˆ ArrayListï¼Œå¦åˆ™ä¼šæŠ›å‡º ClassCastException å¼‚å¸¸ï¼šjava.util.RandomAccessSubList cannot be cast to java.util.ArrayListã€‚è¯´æ˜ï¼šsubList()è¿”å›çš„æ˜¯ ArrayList çš„å†…éƒ¨ç±» SubListï¼Œå¹¶ä¸æ˜¯ ArrayList æœ¬èº«ï¼Œè€Œæ˜¯ ArrayList çš„ä¸€ä¸ªè§†å›¾ï¼Œå¯¹äº SubList çš„æ‰€æœ‰æ“ä½œæœ€ç»ˆä¼šåæ˜ åˆ°åŸåˆ—è¡¨ä¸Š</li><li>ã€å¼ºåˆ¶ã€‘ä½¿ç”¨ Map çš„æ–¹æ³• keySet()&#x2F;values()&#x2F;entrySet()è¿”å›é›†åˆå¯¹è±¡æ—¶ï¼Œä¸å¯ä»¥å¯¹å…¶è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œï¼Œå¦åˆ™ä¼šæŠ›å‡º UnsupportedOperationException å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘Collections ç±»è¿”å›çš„å¯¹è±¡ï¼Œå¦‚ï¼šemptyList()&#x2F;singletonList()ç­‰éƒ½æ˜¯ immutable listï¼Œä¸å¯å¯¹å…¶è¿›è¡Œæ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ çš„æ“ä½œ</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ subList åœºæ™¯ä¸­ï¼Œé«˜åº¦æ³¨æ„å¯¹çˆ¶é›†åˆå…ƒç´ çš„å¢åŠ æˆ–åˆ é™¤ï¼Œå‡ä¼šå¯¼è‡´å­åˆ—è¡¨çš„éå†ã€<br>å¢åŠ ã€åˆ é™¤äº§ç”Ÿ ConcurrentModificationException å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘ä½¿ç”¨é›†åˆè½¬æ•°ç»„çš„æ–¹æ³•ï¼Œå¿…é¡»ä½¿ç”¨é›†åˆçš„ toArray(T[] array)ï¼Œä¼ å…¥çš„æ˜¯ç±»å‹å®Œå…¨ä¸€è‡´ã€é•¿åº¦ä¸º 0 çš„ç©ºæ•°ç»„<br>åä¾‹ï¼šç›´æ¥ä½¿ç”¨ toArray æ— å‚æ–¹æ³•å­˜åœ¨é—®é¢˜ï¼Œæ­¤æ–¹æ³•è¿”å›å€¼åªèƒ½æ˜¯ Object[]ç±»ï¼Œè‹¥å¼ºè½¬å…¶å®ƒç±»å‹æ•°ç»„å°†å‡ºç°ClassCastException é”™è¯¯</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ä½¿ç”¨ Collection æ¥å£ä»»ä½•å®ç°ç±»çš„ addAll()æ–¹æ³•æ—¶ï¼Œéƒ½è¦å¯¹è¾“å…¥çš„é›†åˆå‚æ•°è¿›è¡ŒNPE åˆ¤æ–­<br>è¯´æ˜ï¼šåœ¨ ArrayList#addAll æ–¹æ³•çš„ç¬¬ä¸€è¡Œä»£ç å³ Object[] a &#x3D; c.toArray(); å…¶ä¸­ c ä¸ºè¾“å…¥é›†åˆå‚æ•°ï¼Œå¦‚æœä¸º nullï¼Œåˆ™ç›´æ¥æŠ›å‡ºå¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘ä½¿ç”¨å·¥å…·ç±» Arrays.asList()æŠŠæ•°ç»„è½¬æ¢æˆé›†åˆæ—¶ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä¿®æ”¹é›†åˆç›¸å…³çš„æ–¹æ³•ï¼Œ å®ƒçš„ add&#x2F;remove&#x2F;clear æ–¹æ³•ä¼šæŠ›å‡º UnsupportedOperationException å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘æ³›å‹é€šé…ç¬¦&lt;? extends T&gt;æ¥æ¥æ”¶è¿”å›çš„æ•°æ®ï¼Œæ­¤å†™æ³•çš„æ³›å‹é›†åˆä¸èƒ½ä½¿ç”¨ add æ–¹æ³•ï¼Œ è€Œ&lt;? super T&gt;ä¸èƒ½ä½¿ç”¨ get æ–¹æ³•ï¼Œä¸¤è€…åœ¨æ¥å£è°ƒç”¨èµ‹å€¼çš„åœºæ™¯ä¸­å®¹æ˜“å‡ºé”™<br>è¯´æ˜ï¼šæ‰©å±•è¯´ä¸€ä¸‹ PECS(Producer Extends Consumer Super)åŸåˆ™ï¼šç¬¬ä¸€ã€é¢‘ç¹å¾€å¤–è¯»å–å†…å®¹çš„ï¼Œé€‚åˆç”¨&lt;? extends T&gt;ã€‚ç¬¬äºŒã€ç»å¸¸å¾€é‡Œæ’å…¥çš„ï¼Œé€‚åˆç”¨&lt;? super T&gt;</li><li>ã€å¼ºåˆ¶ã€‘åœ¨æ— æ³›å‹é™åˆ¶å®šä¹‰çš„é›†åˆèµ‹å€¼ç»™æ³›å‹é™åˆ¶çš„é›†åˆæ—¶ï¼Œåœ¨ä½¿ç”¨é›†åˆå…ƒç´ æ—¶ï¼Œéœ€è¦è¿›è¡Œinstanceof åˆ¤æ–­ï¼Œé¿å…æŠ›å‡º ClassCastException å¼‚å¸¸</li><li>ã€å¼ºåˆ¶ã€‘ä¸è¦åœ¨ foreach å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„ remove&#x2F;add æ“ä½œã€‚remove å…ƒç´ è¯·ä½¿ç”¨ Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹ Iterator å¯¹è±¡åŠ é”</li></ol><h4 id="äº”ã€å¹¶å‘å¤„ç†"><a href="#äº”ã€å¹¶å‘å¤„ç†" class="headerlink" title="äº”ã€å¹¶å‘å¤„ç†"></a>äº”ã€å¹¶å‘å¤„ç†</h4><ol><li>ã€å¼ºåˆ¶ã€‘è·å–å•ä¾‹å¯¹è±¡éœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå…¶ä¸­çš„æ–¹æ³•ä¹Ÿè¦ä¿è¯çº¿ç¨‹å®‰å…¨</li><li>ã€å¼ºåˆ¶ã€‘åˆ›å»ºçº¿ç¨‹æˆ–çº¿ç¨‹æ± æ—¶è¯·æŒ‡å®šæœ‰æ„ä¹‰çš„çº¿ç¨‹åç§°ï¼Œæ–¹ä¾¿å‡ºé”™æ—¶å›æº¯</li><li>ã€å¼ºåˆ¶ã€‘çº¿ç¨‹èµ„æºå¿…é¡»é€šè¿‡çº¿ç¨‹æ± æä¾›ï¼Œä¸å…è®¸åœ¨åº”ç”¨ä¸­è‡ªè¡Œæ˜¾å¼åˆ›å»ºçº¿ç¨‹<br>è¯´æ˜ï¼šçº¿ç¨‹æ± çš„å¥½å¤„æ˜¯å‡å°‘åœ¨åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ä¸Šæ‰€æ¶ˆè€—çš„æ—¶é—´ä»¥åŠç³»ç»Ÿèµ„æºçš„å¼€é”€ï¼Œè§£å†³èµ„æºä¸è¶³çš„é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæœ‰å¯èƒ½é€ æˆç³»ç»Ÿåˆ›å»ºå¤§é‡åŒç±»çº¿ç¨‹è€Œå¯¼è‡´æ¶ˆè€—å®Œå†…å­˜æˆ–è€…â€œè¿‡åº¦åˆ‡æ¢â€çš„é—®é¢˜</li><li>ã€å¼ºåˆ¶ã€‘SimpleDateFormat æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ç±»ï¼Œä¸€èˆ¬ä¸è¦å®šä¹‰ä¸º static å˜é‡ï¼Œå¦‚æœå®šä¹‰ä¸ºstaticå¿…é¡»åŠ é”ï¼Œæˆ–è€…ä½¿ç”¨ DateUtils å·¥å…·ç±»<br>æ­£ä¾‹ï¼šæ³¨æ„çº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨ DateUtilsã€‚äº¦æ¨èå¦‚ä¸‹å¤„ç†<pre class="line-numbers language-none"><code class="language-none">private static final ThreadLocal&lt;DateFormat&gt; df &#x3D; new ThreadLocal&lt;DateFormat&gt;() &#123; @Override protected DateFormat initialValue() &#123; return new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); &#125;&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>è¯´æ˜ï¼šå¦‚æœæ˜¯ JDK8 çš„åº”ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ Instant ä»£æ›¿ Dateï¼ŒLocalDateTime ä»£æ›¿ Calendarï¼Œ DateTimeFormatter ä»£æ›¿ SimpleDateFormatï¼Œå®˜æ–¹ç»™å‡ºçš„è§£é‡Šï¼šsimple beautiful strong immutable thread-safe</li><li>ã€å¼ºåˆ¶ã€‘å¿…é¡»å›æ”¶è‡ªå®šä¹‰çš„ ThreadLocal å˜é‡ï¼Œå°¤å…¶åœ¨çº¿ç¨‹æ± åœºæ™¯ä¸‹ï¼Œçº¿ç¨‹ç»å¸¸ä¼šè¢«å¤ç”¨ï¼Œ å¦‚æœä¸æ¸…ç†è‡ªå®šä¹‰çš„ ThreadLocal å˜é‡ï¼Œå¯èƒ½ä¼šå½±å“åç»­ä¸šåŠ¡é€»è¾‘å’Œé€ æˆå†…å­˜æ³„éœ²ç­‰é—®é¢˜ã€‚ å°½é‡åœ¨ä»£ç†ä¸­ä½¿ç”¨ try-finally å—è¿›è¡Œå›æ”¶<br>æ­£ä¾‹ï¼š<pre class="line-numbers language-none"><code class="language-none">objectThreadLocal.set(userInfo);try &#123; &#x2F;&#x2F; ...&#125; finally &#123; objectThreadLocal.remove();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ã€å¼ºåˆ¶ã€‘é«˜å¹¶å‘æ—¶ï¼ŒåŒæ­¥è°ƒç”¨åº”è¯¥å»è€ƒé‡é”çš„æ€§èƒ½æŸè€—ã€‚èƒ½ç”¨æ— é”æ•°æ®ç»“æ„ï¼Œå°±ä¸è¦ç”¨é”ï¼›èƒ½ é”åŒºå—ï¼Œå°±ä¸è¦é”æ•´ä¸ªæ–¹æ³•ä½“ï¼›èƒ½ç”¨å¯¹è±¡é”ï¼Œå°±ä¸è¦ç”¨ç±»é”<br>è¯´æ˜ï¼šå°½å¯èƒ½ä½¿åŠ é”çš„ä»£ç å—å·¥ä½œé‡å°½å¯èƒ½çš„å°ï¼Œé¿å…åœ¨é”ä»£ç å—ä¸­è°ƒç”¨ RPC æ–¹æ³•</li><li>ã€å¼ºåˆ¶ã€‘å¯¹å¤šä¸ªèµ„æºã€æ•°æ®åº“è¡¨ã€å¯¹è±¡åŒæ—¶åŠ é”æ—¶ï¼Œéœ€è¦ä¿æŒä¸€è‡´çš„åŠ é”é¡ºåºï¼Œå¦åˆ™å¯èƒ½ä¼šé€ æˆæ­»é”<br>è¯´æ˜ï¼šçº¿ç¨‹ä¸€éœ€è¦å¯¹è¡¨ Aã€Bã€C ä¾æ¬¡å…¨éƒ¨åŠ é”åæ‰å¯ä»¥è¿›è¡Œæ›´æ–°æ“ä½œï¼Œé‚£ä¹ˆçº¿ç¨‹äºŒçš„åŠ é”é¡ºåºä¹Ÿå¿…é¡»æ˜¯ Aã€Bã€Cï¼Œå¦åˆ™å¯èƒ½å‡ºç°æ­»é”</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨ try ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸ try ä»£ ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨ finally ä¸­æ— æ³•è§£é”ã€‚<br>è¯´æ˜ä¸€ï¼šå¦‚æœåœ¨ lock æ–¹æ³•ä¸ try ä»£ç å—ä¹‹é—´çš„æ–¹æ³•è°ƒç”¨æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæ— æ³•è§£é”ï¼Œé€ æˆå…¶å®ƒçº¿ç¨‹æ— æ³•æˆåŠŸè·å–é”ã€‚<br>è¯´æ˜äºŒï¼šå¦‚æœ lock æ–¹æ³•åœ¨ try ä»£ç å—ä¹‹å†…ï¼Œå¯èƒ½ç”±äºå…¶å®ƒæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´åœ¨ finally ä»£ç å—ä¸­ï¼Œunlockå¯¹æœªåŠ é”çš„å¯¹è±¡è§£é”ï¼Œå®ƒä¼šè°ƒç”¨ AQS çš„ tryRelease æ–¹æ³•ï¼ˆå–å†³äºå…·ä½“å®ç°ç±»ï¼‰ï¼ŒæŠ›å‡º<br>IllegalMonitorStateException å¼‚å¸¸ã€‚<br>è¯´æ˜ä¸‰ï¼šåœ¨ Lock å¯¹è±¡çš„ lock æ–¹æ³•å®ç°ä¸­å¯èƒ½æŠ›å‡º unchecked å¼‚å¸¸ï¼Œäº§ç”Ÿçš„åæœä¸è¯´æ˜äºŒç›¸åŒ<br>æ­£ä¾‹ï¼š<pre class="line-numbers language-none"><code class="language-none">Lock lock &#x3D; new XxxLock();&#x2F;&#x2F; ...lock.lock();try &#123; doSomething(); doOthers();&#125; finally &#123; lock.unlock();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>åä¾‹ï¼š<pre class="line-numbers language-none"><code class="language-none">Lock lock &#x3D; new XxxLock();try &#123; &#x2F;&#x2F; å¦‚æœæ­¤å¤„æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ finally ä»£ç å— doSomething(); &#x2F;&#x2F; æ— è®ºåŠ é”æ˜¯å¦æˆåŠŸï¼Œfinally ä»£ç å—éƒ½ä¼šæ‰§è¡Œ lock.lock(); doOthers();&#125; finally &#123; lock.unlock();&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ã€å¼ºåˆ¶ã€‘åœ¨ä½¿ç”¨å°è¯•æœºåˆ¶æ¥è·å–é”çš„æ–¹å¼ä¸­ï¼Œè¿›å…¥ä¸šåŠ¡ä»£ç å—ä¹‹å‰ï¼Œå¿…é¡»å…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”ã€‚é”çš„é‡Šæ”¾è§„åˆ™ä¸é”çš„é˜»å¡ç­‰å¾…æ–¹å¼ç›¸åŒ<br>è¯´æ˜ï¼šLock å¯¹è±¡çš„ unlock æ–¹æ³•åœ¨æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šè°ƒç”¨ AQS çš„ tryRelease æ–¹æ³•ï¼ˆå–å†³äºå…·ä½“å®ç°ç±»ï¼‰ï¼Œå¦‚æœ å½“å‰çº¿ç¨‹ä¸æŒæœ‰é”ï¼Œåˆ™æŠ›å‡º IllegalMonitorStateException å¼‚å¸¸<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XxxLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ...</span><span class="token keyword">boolean</span> isLocked <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>isLocked<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">doOthers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ã€å¼ºåˆ¶ã€‘å¹¶å‘ä¿®æ”¹åŒä¸€è®°å½•æ—¶ï¼Œé¿å…æ›´æ–°ä¸¢å¤±ï¼Œéœ€è¦åŠ é”ã€‚è¦ä¹ˆåœ¨åº”ç”¨å±‚åŠ é”ï¼Œè¦ä¹ˆåœ¨ç¼“å­˜åŠ  é”ï¼Œè¦ä¹ˆåœ¨æ•°æ®åº“å±‚ä½¿ç”¨ä¹è§‚é”ï¼Œä½¿ç”¨ version ä½œä¸ºæ›´æ–°ä¾æ®ã€‚<br>è¯´æ˜ï¼šå¦‚æœæ¯æ¬¡è®¿é—®å†²çªæ¦‚ç‡å°äº 20%ï¼Œæ¨èä½¿ç”¨ä¹è§‚é”ï¼Œå¦åˆ™ä½¿ç”¨æ‚²è§‚é”ã€‚ä¹è§‚é”çš„é‡è¯•æ¬¡æ•°ä¸å¾—å°äº3 æ¬¡ã€‚</li><li>ã€æ¨èã€‘ä½¿ç”¨ CountDownLatch è¿›è¡Œå¼‚æ­¥è½¬åŒæ­¥æ“ä½œï¼Œæ¯ä¸ªçº¿ç¨‹é€€å‡ºå‰å¿…é¡»è°ƒç”¨ countDown æ–¹ æ³•ï¼Œçº¿ç¨‹æ‰§è¡Œä»£ç æ³¨æ„ catch å¼‚å¸¸ï¼Œç¡®ä¿ countDown æ–¹æ³•è¢«æ‰§è¡Œåˆ°ï¼Œé¿å…ä¸»çº¿ç¨‹æ— æ³•æ‰§è¡Œè‡³ await æ–¹æ³•ï¼Œç›´åˆ°è¶…æ—¶æ‰è¿”å›ç»“æœã€‚<br>è¯´æ˜ï¼šæ³¨æ„ï¼Œå­çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸å †æ ˆï¼Œä¸èƒ½åœ¨ä¸»çº¿ç¨‹ try-catch åˆ°</li><li>ã€æ¨èã€‘é¿å… Random å®ä¾‹è¢«å¤šçº¿ç¨‹ä½¿ç”¨ï¼Œè™½ç„¶å…±äº«è¯¥å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ä¼šå› ç«äº‰åŒä¸€ seedå¯¼è‡´çš„æ€§èƒ½ä¸‹é™<br>è¯´æ˜ï¼šRandom å®ä¾‹åŒ…æ‹¬ java.util.Random çš„å®ä¾‹æˆ–è€… Math.random()çš„æ–¹å¼ã€‚<br>æ­£ä¾‹ï¼šåœ¨ JDK7 ä¹‹åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ API ThreadLocalRandomï¼Œè€Œåœ¨ JDK7 ä¹‹å‰ï¼Œéœ€è¦ç¼–ç ä¿è¯æ¯ä¸ªçº¿ç¨‹æŒæœ‰ä¸€ä¸ªå•ç‹¬çš„ Random å®ä¾‹</li><li>ã€å‚è€ƒã€‘ThreadLocal å¯¹è±¡ä½¿ç”¨ static ä¿®é¥°ï¼ŒThreadLocal æ— æ³•è§£å†³å…±äº«å¯¹è±¡çš„æ›´æ–°é—®é¢˜</li></ol><h4 id="å…­ã€å‰ã€åç«¯å…¬çº¦"><a href="#å…­ã€å‰ã€åç«¯å…¬çº¦" class="headerlink" title="å…­ã€å‰ã€åç«¯å…¬çº¦"></a>å…­ã€å‰ã€åç«¯å…¬çº¦</h4><ol><li>ã€å¼ºåˆ¶ã€‘å‰åç«¯äº¤äº’çš„ APIï¼Œéœ€è¦æ˜ç¡®åè®®ã€åŸŸåã€è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚å†…å®¹ã€çŠ¶æ€ç ã€å“åº”ä½“</li><li>ã€å¼ºåˆ¶ã€‘å‰åç«¯æ•°æ®<strong>åˆ—è¡¨</strong>ç›¸å…³çš„æ¥å£è¿”å›ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„[]æˆ–ç©ºé›†åˆ{}<br>è¯´æ˜ï¼šæ­¤æ¡çº¦å®šæœ‰åˆ©äºæ•°æ®å±‚é¢ä¸Šçš„åä½œæ›´åŠ é«˜æ•ˆï¼Œå‡å°‘å‰ç«¯å¾ˆå¤šçç¢çš„ null åˆ¤æ–­</li><li>ã€å¼ºåˆ¶ã€‘åœ¨å‰åç«¯äº¤äº’çš„ JSON æ ¼å¼æ•°æ®ä¸­ï¼Œæ‰€æœ‰çš„ key å¿…é¡»ä¸ºå°å†™å­—æ¯å¼€å§‹çš„lowerCamelCase é£æ ¼ï¼Œç¬¦åˆè‹±æ–‡è¡¨è¾¾ä¹ æƒ¯ï¼Œä¸”è¡¨æ„å®Œæ•´</li><li>ã€å¼ºåˆ¶ã€‘å¯¹äºéœ€è¦ä½¿ç”¨è¶…å¤§æ•´æ•°çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯ä¸€å¾‹ä½¿ç”¨ String å­—ç¬¦ä¸²ç±»å‹è¿”å›ï¼Œç¦æ­¢ä½¿ç”¨Long ç±»å‹</li><li>ã€å¼ºåˆ¶ã€‘HTTP è¯·æ±‚é€šè¿‡ URL ä¼ é€’å‚æ•°æ—¶ï¼Œä¸èƒ½è¶…è¿‡ 2048 å­—èŠ‚</li><li>ã€å¼ºåˆ¶ã€‘HTTP è¯·æ±‚é€šè¿‡ body ä¼ é€’å†…å®¹æ—¶ï¼Œå¿…é¡»æ§åˆ¶é•¿åº¦ï¼Œè¶…å‡ºæœ€å¤§é•¿åº¦åï¼Œåç«¯è§£æä¼šå‡ºé”™<br>è¯´æ˜ï¼šnginx é»˜è®¤é™åˆ¶æ˜¯ 1MBï¼Œtomcat é»˜è®¤é™åˆ¶ä¸º 2MBï¼Œå½“ç¡®å®æœ‰ä¸šåŠ¡éœ€è¦ä¼ è¾ƒå¤§å†…å®¹æ—¶ï¼Œå¯ä»¥é€šè¿‡è°ƒå¤§æœåŠ¡å™¨ç«¯çš„é™åˆ¶ã€‚<br>Nginxè°ƒæ•´å‚æ•°ï¼šclient_max_body_size<br>tomcatè°ƒæ•´å‚æ•°ï¼šserver.xmlä¸­çš„èŠ‚ç‚¹æ·»åŠ maxPostSize</li><li>ã€å¼ºåˆ¶ã€‘åœ¨ç¿»é¡µåœºæ™¯ä¸­ï¼Œç”¨æˆ·è¾“å…¥å‚æ•°çš„å°äº 1ï¼Œåˆ™å‰ç«¯è¿”å›ç¬¬ä¸€é¡µå‚æ•°ç»™åç«¯ï¼›åç«¯å‘ç°ç”¨æˆ·è¾“å…¥çš„å‚æ•°å¤§äºæ€»é¡µæ•°ï¼Œç›´æ¥è¿”å›æœ€åä¸€é¡µ</li><li>ã€å¼ºåˆ¶ã€‘æœåŠ¡å™¨å†…éƒ¨é‡å®šå‘å¿…é¡»ä½¿ç”¨ forwardï¼›å¤–éƒ¨é‡å®šå‘åœ°å€å¿…é¡»ä½¿ç”¨ URL ç»Ÿä¸€ä»£ç†æ¨¡å—ç”Ÿæˆï¼Œå¦åˆ™ä¼šå› çº¿ä¸Šé‡‡ç”¨ HTTPS åè®®è€Œå¯¼è‡´æµè§ˆå™¨æç¤ºâ€œä¸å®‰å…¨â€ï¼Œå¹¶ä¸”è¿˜ä¼šå¸¦æ¥ URL ç»´æŠ¤ä¸ä¸€è‡´çš„é—®é¢˜</li><li>ã€æ¨èã€‘å‰åç«¯çš„æ—¶é—´æ ¼å¼ç»Ÿä¸€ä¸ºâ€yyyy-MM-dd HH:mm:ssâ€ï¼Œç»Ÿä¸€ä¸º GMT</li><li>ã€å‚è€ƒã€‘åœ¨æ¥å£è·¯å¾„ä¸­ä¸è¦åŠ å…¥ç‰ˆæœ¬å·ï¼Œç‰ˆæœ¬æ§åˆ¶åœ¨ HTTP å¤´ä¿¡æ¯ä¸­ä½“ç°ï¼Œæœ‰åˆ©äºå‘å‰å…¼å®¹</li></ol><h4 id="ä¸ƒã€å…¶ä»–"><a href="#ä¸ƒã€å…¶ä»–" class="headerlink" title="ä¸ƒã€å…¶ä»–"></a>ä¸ƒã€å…¶ä»–</h4><ol><li>ã€å¼ºåˆ¶ã€‘finally å—å¿…é¡»å¯¹èµ„æºå¯¹è±¡ã€æµå¯¹è±¡è¿›è¡Œå…³é—­ï¼Œæœ‰å¼‚å¸¸ä¹Ÿè¦åš try-catch<br>è¯´æ˜ï¼šå¦‚æœ JDK7 åŠä»¥ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ try-with-resources æ–¹å¼</li><li>ã€å¼ºåˆ¶ã€‘ä¸è¦åœ¨ finally å—ä¸­ä½¿ç”¨ return<br>è¯´æ˜ï¼štry å—ä¸­çš„ return è¯­å¥æ‰§è¡ŒæˆåŠŸåï¼Œå¹¶ä¸é©¬ä¸Šè¿”å›ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œ finally å—ä¸­çš„è¯­å¥ï¼Œå¦‚æœæ­¤å¤„å­˜åœ¨ return è¯­å¥ï¼Œåˆ™åœ¨æ­¤ç›´æ¥è¿”å›ï¼Œæ— æƒ…ä¸¢å¼ƒæ‰ try å—ä¸­çš„è¿”å›ç‚¹</li><li>ã€å¼ºåˆ¶ã€‘åº”ç”¨ä¸­ä¸å¯ç›´æ¥ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿï¼ˆLog4jã€Logbackï¼‰ä¸­çš„ APIï¼Œè€Œåº”ä¾èµ–ä½¿ç”¨æ—¥å¿—æ¡†æ¶ï¼ˆSLF4Jã€JCLâ€“Jakarta Commons Loggingï¼‰ä¸­çš„ APIï¼Œä½¿ç”¨é—¨é¢æ¨¡å¼çš„æ—¥å¿—æ¡†æ¶ï¼Œæœ‰åˆ©äºç»´æŠ¤å’Œå„ä¸ªç±»çš„æ—¥å¿—å¤„ç†æ–¹å¼ç»Ÿä¸€</li><li>ã€å¼ºåˆ¶ã€‘åœ¨æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå­—ç¬¦ä¸²å˜é‡ä¹‹é—´çš„æ‹¼æ¥ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼<br>è¯´æ˜ï¼šå› ä¸º String å­—ç¬¦ä¸²çš„æ‹¼æ¥ä¼šä½¿ç”¨ StringBuilder çš„ append()æ–¹å¼ï¼Œæœ‰ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚ä½¿ç”¨å ä½ç¬¦ä»…æ˜¯æ›¿æ¢åŠ¨ä½œï¼Œå¯ä»¥æœ‰æ•ˆæå‡æ€§èƒ½ã€‚<br>æ­£ä¾‹ï¼šlogger.debug(â€œProcessing trade with id: {} and symbol: {}â€, id, symbol);</li><li>ã€å¼ºåˆ¶ã€‘ç”Ÿäº§ç¯å¢ƒç¦æ­¢ç›´æ¥ä½¿ç”¨ System.out æˆ– System.err è¾“å‡ºæ—¥å¿—æˆ–ä½¿ç”¨e.printStackTrace()æ‰“å°å¼‚å¸¸å †æ ˆ</li></ol>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kaliç³»åˆ—-ä¸€.kali Uç›˜å®‰è£…</title>
      <link href="/2022/04/30/kali-xi-lie-1-kali-an-zhuang/"/>
      <url>/2022/04/30/kali-xi-lie-1-kali-an-zhuang/</url>
      
        <content type="html"><![CDATA[<p>kaliç³»ç»Ÿæ˜¯æ¸—é€æµ‹è¯•çš„ç‘å£«å†›åˆ€ï¼Œé›†æˆäº†å¤§éƒ¨åˆ†å¸¸ç”¨çš„Hackå·¥å…·ã€‚<br>è¯´è¯´Uç›˜å®‰è£…kaliçš„å¥½å¤„ï¼š</p><ol><li>è™šæ‹Ÿæœºå®‰è£…kaliï¼Œä¸æ”¯æŒwifiï¼Œå¦‚æœè¦æ”¯æŒwifiéœ€è¦é¢å¤–ä½¿ç”¨æ— çº¿ç½‘å¡</li><li>ä¸ç”¨è™šæ‹Ÿæœºï¼Œè¦ä¹ˆè£…åŒç³»ç»Ÿã€è¦ä¹ˆå†å‡†å¤‡ä¸€å°ç”µè„‘ï¼ˆåœŸè±ªéšæ„ï¼‰</li><li>è£…ç”µè„‘é‡Œä¸æ–¹ä¾¿æºå¸¦</li></ol><h3 id="ä¸€ã€å‰æœŸå‡†å¤‡"><a href="#ä¸€ã€å‰æœŸå‡†å¤‡" class="headerlink" title="ä¸€ã€å‰æœŸå‡†å¤‡"></a>ä¸€ã€å‰æœŸå‡†å¤‡</h3><ul><li>Uç›˜<br>å»ºè®®USB 3.0ï¼Œ2.0æ¯”è¾ƒå¡ã€‚<br>è‡³å°‘16Gï¼Œå»ºè®®32Gä»¥ä¸Š</li><li>DiskGenius Uç›˜åˆ†åŒºå·¥å…·<br>ç™¾åº¦æ‰¾</li><li>Universal-USB-Installer isoç³»ç»Ÿé•œåƒçƒ§å½•å·¥å…·<br>ä¸‹è½½åœ°å€ï¼š<a href="http://downza.51speed.top/2022/02/08/UniversalUSB.rar?timestamp=626cdc34&amp;auth_key=332de8aadceebdf3002d5c208110e680">http://downza.51speed.top/2022/02/08/UniversalUSB.rar?timestamp=626cdc34&amp;auth_key=332de8aadceebdf3002d5c208110e680</a><br>æ¨èä½¿ç”¨ï¼ŒåŸå› ï¼šå°å·§ï¼Œåªæœ‰2Må·¦å³ã€‚<br>ä¸æ¨èUltraISOï¼Œæˆ‘è¿™çƒ§å½•åæœ‰é—®é¢˜</li><li>kali live isoé•œåƒä¸‹è½½<br>æˆ‘çš„æ˜¯2021.2-live-amd64.iso<br>é•œåƒåœ°å€ï¼Œå›½å¤–çš„ä¸‹è½½æ…¢ï¼Œå»ºè®®ç”¨å›½å†…çš„ã€‚<br>æ¸…åå¤§å­¦é•œåƒï¼š<a href="https://mirrors.tuna.tsinghua.edu.cn/kali-images/">https://mirrors.tuna.tsinghua.edu.cn/kali-images/</a><br>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ï¼š<a href="https://mirrors.ustc.edu.cn/kali-images/">https://mirrors.ustc.edu.cn/kali-images/</a></li></ul><h3 id="äºŒã€ä½¿ç”¨"><a href="#äºŒã€ä½¿ç”¨" class="headerlink" title="äºŒã€ä½¿ç”¨"></a>äºŒã€ä½¿ç”¨</h3><ul><li><strong>1. DiskGeniusåˆ†åŒº</strong><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082341257.png" alt="å›¾1" style="zoom: 50%;" /><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082341891.png" alt="å›¾2" style="zoom: 50%;" /></li><li><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082342164.png" alt="image-20220430235104169" style="zoom:50%;" /><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082342039.png" alt="image-20220430235741924" style="zoom:50%;" /><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082342428.png" alt="image-20220430235926700" style="zoom:50%;" /></li><li><strong>2. Universal-USB-Installerçƒ§åˆ¶å¯åŠ¨ç›˜</strong></li></ul><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082342833.png" style="zoom: 80%;" /><p>å®Œæˆåå¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥uç›˜å¯åŠ¨çš„kali æ“ä½œç³»ç»Ÿï¼Œå³kali live usb</p><ul><li><p><strong>3. Uç›˜å¯åŠ¨</strong><br>åœ¨ç¬¬2æ­¥çƒ§åˆ¶åï¼Œé‡å¯ç”µè„‘ï¼Œè¿›å…¥BIOSç³»ç»Ÿã€‚è¿›å…¥BIOSç³»ç»Ÿå„å“ç‰Œçš„æ–¹å¼ï¼Œè§<a href="https://jingyan.baidu.com/article/cbf0e500b4c71b2eaa2893fd.html">https://jingyan.baidu.com/article/cbf0e500b4c71b2eaa2893fd.html</a></p><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082342387.png" alt="image-20220501000544177" style="zoom: 67%;" /></li></ul><p>è¿›å…¥ç³»ç»Ÿåè¿™ä¸¤ç§éƒ½å¯ä»¥ã€‚ä¸‹é¢ä¸€ç§æ˜¯è‡ªåŠ¨æ”¯æŒæŒä¹…åŒ–çš„ï¼Œä½†æŒä¹…åŒ–çš„æ˜¯æ–‡ä»¶ï¼Œç³»ç»Ÿé…ç½®æŒä¹…åŒ–æš‚æ—¶è¿˜æ²¡æ‰¾åˆ°æ–¹æ³•</p><blockquote><p>kali 2019åç³»ç»Ÿçš„ç”¨æˆ·æ˜¯kaliï¼Œå¯†ç ä¹Ÿæ˜¯kaliã€‚<br>ç³»ç»Ÿæ²¡æœ‰æä¾›rootç”¨æˆ·ï¼Œä½†æä¾›äº†sudoæƒé™ï¼Œæ‰€ä»¥åç»­ä¸€äº›æç¤ºæƒé™ä¸è¶³çš„ï¼Œå°±ç”¨sudo xxxæ‰§è¡Œå³å¯</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> kali </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> kali Uç›˜å®‰è£… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jacksonè§£ææœ‰æ•°ç»„çš„xmlï¼Œè§£æå¯¹è±¡ä¸å›ºå®šçš„é—®é¢˜</title>
      <link href="/2022/04/09/jackson-jie-xi-you-shu-zu-de-xml-jie-xi-dui-xiang-bu-gu-ding-de-wen-ti/"/>
      <url>/2022/04/09/jackson-jie-xi-you-shu-zu-de-xml-jie-xi-dui-xiang-bu-gu-ding-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<br/><h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>springbootç‰ˆæœ¬2.2.11.RELEASEï¼Œjackson versionä¸º<strong>2.10.0</strong> </p><p>ä»¥ä¸‹ä¸ºç¬¬ä¸€ç‰ˆæ ·ä¾‹ä»£ç ï¼Œåé¢XMLä¸ä¼šå˜ï¼ŒServiceBusReqç±»çš„å†…å®¹ä¼šå˜:</p><ul><li>è¯·æ±‚ä½“</li></ul><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX_HEADER</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYS_HDR_LEN</span><span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYS_PKG_VRSN</span><span class="token punctuation">></span></span>01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SYS_PKG_VRSN</span><span class="token punctuation">></span></span>-->  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TX_HEADER</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX_EMB</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ENTITY</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER_NAME</span><span class="token punctuation">></span></span>xcc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>USER_NAME</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANYS</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANY</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANYNAME</span><span class="token punctuation">></span></span>NAME-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANYNAME</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANY</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANY</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANYNAME</span><span class="token punctuation">></span></span>NAME-2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANYNAME</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANY</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANYS</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ENTITY</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TX</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å®ä½“ç±»</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@JacksonXmlRootElement</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceBusReq</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_HEADER"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">ServiceBusHeaderReq</span> txHeader<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_BODY"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">ServiceBusBodyReq</span> txBody<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_EMB"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> txEmb<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"ENTITY"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">T</span> msgObject<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@JacksonXmlRootElement</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_HEADER"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceBusHeaderReq</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"SYS_HDR_LEN"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sysHdrLen<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceBusController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">RequestMethod</span><span class="token punctuation">.</span>POST<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>value <span class="token operator">=</span> <span class="token string">"/service"</span><span class="token punctuation">,</span>consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span>APPLICATION_XML_VALUE<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">ServiceBusResp</span> <span class="token function">xmlService</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Valid</span> <span class="token class-name">ServiceBusReq</span> reqDto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> serviceBusService<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>reqDto<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Builder</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XmlDemoReqDto</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"USER_NAME"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">UserName</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANYS"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Company</span><span class="token punctuation">></span></span> companys<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@JacksonXmlRootElement</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"company"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Company</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANYNAME"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> companyName<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ServiceBusReqé‡‡ç”¨çš„æ³›å‹ï¼Œååºåˆ—åŒ–ENTITYçš„å¯¹è±¡æ˜¯ä¸å›ºå®šçš„ã€‚XmlDemoReqDto å°±æ˜¯ServiceBusReqçš„æ³›å‹å¯¹è±¡</strong></p><h1 id="é—®é¢˜é˜¶æ®µä¸€"><a href="#é—®é¢˜é˜¶æ®µä¸€" class="headerlink" title="é—®é¢˜é˜¶æ®µä¸€"></a>é—®é¢˜é˜¶æ®µä¸€</h1><p>controllerä¸­reqDtoæ‰“å°çš„msgObjectç±»å‹å®é™…ä¸Šæ˜¯ä¸€ä¸ªLinkedHashMapï¼Œè€ŒLinkedHashMapæ˜æ˜¾ä¸ç¬¦åˆåºåˆ—åŒ–åæ˜¯ä¸ªjava beançš„è¦æ±‚<br><img src="/jackson%E8%A7%A3%E6%9E%90%E6%9C%89%E6%95%B0%E7%BB%84%E7%9A%84xml_images/bbd1beaa.png"><br><strong>è§£å†³æ–¹æ³•ï¼š</strong><br>æ·»åŠ ä¸€ä¸ªObjectNodeæ¥æ”¶ï¼Œç„¶åæŠŠobjectNodeå†è½¬æ¢æˆmsgObjectï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@JacksonXmlRootElement</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceBusReq</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_HEADER"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">ServiceBusHeaderReq</span> txHeader<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_BODY"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">ServiceBusBodyReq</span> txBody<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"TX_EMB"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> txEmb<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"ENTITY"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">ObjectNode</span> entity<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">T</span> msgObject<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">/*è½¬æ¢æ–¹æ³•*/</span><span class="token keyword">private</span> <span class="token class-name">Req</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">ObjectNode</span> entityStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Type</span><span class="token punctuation">[</span><span class="token punctuation">]</span> actualTypeArguments <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ParameterizedTypeImpl</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getGenericSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getActualTypeArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>actualTypeArguments<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">"å¯¹è±¡è·å–å¼‚å¸¸"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Object</span> o <span class="token operator">=</span> xmlMapper<span class="token punctuation">.</span><span class="token function">convertValue</span><span class="token punctuation">(</span>entityStr<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>actualTypeArguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Req</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="é—®é¢˜é˜¶æ®µäºŒ"><a href="#é—®é¢˜é˜¶æ®µäºŒ" class="headerlink" title="é—®é¢˜é˜¶æ®µäºŒ"></a>é—®é¢˜é˜¶æ®µäºŒ</h1><p>ä»¥ä¸Šå¤„ç†ååºåˆ—åŒ–æˆå¯¹è±¡ï¼Œä½†æœ‰å¦ä¸€ä¸ªé—®é¢˜ï¼Œcompanysåªè·å–åˆ°ä¸€ä¸ªç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯NAME-2çš„å€¼ï¼ŒNAME-1çš„å€¼æ²¡æœ‰è·å–åˆ°<br><img src="/jackson%E8%A7%A3%E6%9E%90%E6%9C%89%E6%95%B0%E7%BB%84%E7%9A%84xml_images/66222ed5.png"></p><h1 id="é—®é¢˜é˜¶æ®µä¸‰"><a href="#é—®é¢˜é˜¶æ®µä¸‰" class="headerlink" title="é—®é¢˜é˜¶æ®µä¸‰"></a>é—®é¢˜é˜¶æ®µä¸‰</h1><p>åªè·å–åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ‰ä¸¤ä¸ªåœ°å€ä¿®æ”¹ï¼š</p><ol><li><p>ä¿®æ”¹jackson-databindçš„ç‰ˆæœ¬ï¼Œéœ€è¦æ”¹ä¸º2.12.0ç‰ˆæœ¬ä»¥ä¸Šï¼Œå®˜æ–¹åšäº†å¤„ç†<br><img src="/jackson%E8%A7%A3%E6%9E%90%E6%9C%89%E6%95%B0%E7%BB%84%E7%9A%84xml_images/f6c58e74.png"></p></li><li><p>ä¿®æ”¹XmlDemoReqDtoçš„å®šä¹‰ï¼Œä»£ç ä¿®æ”¹åå¦‚ä¸‹ï¼š</p></li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Builder</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XmlDemoReqDto</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"USER_NAME"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">UserName</span><span class="token punctuation">;</span>    <span class="token comment">// æ­¤å¤„æœ‰å˜æ›´</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANYS"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Companys</span> companys<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// æ–°å¢ä¸€ä¸ªCompanysçš„å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«company list</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Companys</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANY"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Company</span><span class="token punctuation">></span></span> companies<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Company</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANYNAME"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> companyName<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŒ‰ç…§ä¸Šé¢çš„å¤„ç†æ–¹å¼ï¼Œå¯ä»¥æ­£å¸¸è§£æå‡ºä¸¤ä¸ªcompanyäº†<br><img src="https://img-blog.csdnimg.cn/67e7906d1aa54e569c23e34d54b7c4bd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="é—®é¢˜é˜¶æ®µå››"><a href="#é—®é¢˜é˜¶æ®µå››" class="headerlink" title="é—®é¢˜é˜¶æ®µå››"></a>é—®é¢˜é˜¶æ®µå››</h1><p>ä»¥ä¸Šæ–¹æ³•åœ¨ä¼ å…¥çš„XMLä¸­companyå¦‚æœæ˜¯ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œé‚£æ˜¯æ­£å¸¸çš„ï¼Œä½†å¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢é‚£ç§ï¼Œå°±ä¼šå‡ºç°è§£æå¤±è´¥çš„æƒ…å†µï¼Œå‡ºç°å¼‚å¸¸â€œjava.lang.IllegalArgumentException: Cannot deserialize value of type java.util.ArrayList<Company> from Object value (token JsonToken.START_OBJECT)â€ã€‚å› ä¸ºjacksonå¤„ç†æ—¶æŠŠcompanysè§£ææˆäº†ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œè€Œélistã€‚è§£å†³æ–¹æ³•ï¼šåœ¨Companyså¯¹è±¡ä¸­æ·»åŠ @JsonFormat(with &#x3D; JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)ã€‚ä»£ç è§ä¸‹é¢</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX_HEADER</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYS_HDR_LEN</span><span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SYS_PKG_VRSN</span><span class="token punctuation">></span></span>01<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SYS_PKG_VRSN</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TX_HEADER</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TX_EMB</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ENTITY</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>USER_NAME</span><span class="token punctuation">></span></span>xcc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>USER_NAME</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANYS</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANY</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>COMPANYNAME</span><span class="token punctuation">></span></span>NAME-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANYNAME</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANY</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>COMPANYS</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ENTITY</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TX</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Companys</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@JacksonXmlProperty</span><span class="token punctuation">(</span>localName <span class="token operator">=</span> <span class="token string">"COMPANY"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span><span class="token keyword">with</span> <span class="token operator">=</span> <span class="token class-name">JsonFormat<span class="token punctuation">.</span>Feature</span><span class="token punctuation">.</span>ACCEPT_SINGLE_VALUE_AS_ARRAY<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Company</span><span class="token punctuation">></span></span> companies<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤„ç†ä»¥ä¸Šå››ä¸ªé˜¶æ®µé—®é¢˜ï¼Œæ¶ˆè€—äº†æˆ‘æ•´æ•´ä¸€å¤©çš„æ—¶é—´ï¼Œå¸Œæœ›èƒ½ç»™é‡åˆ°ç›¸åŒé—®é¢˜çš„æœ‹å‹ä¸€äº›è§£å†³æ€è·¯ã€‚å†æ¬¡æ„Ÿè°¢ChatGPTåœ¨å¤„ç†é—®é¢˜ä¸­ç»™çš„ä¸€äº›æ€è·¯ï¼Œå¤ªæœ‰ç”¨äº†ã€‚<br><strong>å‹‰åŠ±ï¼šæœªæ¥è¢«äººå·¥æ™ºèƒ½æ·˜æ±°çš„ä¸æ˜¯å·¥ç¨‹å¸ˆï¼Œè€Œæ˜¯ä¸ä¼šè¿ç”¨äººå·¥æ™ºèƒ½çš„å·¥ç¨‹å¸ˆ</strong></p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://github.com/FasterXML/jackson-databind/issues/2733">https://github.com/FasterXML/jackson-databind/issues/2733</a><br><a href="https://github.com/FasterXML/jackson-databind/issues/2732">https://github.com/FasterXML/jackson-databind/issues/2732</a><br><a href="https://github.com/FasterXML/jackson-dataformat-xml/issues/339">https://github.com/FasterXML/jackson-dataformat-xml/issues/339</a></p><br/><p>ğŸ‘½ä¸ªäººåšå®¢ï¼š<a href="https://everspring.github.io/">https://everspring.github.io/</a><br>ğŸ‘½å…¬ä¼—å·ï¼šçˆ±å†å²çš„ITç”·</p>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> jackson </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ArthasæŸ¥çœ‹SpringBooté…ç½®åŠognl ClassNotFoundExceptionå¤„ç†</title>
      <link href="/2022/03/27/arthas-cha-kan-springboot-pei-zhi-ji-ognl-classnotfoundexception-chu-li/"/>
      <url>/2022/03/27/arthas-cha-kan-springboot-pei-zhi-ji-ognl-classnotfoundexception-chu-li/</url>
      
        <content type="html"><![CDATA[<p>èƒ½è®²åˆ°è¿™ç¯‡æ–‡ç« çš„åŒå­¦å·²ç»çŸ¥é“Arthasæ˜¯ä»€ä¹ˆäº†ï¼Œè¿™é‡Œå°±ä¸å¤šä½™èµ˜è¿°ï¼Œæœ¬æ–‡ä»‹ç»ä¸€ä¸‹é€šè¿‡ArthasæŸ¥çœ‹SpringBootå·¥ç¨‹çš„é…ç½®åŠæ›¾é‡åˆ°è¿‡çš„é—®é¢˜ã€‚<br>æœ¬æ–‡ç›¸å…³çŸ¥è¯†ï¼š<code>sc</code>ï¼Œ<code>ognl</code>ï¼Œ<code>springé…ç½®ä¿å­˜çš„åœ°æ–¹</code></p><blockquote><p>æ³¨æ„ï¼šognlæ˜¯3.5.0ä»¥åå‡ºç°çš„</p></blockquote><ol><li>arthasæœ‰å¯ä»¥æŸ¥çœ‹JVMç¯å¢ƒå˜é‡çš„<code>sysenv</code>ï¼Œä¹Ÿæœ‰å¯ä»¥æŸ¥çœ‹å’Œä¿®æ”¹JVMçš„ç³»ç»Ÿå±æ€§çš„<code>sysprop</code>ï¼Œä½†SpringBooté…ç½®æ–‡ä»¶çš„å†…å®¹ä¸æ˜¯åœ¨ç¯å¢ƒå˜é‡å’Œç³»ç»Ÿå±æ€§ä¸­çš„ï¼Œè€Œæ˜¯åœ¨<code>ConfigurableApplicationContext</code>çš„<code>environment</code>ã€‚<code>ConfigurableApplicationContext</code>ç»§æ‰¿è‡ª<code>ApplicationContext</code>ï¼Œåœ¨æˆ‘ä»¬çš„å·¥ç¨‹ä¸­ç»å¸¸è¦ç”¨åˆ°ApplicationContextï¼Œå¯ä»¥ä»ApplicationContextå…¥æ‰‹æ‹¿åˆ°environmentã€‚</li><li>é€šè¿‡ognlè¡¨è¾¾å¼è·å–ï¼Œognlåœ¨javaä¸­è¿ç”¨å¹¿æ³›ï¼Œæ¯”å¦‚Spring Cacheçš„æ³¨è§£ã€Spring @Valueæ³¨è§£éƒ½æœ‰ç”¨åˆ°ã€‚å‡å¦‚å·¥ç¨‹ä¸‹æœ‰ä¸€ä¸ªcom.xxx.spring.util.SpringUtilsï¼ˆè§æ–‡æœ«ï¼‰å¯ä»¥è·å–åˆ°ApplicationContextï¼Œæƒ³è¦è·å–åˆ°application.ymlä¸­åœ¨server.portçš„å€¼ï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•<pre class="line-numbers language-none"><code class="language-none">ognl &#39;#context&#x3D;@com.xxx.util.SpringUtils@applicationContext,#context.getEnvironment().getProperty(&quot;server.port&quot;)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>#context â€“ä»£è¡¨çš„å˜é‡<br>@com.xxx.util.SpringUtils â€“æŒ‡å®šçš„ç±»<br>@applicationContext â€“ç±»çš„å±æ€§<br>#context.getEnvironment().getProperty(â€œserver.portâ€) â€“é€šè¿‡contextè·å–åˆ°environmentå±æ€§ï¼Œç„¶åå†é€šè¿‡environmentè·å–åˆ°propertyçš„å€¼</p></blockquote></li><li>æœ‰äº›æƒ…å†µä¸‹é€šè¿‡ognlè·å–applicationContextçš„æ—¶å€™ä¼šå‡ºç°<code>ClassNotFoundException</code>ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š<blockquote><p>Failed to execute ognl, exception message: ognl.OgnlException: Could not get static field applicationContext from class com.xxx.util.SpringUtils [java.lang.ClassNotFoundException: Unable to resolve class: com.xxx.util.SpringUtils], please check $HOME&#x2F;logs&#x2F;arthas&#x2F;arthas.log for more details.</p></blockquote></li></ol><p>å‡ºç°æ­¤ç±»é—®é¢˜æ˜¯ç”±äºclassloaderä¸æ˜¯é»˜è®¤åŠ è½½å™¨å¯¼è‡´ï¼Œè§å®˜ç½‘issueï¼š<a href="https://github.com/alibaba/arthas/issues/71">https://github.com/alibaba/arthas/issues/71</a><br><strong>è§£å†³æ–¹æ³•ï¼š</strong> </p><ul><li>1.é€šè¿‡sc -d æŸ¥è¯¢å‡ºå½“å‰ç±»çš„classloader<pre class="line-numbers language-none"><code class="language-none">sc -d com.xxx.util.SpringUtils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082343338.png" alt="å›¾1" style="zoom: 50%;" /></li></ul><p>è·å–åˆ°classLoaderHashå€¼</p><ul><li>2.ä½¿ç”¨æŒ‡å®šçš„classloaderã€‚ognl -c classloaderçš„hashå€¼<pre class="line-numbers language-none"><code class="language-none">ognl &#39;#context&#x3D;@com.jinju.juke.common.utils.spring.SpringUtils@applicationContext,#context.getEnvironment().getProperty(&quot;dev.name&quot;)&#39; -c 20ad941<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><hr><p>SpringUtilsçš„ä»£ç </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SpringUtils</span> <span class="token keyword">implements</span> <span class="token class-name">BeanFactoryPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationContextAware</span><span class="token punctuation">&#123;</span>    <span class="token comment">/** Springåº”ç”¨ä¸Šä¸‹æ–‡ç¯å¢ƒ */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringUtils</span><span class="token punctuation">.</span>beanFactory <span class="token operator">=</span> beanFactory<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringUtils</span><span class="token punctuation">.</span>applicationContext <span class="token operator">=</span> applicationContext<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è·å–å¯¹è±¡     *     * @param name     * @return Object ä¸€ä¸ªä»¥æ‰€ç»™åå­—æ³¨å†Œçš„beançš„å®ä¾‹     * @throws org.springframework.beans.BeansException     *     */</span>    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">T</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Arthas </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLå­—ç¬¦ä¸²ç›¸åŠ å¼•å‘çš„è¡€æ¡ˆ</title>
      <link href="/2022/02/16/mysql-zi-fu-chuan-xiang-jia-yin-fa-de-xie-an/"/>
      <url>/2022/02/16/mysql-zi-fu-chuan-xiang-jia-yin-fa-de-xie-an/</url>
      
        <content type="html"><![CDATA[<p>æ™šä¸Šæ¥åˆ°åŒäº‹ç”µè¯ï¼Œè¯´æœ‰å‡ åå¼ è¡¨çš„æ•°æ®å…¨è¢«åˆ é™¤äº†ï¼Œå½“æ—¶æ‡µé€¼äº†ã€‚<br>å…ˆè¯´èƒŒæ™¯ï¼šç¯å¢ƒæ˜¯MySQL 5.7.16ï¼Œæ•°æ®æ˜¯åœ¨è¿ç»´è¿‡ç¨‹ä¸­è¿è¡Œçš„DELETEè¯­å¥å¯¼è‡´ã€‚é€‰æ‹©å…¶ä¸­ä¸€æ¡ä¸ºä¾‹</p><pre class="line-numbers language-SQL" data-language="SQL"><code class="language-SQL">delete from fcexam where bussno in (&#39;GBD000000016323&#39;+&#39;GBD000000016325&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>fcexamçš„bussnoç»“æ„ä¸ºvarcharï¼Œæœ¬æ„æ˜¯åˆ é™¤GBD000000016323ã€GBD000000016325è¿™ä¸¤æ¡æ•°æ®ï¼Œä½†æŠŠ,å†™æˆäº†+ã€‚delete fromæ”¹æˆselectæŸ¥è¯¢ä¸€æ¬¡ï¼Œå‘ç°æ•°æ®å…¨è¢«æŸ¥å‡ºæ¥äº†ï¼Œæ‰€ä»¥deleteçš„æ‰€æœ‰æ•°æ®ã€‚<br><strong>åŸå› åˆ†æ</strong><br>è¿™è·ŸMySQLä¸­å­—ç¬¦ä¸²åŠ å‡ä¹˜é™¤ã€å­—ç¬¦ä¸²ä¸0&#x2F;1æ¯”è¾ƒæœ‰å…³ã€‚</p><h4 id="1-å­—ç¬¦ä¸²åŠ å‡ä¹˜é™¤"><a href="#1-å­—ç¬¦ä¸²åŠ å‡ä¹˜é™¤" class="headerlink" title="1. å­—ç¬¦ä¸²åŠ å‡ä¹˜é™¤"></a>1. å­—ç¬¦ä¸²åŠ å‡ä¹˜é™¤</h4><blockquote><p>åœ¨mysqlå½“ä¸­,å­—ç¬¦ä¸²ç±»å‹é—´è¿›è¡ŒåŠ å‡ä¹˜é™¤è¿ç®—çš„æ—¶å€™,ä¼š<code>æˆªå–å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´çš„é‚£ä¸€éƒ¨åˆ†æ•°å­—è¿›è¡Œè¿ç®—</code>,å¦‚æœå­—ç¬¦ä¸²å‰é¢æ²¡æœ‰æ•°å­—,é‚£ä¹ˆå°±åªèƒ½æˆªå–çš„æ•°å€¼ä¸º0,é‚£ä¹ˆè¿›è¡ŒåŠ å‡çš„æ—¶å€™ç»“æœéƒ½æ˜¯0,è¿›è¡Œä¹˜é™¤çš„æ—¶å€™ç»“æœéƒ½æ˜¯NULL<br>æ„Ÿè°¢é“¾æ¥ä½œè€…ï¼šä¸å§“é©¬çš„å°é©¬å“¥<br>æ–‡ç« åœ°å€ï¼š<a href="https://www.jianshu.com/p/2ab2c0dc3cb5">https://www.jianshu.com/p/2ab2c0dc3cb5</a></p></blockquote><pre class="line-numbers language-none"><code class="language-none">select (&#39;GBD000000016323&#39;+&#39;GBD000000016325&#39;); --ç»“æœä¸º0select (&#39;GBD000000016323&#39;&#x2F;&#39;GBD000000016325&#39;); --ç»“æœä¸ºnullselect (&#39;GBD000000016323&#39;*&#39;GBD000000016325&#39;); --ç»“æœä¸º0select (&#39;1GBD000000016323&#39;+&#39;GBD000000016325&#39;); --ç»“æœä¸º1select (&#39;1GBD000000016323&#39;+&#39;2GBD000000016325&#39;); --ç»“æœä¸º3select (&#39;1GBD000000016323&#39;&#x2F;&#39;GBD000000016325&#39;); --ç»“æœä¸ºnull<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-å­—ç¬¦ä¸²ä¸0ã€1æ¯”è¾ƒ"><a href="#2-å­—ç¬¦ä¸²ä¸0ã€1æ¯”è¾ƒ" class="headerlink" title="2. å­—ç¬¦ä¸²ä¸0ã€1æ¯”è¾ƒ"></a>2. å­—ç¬¦ä¸²ä¸0ã€1æ¯”è¾ƒ</h4><p>MySQL booleanç±»å‹0ä»£è¡¨falseï¼Œ1ä»£è¡¨trueã€‚å­—ç¬¦ä¸²å¼€å¤´æ²¡æœ‰æ•°å­—æ—¶ä¸0ã€1æ¯”è¾ƒï¼Œå¦‚æœæ˜¯å’Œ0æ¯”è¾ƒï¼Œå¾—åˆ°çš„ç»“æœæ˜¯1ä¹Ÿå°±æ˜¯trueï¼Œå’Œå…¶ä»–æ•°å­—æ¯”è¾ƒç»“æœæ˜¯0ä¹Ÿå°±æ˜¯false</p><pre class="line-numbers language-none"><code class="language-none">select &#39;GBD000000016323&#39;&#x3D;0; --ç»“æœä¸º1select &#39;1GBD000000016323&#39;&#x3D;1; --ç»“æœä¸º1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥åœ¨æˆ‘ä»¬è·‘çš„è„šæœ¬é‡Œé¢ï¼Œå› ä¸ºbussnoéƒ½æ˜¯â€™GBDâ€™å¼€å¤´ï¼Œè½¬æ¢å‡ºæ¥å°±æ˜¯where 0 &#x3D; 0ï¼Œwhereæ¡ä»¶ç»“æœä¸ºtrueå°±æŠŠæ‰€ä»¥æ•°æ®éƒ½æŸ¥è¯¢å‡ºæ¥äº†ã€‚</p><pre class="line-numbers language-none"><code class="language-none">select * from fcexam where bussno in (&#39;GBD000000016323&#39;+&#39;GBD000000016325&#39;); --ç­‰äºæ˜¯select * from fcexam where 0 in (0);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‡å¦‚bussnoæœ‰3æ¡æ•°æ®ï¼Œâ€™GBD000000016323â€™ï¼Œâ€™GBD000000016325â€™ï¼Œâ€™2GBD000000016325â€™ï¼Œç”¨ä¸Šé¢çš„SQLåªèƒ½æŸ¥å‡ºå‰é¢2æ¡ï¼Œæœ€åä¸€æ¡å› ä¸ºæ˜¯2å¼€å¤´æ‰€ä»¥æŸ¥è¯¢ä¸å‡ºæ¥</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><pre class="line-numbers language-SQL" data-language="SQL"><code class="language-SQL">delete from fcexam where bussno in (&#39;GBD000000016323&#39;+&#39;GBD000000016325&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ¡SQLç›¸å½“äºå°±æ˜¯</p><pre class="line-numbers language-none"><code class="language-none">delete from fcexam where 0 in (0)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‚è€ƒèµ„æ–™ï¼š</p><ol><li><a href="https://www.jianshu.com/p/2ab2c0dc3cb5">https://www.jianshu.com/p/2ab2c0dc3cb5</a></li><li><a href="https://stackoverflow.com/questions/22080382/mysql-why-comparing-a-string-to-0-gives-true">https://stackoverflow.com/questions/22080382/mysql-why-comparing-a-string-to-0-gives-true</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº†è§£å¼€æºåè®®</title>
      <link href="/2022/02/12/kai-yuan-xie-yi/"/>
      <url>/2022/02/12/kai-yuan-xie-yi/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å…³äºå¼€æºä»£ç çš„æ–°é—»å±‚å‡ºä¸ç©·ï¼Œæ¯”å¦‚fake.jsä½œè€…åˆ é™¤äº†æ‰€æœ‰ä»£ç å¼•èµ·çš„äº‰è®ºæˆ˜ç«ã€‚è€Œç‰µå¼•å¼€æºä»£ç çš„çº¿â€“å¼€æºåè®®ä¹Ÿè¢«å¤§å®¶é‡è§†èµ·æ¥ï¼Œä¹‹å‰å›½å†…å¼€å‘äººå‘˜å¯¹å¼€æºåè®®ä¸å¤ªé‡è§†ï¼Œéšä¾¿æ‰¾äº†å‡ ä¸ªå‘¨è¾¹çš„åŒè¡Œï¼Œå¯¹å„ç§å¼€æºåè®®éƒ½åˆ†ä¸æ¸…æ¥šã€‚ç½‘ä¸Šäº†è§£äº†ä¸€ç¿»ï¼Œåšä¸ªæ€»ç»“</p><p>æ„Ÿè°¢ä»¥ä¸‹æ–‡ç« ã€è§†é¢‘ä½œè€…æä¾›èµ„æ–™ï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»ã€‚</p><ol><li><a href="https://www.bilibili.com/video/BV1i3411b7xp?from=search&seid=7966784787421644790&spm_id_from=333.337.0.0">ã€Šæœ€æµè¡Œçš„å¼€æºåè®®ä»€ä¹ˆï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„å¼€æºåè®®ï¼Ÿä¸­å›½ç¬¬ä¸€ä¸ªè¿åGPLçš„æ¡ˆä¾‹ï¼Œè…¾è®¯å½±éŸ³ä¸ºä»€ä¹ˆä¼šè¢«ffmepgè°´è´£â€”â€”TechParty1204å°æ²™é¾™ç¬¬2ä¸ªä¸»é¢˜åˆ†äº«ã€‹</a></li><li><a href="https://www.runoob.com/w3cnote/open-source-license.html">ã€Šå„ç§å¼€æºåè®®ä»‹ç»ã€‹</a></li></ol><h3 id="ä¸€ã€-å¼€æºåè®®çš„å…­ä¸ªç‰¹æ€§"><a href="#ä¸€ã€-å¼€æºåè®®çš„å…­ä¸ªç‰¹æ€§" class="headerlink" title="ä¸€ã€ å¼€æºåè®®çš„å…­ä¸ªç‰¹æ€§"></a>ä¸€ã€ å¼€æºåè®®çš„å…­ä¸ªç‰¹æ€§</h3><p><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082344847.png" alt="image-20220213004304500"></p><h3 id="äºŒã€å¦‚ä½•é€‰æ‹©å¼€æºåè®®"><a href="#äºŒã€å¦‚ä½•é€‰æ‹©å¼€æºåè®®" class="headerlink" title="äºŒã€å¦‚ä½•é€‰æ‹©å¼€æºåè®®"></a>äºŒã€å¦‚ä½•é€‰æ‹©å¼€æºåè®®</h3><p><img src="https://raw.githubusercontent.com/EverSpring/picbed/main/202205082344287.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>drools-7å…¥é—¨</title>
      <link href="/2022/01/26/drools-7/"/>
      <url>/2022/01/26/drools-7/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€éƒ¨åˆ†å­¦ä¹ çš„æ—¶å€™æ˜¯çœ‹çš„é»‘é©¬åšå­¦è°·çš„å­¦ä¹ è§†é¢‘ã€‚ä¸‹é¢ç¬”è®°ä¹Ÿæ˜¯éšå ‚ç¬”è®°ã€‚<br>ç¬”è€…æ”¾åœ¨è¿™é‡Œæ˜¯ä¸ºäº†æ–¹ä¾¿è§‚çœ‹ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤ã€‚<br>æ³¨æ„ï¼šSpringBootç‰ˆæœ¬å’ŒDroolsç‰ˆæœ¬ç›´æ¥çš„å…¼å®¹é—®é¢˜ã€‚<br>Mavenä»“åº“ï¼š</p><p>Droolsï¼š<a href="https://mvnrepository.com/artifact/org.kie/kie-spring">https://mvnrepository.com/artifact/org.kie/kie-spring</a>  </p><p>SpringBootï¼š <a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot">https://mvnrepository.com/artifact/org.springframework.boot/spring-boot</a></p><p>SpringBootæ˜¯2.0.x  å¯¹åº”çš„Droolsç”¨çš„7.6.x</p><p>SpringBoot 1.4.5 å¯¹åº”çš„Droolsåº”è¯¥æ˜¯7.0.x</p><h2 id="1-é—®é¢˜å¼•å‡º"><a href="#1-é—®é¢˜å¼•å‡º" class="headerlink" title="1. é—®é¢˜å¼•å‡º"></a>1. é—®é¢˜å¼•å‡º</h2><p>ç°æœ‰ä¸€ä¸ªåœ¨çº¿ç”³è¯·ä¿¡ç”¨å¡çš„ä¸šåŠ¡åœºæ™¯ï¼Œç”¨æˆ·éœ€è¦å½•å…¥ä¸ªäººä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200114163727767.png" alt="image-20200114163727767"></p><p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œç”¨æˆ·å½•å…¥çš„ä¸ªäººä¿¡æ¯åŒ…æ‹¬å§“åã€æ€§åˆ«ã€å¹´é¾„ã€å­¦å†ã€ç”µè¯ã€æ‰€åœ¨å…¬å¸ã€èŒä½ã€æœˆæ”¶å…¥ã€æ˜¯å¦æœ‰æˆ¿ã€æ˜¯å¦æœ‰è½¦ã€æ˜¯å¦æœ‰ä¿¡ç”¨å¡ç­‰ã€‚å½•å…¥å®Œæˆåç‚¹å‡»ç”³è¯·æŒ‰é’®æäº¤å³å¯ã€‚</p><p>ç”¨æˆ·æäº¤ç”³è¯·åï¼Œéœ€è¦åœ¨ç³»ç»Ÿçš„æœåŠ¡ç«¯è¿›è¡Œ<strong>ç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§æ£€æŸ¥</strong>(æ˜¯å¦æœ‰èµ„æ ¼ç”³è¯·ä¿¡ç”¨å¡)ï¼Œåªæœ‰é€šè¿‡åˆæ³•æ€§æ£€æŸ¥çš„ç”¨æˆ·æ‰å¯ä»¥æˆåŠŸç”³è¯·åˆ°ä¿¡ç”¨å¡(æ³¨æ„ï¼šä¸åŒç”¨æˆ·æœ‰å¯èƒ½ç”³è¯·åˆ°çš„ä¿¡ç”¨å¡é¢åº¦ä¸åŒ)ã€‚</p><p>æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´1</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“ä»¥ä¸‹ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº5000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">2</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´2</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“æˆ–æœ¬ç§‘ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº3000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">3</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´3</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºæœ¬ç§‘ä»¥ä¸Šï¼Œå¹¶ä¸”æœˆè–ªå°‘äº2000ï¼ŒåŒæ—¶ä¹‹å‰æ²¡æœ‰ä¿¡ç”¨å¡çš„ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">4</td><td align="left">æ£€æŸ¥ç”³è¯·äººå·²æœ‰çš„ä¿¡ç”¨å¡æ•°é‡</td><td align="left">å¦‚æœç”³è¯·äººç°æœ‰çš„ä¿¡ç”¨å¡æ•°é‡å¤§äº10ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr></tbody></table><p>ç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§æ£€æŸ¥é€šè¿‡åï¼Œè¿˜éœ€è¦æ ¹æ®å¦‚ä¸‹<strong>ä¿¡ç”¨å¡å‘æ”¾è§„åˆ™</strong>ç¡®å®šç”¨æˆ·æ‰€åŠä¿¡ç”¨å¡çš„é¢åº¦ï¼š</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">è§„åˆ™1</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æœ‰è½¦ï¼Œæˆ–è€…æœˆæ”¶å…¥åœ¨20000ä»¥ä¸Šï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º15000</td></tr><tr><td align="left">2</td><td align="left">è§„åˆ™2</td><td align="left">å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œä½†æœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º6000</td></tr><tr><td align="left">3</td><td align="left">è§„åˆ™3</td><td align="left">å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º3000</td></tr><tr><td align="left">4</td><td align="left">è§„åˆ™4</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º5000</td></tr><tr><td align="left">5</td><td align="left">è§„åˆ™5</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ˜¯æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º8000</td></tr></tbody></table><p>æ€è€ƒï¼šå¦‚ä½•å®ç°ä¸Šé¢çš„ä¸šåŠ¡é€»è¾‘å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æœ€å®¹æ˜“æƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨åˆ†æ”¯åˆ¤æ–­(if else)æ¥å®ç°ï¼Œä¾‹å¦‚é€šè¿‡å¦‚ä¸‹ä»£ç æ¥æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æ­¤å¤„ä¸ºä¼ªä»£ç </span><span class="token comment">//æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§ï¼Œè¿”å›trueè¡¨ç¤ºæ£€æŸ¥é€šè¿‡ï¼Œè¿”å›falseè¡¨ç¤ºæ£€æŸ¥ä¸é€šè¿‡</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“ä»¥ä¸‹ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº5000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getHouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getcar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"å¤§ä¸“ä»¥ä¸‹"</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>getSalary <span class="token operator">&lt;</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“æˆ–æœ¬ç§‘ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº3000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getHouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getcar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"å¤§ä¸“æˆ–æœ¬ç§‘"</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>getSalary <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºæœ¬ç§‘ä»¥ä¸Šï¼Œå¹¶ä¸”æœˆè–ªå°‘äº2000ï¼ŒåŒæ—¶ä¹‹å‰æ²¡æœ‰ä¿¡ç”¨å¡çš„ï¼Œé‚£ä¹ˆä¸é€šè¿‡</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getHouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getcar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"æœ¬ç§‘ä»¥ä¸Š"</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>getSalary <span class="token operator">&lt;</span> <span class="token number">2000</span>        <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span><span class="token function">getHasCreditCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å¦‚æœç”³è¯·äººç°æœ‰çš„ä¿¡ç”¨å¡æ•°é‡å¤§äº10ï¼Œé‚£ä¹ˆä¸é€šè¿‡</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getCreditCardCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç”¨æˆ·ä¿¡æ¯åˆæ³•æ€§æ£€æŸ¥é€šè¿‡åï¼Œè¿˜éœ€è¦é€šè¿‡å¦‚ä¸‹ä»£ç ç¡®å®šç”¨æˆ·æ‰€åŠä¿¡ç”¨å¡çš„é¢åº¦ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;æ­¤å¤„ä¸ºä¼ªä»£ç &#x2F;&#x2F;æ ¹æ®ç”¨æˆ·è¾“å…¥ä¿¡æ¯ç¡®å®šä¿¡ç”¨å¡é¢åº¦public Integer determineCreditCardLimit(User user)&#123;    &#x2F;&#x2F;å¦‚æœç”³è¯·äººæœ‰æˆ¿æœ‰è½¦ï¼Œæˆ–è€…æœˆæ”¶å…¥åœ¨20000ä»¥ä¸Šï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º15000    if((user.getHouse() !&#x3D; null &amp;&amp; user.getcar() !&#x3D; null)        || user.getSalary() &gt; 20000)&#123;        return 15000;    &#125;    &#x2F;&#x2F;å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œå¹¶ä¸”æœˆæ”¶å…¥åœ¨10000åˆ°20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º6000    else if(user.getHouse() &#x3D;&#x3D; null        &amp;&amp; user.getcar() &#x3D;&#x3D; null       &amp;&amp; user.getSalary() &gt; 10000        &amp;&amp; user.getSalary() &lt; 20000)&#123;        return 6000;    &#125;    &#x2F;&#x2F;å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œå¹¶ä¸”æœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º3000    else if(user.getHouse() &#x3D;&#x3D; null        &amp;&amp; user.getcar() &#x3D;&#x3D; null       &amp;&amp; user.getSalary() &lt; 10000)&#123;        return 3000;    &#125;    &#x2F;&#x2F;å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œå¹¶ä¸”æœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º5000    else if((((user.getHouse() !&#x3D; null &amp;&amp; user.getcar() &#x3D;&#x3D; null) || (user.getHouse() &#x3D;&#x3D; null &amp;&amp; user.getcar() !&#x3D; null))       &amp;&amp; user.getSalary() &lt; 10000)&#123;        return 5000;    &#125;    &#x2F;&#x2F;å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œå¹¶ä¸”æœˆæ”¶å…¥åœ¨10000åˆ°20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º8000    else if((((user.getHouse() !&#x3D; null &amp;&amp; user.getcar() &#x3D;&#x3D; null) || (user.getHouse() &#x3D;&#x3D; null &amp;&amp; user.getcar() !&#x3D; null))       &amp;&amp; (user.getSalary() &gt; 10000 &amp;&amp; user.getSalary() &lt; 20000))&#123;        return 8000;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šé¢çš„ä¼ªä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡è§„åˆ™æ˜¯é€šè¿‡Javaä»£ç çš„æ–¹å¼å®ç°çš„ã€‚è¿™ç§å®ç°æ–¹å¼å­˜åœ¨å¦‚ä¸‹é—®é¢˜ï¼š</p><p>1ã€ç¡¬ç¼–ç å®ç°ä¸šåŠ¡è§„åˆ™éš¾ä»¥ç»´æŠ¤</p><p>2ã€ç¡¬ç¼–ç å®ç°ä¸šåŠ¡è§„åˆ™éš¾ä»¥åº”å¯¹å˜åŒ–</p><p>3ã€ä¸šåŠ¡è§„åˆ™å‘ç”Ÿå˜åŒ–éœ€è¦ä¿®æ”¹ä»£ç ï¼Œé‡å¯æœåŠ¡åæ‰èƒ½ç”Ÿæ•ˆ</p><p>é‚£ä¹ˆé¢å¯¹ä¸Šé¢çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¿˜æœ‰ä»€ä¹ˆå¥½çš„å®ç°æ–¹å¼å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯<strong>è§„åˆ™å¼•æ“</strong>ã€‚</p><h2 id="2-è§„åˆ™å¼•æ“æ¦‚è¿°"><a href="#2-è§„åˆ™å¼•æ“æ¦‚è¿°" class="headerlink" title="2. è§„åˆ™å¼•æ“æ¦‚è¿°"></a>2. è§„åˆ™å¼•æ“æ¦‚è¿°</h2><h3 id="2-1-ä»€ä¹ˆæ˜¯è§„åˆ™å¼•æ“"><a href="#2-1-ä»€ä¹ˆæ˜¯è§„åˆ™å¼•æ“" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯è§„åˆ™å¼•æ“"></a>2.1 ä»€ä¹ˆæ˜¯è§„åˆ™å¼•æ“</h3><p><strong>è§„åˆ™å¼•æ“</strong>ï¼Œå…¨ç§°ä¸º<strong>ä¸šåŠ¡è§„åˆ™ç®¡ç†ç³»ç»Ÿ</strong>ï¼Œè‹±æ–‡åä¸ºBRMS(å³Business Rule Management System)ã€‚è§„åˆ™å¼•æ“çš„ä¸»è¦æ€æƒ³æ˜¯å°†åº”ç”¨ç¨‹åºä¸­çš„ä¸šåŠ¡å†³ç­–éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶ä½¿ç”¨é¢„å®šä¹‰çš„è¯­ä¹‰æ¨¡å—ç¼–å†™ä¸šåŠ¡å†³ç­–ï¼ˆä¸šåŠ¡è§„åˆ™ï¼‰ï¼Œç”±ç”¨æˆ·æˆ–å¼€å‘è€…åœ¨éœ€è¦æ—¶è¿›è¡Œé…ç½®ã€ç®¡ç†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è§„åˆ™å¼•æ“å¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æŠ€æœ¯æ¡†æ¶ï¼Œè€Œæ˜¯æŒ‡çš„ä¸€ç±»ç³»ç»Ÿï¼Œå³ä¸šåŠ¡è§„åˆ™ç®¡ç†ç³»ç»Ÿã€‚ç›®å‰å¸‚é¢ä¸Šå…·ä½“çš„è§„åˆ™å¼•æ“äº§å“æœ‰ï¼šdroolsã€VisualRulesã€iLogç­‰ã€‚</p><p>è§„åˆ™å¼•æ“å®ç°äº†å°†ä¸šåŠ¡å†³ç­–ä»åº”ç”¨ç¨‹åºä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œæ¥æ”¶æ•°æ®è¾“å…¥ï¼Œè§£é‡Šä¸šåŠ¡è§„åˆ™ï¼Œå¹¶æ ¹æ®ä¸šåŠ¡è§„åˆ™åšå‡ºä¸šåŠ¡å†³ç­–ã€‚è§„åˆ™å¼•æ“å…¶å®å°±æ˜¯ä¸€ä¸ªè¾“å…¥è¾“å‡ºå¹³å°ã€‚</p><p>ä¸Šé¢çš„ç”³è¯·ä¿¡ç”¨å¡ä¸šåŠ¡åœºæ™¯ä½¿ç”¨è§„åˆ™å¼•æ“åæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/media/pictures/Drools.assets/4.png" alt="4"></p><p>ç³»ç»Ÿä¸­å¼•å…¥è§„åˆ™å¼•æ“åï¼Œä¸šåŠ¡è§„åˆ™ä¸å†ä»¥ç¨‹åºä»£ç çš„å½¢å¼é©»ç•™åœ¨ç³»ç»Ÿä¸­ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å¤„ç†è§„åˆ™çš„è§„åˆ™å¼•æ“ï¼Œä¸šåŠ¡è§„åˆ™å­˜å‚¨åœ¨è§„åˆ™åº“ä¸­ï¼Œå®Œå…¨ç‹¬ç«‹äºç¨‹åºã€‚ä¸šåŠ¡äººå‘˜å¯ä»¥åƒç®¡ç†æ•°æ®ä¸€æ ·å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚æŸ¥è¯¢ã€æ·»åŠ ã€æ›´æ–°ã€ç»Ÿè®¡ã€æäº¤ä¸šåŠ¡è§„åˆ™ç­‰ã€‚ä¸šåŠ¡è§„åˆ™è¢«åŠ è½½åˆ°è§„åˆ™å¼•æ“ä¸­ä¾›åº”ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><h3 id="2-2-ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿"><a href="#2-2-ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿" class="headerlink" title="2.2 ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿"></a>2.2 ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿</h3><p>ä½¿ç”¨è§„åˆ™å¼•æ“çš„ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p><p>1ã€ä¸šåŠ¡è§„åˆ™ä¸ç³»ç»Ÿä»£ç åˆ†ç¦»ï¼Œå®ç°ä¸šåŠ¡è§„åˆ™çš„é›†ä¸­ç®¡ç†</p><p>2ã€åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹å¯éšæ—¶å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œæ‰©å±•å’Œç»´æŠ¤</p><p>3ã€å¯ä»¥åŠ¨æ€ä¿®æ”¹ä¸šåŠ¡è§„åˆ™ï¼Œä»è€Œå¿«é€Ÿå“åº”éœ€æ±‚å˜æ›´</p><p>4ã€è§„åˆ™å¼•æ“æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œåªå…³å¿ƒä¸šåŠ¡è§„åˆ™ï¼Œä½¿å¾—ä¸šåŠ¡åˆ†æäººå‘˜ä¹Ÿå¯ä»¥å‚ä¸ç¼–è¾‘ã€ç»´æŠ¤ç³»ç»Ÿçš„ä¸šåŠ¡è§„åˆ™</p><p>5ã€å‡å°‘äº†ç¡¬ç¼–ç ä¸šåŠ¡è§„åˆ™çš„æˆæœ¬å’Œé£é™©</p><p>6ã€ä½¿ç”¨è§„åˆ™å¼•æ“æä¾›çš„è§„åˆ™ç¼–è¾‘å·¥å…·ï¼Œä½¿å¤æ‚çš„ä¸šåŠ¡è§„åˆ™å®ç°å˜å¾—çš„ç®€å•</p><h3 id="2-3-è§„åˆ™å¼•æ“åº”ç”¨åœºæ™¯"><a href="#2-3-è§„åˆ™å¼•æ“åº”ç”¨åœºæ™¯" class="headerlink" title="2.3 è§„åˆ™å¼•æ“åº”ç”¨åœºæ™¯"></a>2.3 è§„åˆ™å¼•æ“åº”ç”¨åœºæ™¯</h3><p>å¯¹äºä¸€äº›å­˜åœ¨æ¯”è¾ƒå¤æ‚çš„ä¸šåŠ¡è§„åˆ™å¹¶ä¸”ä¸šåŠ¡è§„åˆ™ä¼šé¢‘ç¹å˜åŠ¨çš„ç³»ç»Ÿæ¯”è¾ƒé€‚åˆä½¿ç”¨è§„åˆ™å¼•æ“ï¼Œå¦‚ä¸‹ï¼š</p><p>1ã€é£é™©æ§åˆ¶ç³»ç»Ÿâ€”-é£é™©è´·æ¬¾ã€é£é™©è¯„ä¼°</p><p>2ã€åæ¬ºè¯ˆé¡¹ç›®â€”-é“¶è¡Œè´·æ¬¾ã€å¾ä¿¡éªŒè¯</p><p>3ã€å†³ç­–å¹³å°ç³»ç»Ÿâ€”-è´¢åŠ¡è®¡ç®—</p><p>4ã€ä¿ƒé”€å¹³å°ç³»ç»Ÿâ€”-æ»¡å‡ã€æ‰“æŠ˜ã€åŠ ä»·è´­</p><h3 id="2-4-Droolsä»‹ç»"><a href="#2-4-Droolsä»‹ç»" class="headerlink" title="2.4 Droolsä»‹ç»"></a>2.4 Droolsä»‹ç»</h3><p>droolsæ˜¯ä¸€æ¬¾ç”±JBossç»„ç»‡æä¾›çš„åŸºäºJavaè¯­è¨€å¼€å‘çš„å¼€æºè§„åˆ™å¼•æ“ï¼Œå¯ä»¥å°†å¤æ‚ä¸”å¤šå˜çš„ä¸šåŠ¡è§„åˆ™ä»ç¡¬ç¼–ç ä¸­è§£æ”¾å‡ºæ¥ï¼Œä»¥è§„åˆ™è„šæœ¬çš„å½¢å¼å­˜æ”¾åœ¨æ–‡ä»¶æˆ–ç‰¹å®šçš„å­˜å‚¨ä»‹è´¨ä¸­(ä¾‹å¦‚å­˜æ”¾åœ¨æ•°æ®åº“ä¸­)ï¼Œä½¿å¾—ä¸šåŠ¡è§„åˆ™çš„å˜æ›´ä¸éœ€è¦ä¿®æ”¹é¡¹ç›®ä»£ç ã€é‡å¯æœåŠ¡å™¨å°±å¯ä»¥åœ¨çº¿ä¸Šç¯å¢ƒç«‹å³ç”Ÿæ•ˆã€‚</p><p>droolså®˜ç½‘åœ°å€ï¼š<a href="https://drools.org/">https://drools.org/</a></p><p>droolsæºç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/kiegroup/drools">https://github.com/kiegroup/drools</a></p><p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨droolsæ—¶ï¼Œå³å¯ä»¥å•ç‹¬ä½¿ç”¨ä¹Ÿå¯ä»¥æ•´åˆspringä½¿ç”¨ã€‚å¦‚æœå•ç‹¬ä½¿ç”¨åªéœ€è¦å¯¼å…¥å¦‚ä¸‹mavenåæ ‡å³å¯ï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨IDEAå¼€å‘droolsåº”ç”¨ï¼ŒIDEAä¸­å·²ç»é›†æˆäº†droolsæ’ä»¶ã€‚å¦‚æœä½¿ç”¨eclipseå¼€å‘droolsåº”ç”¨è¿˜éœ€è¦å•ç‹¬å®‰è£…droolsæ’ä»¶ã€‚</p><p>drools APIå¼€å‘æ­¥éª¤å¦‚ä¸‹ï¼š<img src="/media/pictures/Drools.assets/5.png" alt="5"></p><h2 id="3-Droolså…¥é—¨æ¡ˆä¾‹"><a href="#3-Droolså…¥é—¨æ¡ˆä¾‹" class="headerlink" title="3. Droolså…¥é—¨æ¡ˆä¾‹"></a>3. Droolså…¥é—¨æ¡ˆä¾‹</h2><p>æœ¬å°èŠ‚é€šè¿‡ä¸€ä¸ªDroolså…¥é—¨æ¡ˆä¾‹æ¥è®©å¤§å®¶åˆæ­¥äº†è§£Droolsçš„ä½¿ç”¨æ–¹å¼ã€å¯¹Droolsæœ‰ä¸€ä¸ªæ•´ä½“æ¦‚å¿µã€‚</p><h3 id="3-1-ä¸šåŠ¡åœºæ™¯è¯´æ˜"><a href="#3-1-ä¸šåŠ¡åœºæ™¯è¯´æ˜" class="headerlink" title="3.1 ä¸šåŠ¡åœºæ™¯è¯´æ˜"></a>3.1 ä¸šåŠ¡åœºæ™¯è¯´æ˜</h3><p>ä¸šåŠ¡åœºæ™¯ï¼šæ¶ˆè´¹è€…åœ¨å›¾ä¹¦å•†åŸè´­ä¹°å›¾ä¹¦ï¼Œä¸‹å•åéœ€è¦åœ¨æ”¯ä»˜é¡µé¢æ˜¾ç¤ºè®¢å•ä¼˜æƒ åçš„ä»·æ ¼ã€‚å…·ä½“ä¼˜æƒ è§„åˆ™å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">è§„åˆ™åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">è§„åˆ™ä¸€</td><td align="left">æ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100å…ƒä»¥ä¸‹çš„æ²¡æœ‰ä¼˜æƒ </td></tr><tr><td align="left">2</td><td align="left">è§„åˆ™äºŒ</td><td align="left">æ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ</td></tr><tr><td align="left">3</td><td align="left">è§„åˆ™ä¸‰</td><td align="left">æ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨200åˆ°300å…ƒçš„ä¼˜æƒ 50å…ƒ</td></tr><tr><td align="left">4</td><td align="left">è§„åˆ™å››</td><td align="left">æ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨300å…ƒä»¥ä¸Šçš„ä¼˜æƒ 100å…ƒ</td></tr></tbody></table><p>ç°åœ¨éœ€è¦æ ¹æ®ä¸Šé¢çš„è§„åˆ™è®¡ç®—ä¼˜æƒ åçš„ä»·æ ¼ã€‚</p><h3 id="3-2-å¼€å‘å®ç°"><a href="#3-2-å¼€å‘å®ç°" class="headerlink" title="3.2 å¼€å‘å®ç°"></a>3.2 å¼€å‘å®ç°</h3><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹drools_quickstartå¹¶å¯¼å…¥droolsç›¸å…³mavenåæ ‡</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.10.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šæ ¹æ®droolsè¦æ±‚åˆ›å»ºresources&#x2F;META-INF&#x2F;kmodule.xmlé…ç½®æ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kmodule</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.drools.org/xsd/kmodule<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        name:æŒ‡å®škbaseçš„åç§°ï¼Œå¯ä»¥ä»»æ„ï¼Œä½†æ˜¯éœ€è¦å”¯ä¸€        packages:æŒ‡å®šè§„åˆ™æ–‡ä»¶çš„ç›®å½•ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå¡«å†™ï¼Œå¦åˆ™æ— æ³•åŠ è½½åˆ°è§„åˆ™æ–‡ä»¶        default:æŒ‡å®šå½“å‰kbaseæ˜¯å¦ä¸ºé»˜è®¤    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kbase</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myKbase1<span class="token punctuation">"</span></span> <span class="token attr-name">packages</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rules<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--            name:æŒ‡å®šksessionåç§°ï¼Œå¯ä»¥ä»»æ„ï¼Œä½†æ˜¯éœ€è¦å”¯ä¸€            default:æŒ‡å®šå½“å‰sessionæ˜¯å¦ä¸ºé»˜è®¤        --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ksession</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ksession-rule<span class="token punctuation">"</span></span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kbase</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kmodule</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šä¸Šé¢é…ç½®æ–‡ä»¶çš„åç§°å’Œä½ç½®éƒ½æ˜¯å›ºå®šå†™æ³•ï¼Œä¸èƒ½æ›´æ”¹</p><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå®ä½“ç±»Order</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token comment">/** * è®¢å• */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Double</span> originalPrice<span class="token punctuation">;</span><span class="token comment">//è®¢å•åŸå§‹ä»·æ ¼ï¼Œå³ä¼˜æƒ å‰ä»·æ ¼</span>    <span class="token keyword">private</span> <span class="token class-name">Double</span> realPrice<span class="token punctuation">;</span><span class="token comment">//è®¢å•çœŸå®ä»·æ ¼ï¼Œå³ä¼˜æƒ åä»·æ ¼</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"Order&#123;"</span> <span class="token operator">+</span>                <span class="token string">"originalPrice="</span> <span class="token operator">+</span> originalPrice <span class="token operator">+</span>                <span class="token string">", realPrice="</span> <span class="token operator">+</span> realPrice <span class="token operator">+</span>                <span class="token char">'&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Double</span> <span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> originalPrice<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOriginalPrice</span><span class="token punctuation">(</span><span class="token class-name">Double</span> originalPrice<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>originalPrice <span class="token operator">=</span> originalPrice<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Double</span> <span class="token function">getRealPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> realPrice<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRealPrice</span><span class="token punctuation">(</span><span class="token class-name">Double</span> realPrice<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>realPrice <span class="token operator">=</span> realPrice<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šåˆ›å»ºè§„åˆ™æ–‡ä»¶resources&#x2F;rules&#x2F;bookDiscount.drl</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//å›¾ä¹¦ä¼˜æƒ è§„åˆ™</span><span class="token keyword">package</span> <span class="token namespace">book<span class="token punctuation">.</span>discount</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token comment">//è§„åˆ™ä¸€ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100å…ƒä»¥ä¸‹çš„æ²¡æœ‰ä¼˜æƒ </span>rule <span class="token string">"book_discount_1"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>originalPrice <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸€ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100å…ƒä»¥ä¸‹çš„æ²¡æœ‰ä¼˜æƒ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ</span>rule <span class="token string">"book_discount_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>originalPrice <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> originalPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™ä¸‰ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨200åˆ°300å…ƒçš„ä¼˜æƒ 50å…ƒ</span>rule <span class="token string">"book_discount_3"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>originalPrice <span class="token operator">&lt;=</span> <span class="token number">300</span> <span class="token operator">&amp;&amp;</span> originalPrice <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™ä¸‰ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨200åˆ°300å…ƒçš„ä¼˜æƒ 50å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//è§„åˆ™å››ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨300å…ƒä»¥ä¸Šçš„ä¼˜æƒ 100å…ƒ</span>rule <span class="token string">"book_discount_4"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>originalPrice <span class="token operator">>=</span> <span class="token number">300</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™å››ï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨300å…ƒä»¥ä¸Šçš„ä¼˜æƒ 100å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä¼šè¯å¯¹è±¡ï¼Œç”¨äºå’Œè§„åˆ™å¼•æ“äº¤äº’</span>    <span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ„é€ è®¢å•å¯¹è±¡ï¼Œè®¾ç½®åŸå§‹ä»·æ ¼ï¼Œç”±è§„åˆ™å¼•æ“æ ¹æ®ä¼˜æƒ è§„åˆ™è®¡ç®—ä¼˜æƒ åçš„ä»·æ ¼</span>    <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    order<span class="token punctuation">.</span><span class="token function">setOriginalPrice</span><span class="token punctuation">(</span><span class="token number">210D</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…</span>    kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ¿€æ´»è§„åˆ™å¼•æ“ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™</span>    kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å…³é—­ä¼šè¯</span>    kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¼˜æƒ å‰åŸå§‹ä»·æ ¼ï¼š"</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>                       <span class="token string">"ï¼Œä¼˜æƒ åä»·æ ¼ï¼š"</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getRealPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šé¢çš„å…¥é—¨æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½¿ç”¨droolsè§„åˆ™å¼•æ“ä¸»è¦å·¥ä½œå°±æ˜¯ç¼–å†™è§„åˆ™æ–‡ä»¶ï¼Œåœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰è·Ÿä¸šåŠ¡ç›¸å…³çš„ä¸šåŠ¡è§„åˆ™ï¼Œä¾‹å¦‚æœ¬æ¡ˆä¾‹å®šä¹‰çš„å°±æ˜¯å›¾ä¹¦ä¼˜æƒ è§„åˆ™ã€‚è§„åˆ™å®šä¹‰å¥½åå°±éœ€è¦è°ƒç”¨droolsæä¾›çš„APIå°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“è¿›è¡Œè§„åˆ™æ¨¡å¼åŒ¹é…ï¼Œè§„åˆ™å¼•æ“ä¼šæ‰§è¡ŒåŒ¹é…æˆåŠŸçš„è§„åˆ™å¹¶å°†è®¡ç®—çš„ç»“æœè¿”å›ç»™æˆ‘ä»¬ã€‚</p><p>å¯èƒ½å¤§å®¶ä¼šæœ‰ç–‘é—®ï¼Œå°±æ˜¯æˆ‘ä»¬è™½ç„¶æ²¡æœ‰åœ¨ä»£ç ä¸­ç¼–å†™è§„åˆ™çš„åˆ¤æ–­é€»è¾‘ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯åœ¨è§„åˆ™æ–‡ä»¶ä¸­ç¼–å†™äº†ä¸šåŠ¡è§„åˆ™ï¼Œè¿™è·Ÿåœ¨ä»£ç ä¸­ç¼–å†™è§„åˆ™æœ‰ä»€ä¹ˆæœ¬è´¨çš„åŒºåˆ«å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‰é¢å…¶å®å·²ç»æåˆ°ï¼Œä½¿ç”¨è§„åˆ™å¼•æ“æ—¶ä¸šåŠ¡è§„åˆ™å¯ä»¥åšåˆ°åŠ¨æ€ç®¡ç†ã€‚ä¸šåŠ¡äººå‘˜å¯ä»¥åƒç®¡ç†æ•°æ®ä¸€æ ·å¯¹ä¸šåŠ¡è§„åˆ™è¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚æŸ¥è¯¢ã€æ·»åŠ ã€æ›´æ–°ã€ç»Ÿè®¡ã€æäº¤ä¸šåŠ¡è§„åˆ™ç­‰ã€‚è¿™æ ·å°±å¯ä»¥åšåˆ°åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹è°ƒæ•´ä¸šåŠ¡è§„åˆ™ã€‚</p><h3 id="3-3-å°ç»“"><a href="#3-3-å°ç»“" class="headerlink" title="3.3 å°ç»“"></a>3.3 å°ç»“</h3><h4 id="3-3-1-è§„åˆ™å¼•æ“æ„æˆ"><a href="#3-3-1-è§„åˆ™å¼•æ“æ„æˆ" class="headerlink" title="3.3.1 è§„åˆ™å¼•æ“æ„æˆ"></a>3.3.1 è§„åˆ™å¼•æ“æ„æˆ</h4><p>droolsè§„åˆ™å¼•æ“ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†æ„æˆï¼š</p><ul><li>Working Memoryï¼ˆå·¥ä½œå†…å­˜ï¼‰</li><li>Rule Baseï¼ˆè§„åˆ™åº“ï¼‰</li><li>Inference Engineï¼ˆæ¨ç†å¼•æ“ï¼‰</li></ul><p>å…¶ä¸­Inference Engineï¼ˆæ¨ç†å¼•æ“ï¼‰åˆåŒ…æ‹¬ï¼š</p><ul><li>Pattern Matcherï¼ˆåŒ¹é…å™¨ï¼‰     å…·ä½“åŒ¹é…å“ªä¸€ä¸ªè§„åˆ™ï¼Œç”±è¿™ä¸ªå®Œæˆ</li><li>Agenda(è®®ç¨‹)</li><li>Execution Engineï¼ˆæ‰§è¡Œå¼•æ“ï¼‰</li></ul><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/media/pictures/Drools.assets/8.png" alt="8"></p><h4 id="3-3-2-ç›¸å…³æ¦‚å¿µè¯´æ˜"><a href="#3-3-2-ç›¸å…³æ¦‚å¿µè¯´æ˜" class="headerlink" title="3.3.2 ç›¸å…³æ¦‚å¿µè¯´æ˜"></a>3.3.2 ç›¸å…³æ¦‚å¿µè¯´æ˜</h4><p><strong>Working Memory</strong>ï¼šå·¥ä½œå†…å­˜ï¼Œdroolsè§„åˆ™å¼•æ“ä¼šä»Working Memoryä¸­è·å–æ•°æ®å¹¶å’Œè§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„è§„åˆ™è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å‘çš„åº”ç”¨ç¨‹åºåªéœ€è¦å°†æˆ‘ä»¬çš„æ•°æ®æ’å…¥åˆ°Working Memoryä¸­å³å¯ï¼Œä¾‹å¦‚æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬è°ƒç”¨kieSession.insert(order)å°±æ˜¯å°†orderå¯¹è±¡æ’å…¥åˆ°äº†å·¥ä½œå†…å­˜ä¸­ã€‚</p><p><strong>Fact</strong>ï¼šäº‹å®ï¼Œæ˜¯æŒ‡åœ¨drools è§„åˆ™åº”ç”¨å½“ä¸­ï¼Œå°†ä¸€ä¸ª<strong>æ™®é€šçš„JavaBeanæ’å…¥åˆ°Working Memoryåçš„å¯¹è±¡</strong>å°±æ˜¯Factå¯¹è±¡ï¼Œä¾‹å¦‚æœ¬æ¡ˆä¾‹ä¸­çš„Orderå¯¹è±¡å°±å±äºFactå¯¹è±¡ã€‚Factå¯¹è±¡æ˜¯æˆ‘ä»¬çš„åº”ç”¨å’Œè§„åˆ™å¼•æ“è¿›è¡Œæ•°æ®äº¤äº’çš„æ¡¥æ¢æˆ–é€šé“ã€‚</p><p><strong>Rule Base</strong>ï¼šè§„åˆ™åº“ï¼Œæˆ‘ä»¬åœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„è§„åˆ™éƒ½ä¼šè¢«åŠ è½½åˆ°è§„åˆ™åº“ä¸­ã€‚</p><p><strong>Pattern Matcher</strong>ï¼šåŒ¹é…å™¨ï¼Œå°†Rule Baseä¸­çš„æ‰€æœ‰è§„åˆ™ä¸Working Memoryä¸­çš„Factå¯¹è±¡è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸçš„è§„åˆ™å°†è¢«æ¿€æ´»å¹¶æ”¾å…¥Agendaä¸­ã€‚</p><p><strong>Agenda</strong>ï¼šè®®ç¨‹ï¼Œç”¨äºå­˜æ”¾é€šè¿‡åŒ¹é…å™¨è¿›è¡Œæ¨¡å¼åŒ¹é…åè¢«æ¿€æ´»çš„è§„åˆ™ã€‚</p><p><strong>Execution Engine</strong>ï¼šæ‰§è¡Œå¼•æ“ï¼Œæ‰§è¡ŒAgendaä¸­è¢«æ¿€æ´»çš„è§„åˆ™ã€‚</p><h4 id="3-3-3-è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹"><a href="#3-3-3-è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="3.3.3 è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹"></a>3.3.3 è§„åˆ™å¼•æ“æ‰§è¡Œè¿‡ç¨‹</h4><p><img src="/media/pictures/Drools.assets/10.png" alt="10"></p><h4 id="3-3-4-KIEä»‹ç»"><a href="#3-3-4-KIEä»‹ç»" class="headerlink" title="3.3.4 KIEä»‹ç»"></a>3.3.4 KIEä»‹ç»</h4><p>æˆ‘ä»¬åœ¨æ“ä½œDroolsæ—¶ç»å¸¸ä½¿ç”¨çš„APIä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š</p><p><img src="/media/pictures/Drools.assets/9.png" alt="9"></p><p>é€šè¿‡ä¸Šé¢çš„æ ¸å¿ƒAPIå¯ä»¥å‘ç°ï¼Œå¤§éƒ¨åˆ†ç±»åéƒ½æ˜¯ä»¥Kieå¼€å¤´ã€‚<strong>Kieå…¨ç§°ä¸ºKnowledge Is Everything</strong>ï¼Œå³â€çŸ¥è¯†å°±æ˜¯ä¸€åˆ‡â€çš„ç¼©å†™ï¼Œæ˜¯Jbossä¸€ç³»åˆ—é¡¹ç›®çš„æ€»ç§°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒKieçš„ä¸»è¦æ¨¡å—æœ‰OptaPlannerã€Droolsã€UberFireã€jBPMã€‚</p><p><img src="/media/pictures/Drools.assets/11.png" alt="11"></p><p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒDroolsæ˜¯æ•´ä¸ªKIEé¡¹ç›®ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼ŒDroolsä¸­è¿˜åŒ…æ‹¬ä¸€ä¸ªDrools-WBçš„æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„è§„åˆ™ç¼–è¾‘å™¨ã€‚</p><h2 id="4-DroolsåŸºç¡€è¯­æ³•"><a href="#4-DroolsåŸºç¡€è¯­æ³•" class="headerlink" title="4. DroolsåŸºç¡€è¯­æ³•"></a>4. DroolsåŸºç¡€è¯­æ³•</h2><h3 id="4-1-è§„åˆ™æ–‡ä»¶æ„æˆ"><a href="#4-1-è§„åˆ™æ–‡ä»¶æ„æˆ" class="headerlink" title="4.1 è§„åˆ™æ–‡ä»¶æ„æˆ"></a>4.1 è§„åˆ™æ–‡ä»¶æ„æˆ</h3><p>åœ¨ä½¿ç”¨Droolsæ—¶éå¸¸é‡è¦çš„ä¸€ä¸ªå·¥ä½œå°±æ˜¯ç¼–å†™è§„åˆ™æ–‡ä»¶ï¼Œé€šå¸¸è§„åˆ™æ–‡ä»¶çš„åç¼€ä¸º.drlã€‚</p><p><strong>drlæ˜¯Drools Rule Languageçš„ç¼©å†™</strong>ã€‚åœ¨è§„åˆ™æ–‡ä»¶ä¸­ç¼–å†™å…·ä½“çš„è§„åˆ™å†…å®¹ã€‚</p><p>ä¸€å¥—å®Œæ•´çš„è§„åˆ™æ–‡ä»¶å†…å®¹æ„æˆå¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">package</td><td align="left">åŒ…åï¼Œåªé™äºé€»è¾‘ä¸Šçš„ç®¡ç†ï¼ŒåŒä¸€ä¸ªåŒ…åä¸‹çš„æŸ¥è¯¢æˆ–è€…å‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨</td></tr><tr><td align="left">import</td><td align="left">ç”¨äºå¯¼å…¥ç±»æˆ–è€…é™æ€æ–¹æ³•</td></tr><tr><td align="left">global</td><td align="left">å…¨å±€å˜é‡</td></tr><tr><td align="left">function</td><td align="left">è‡ªå®šä¹‰å‡½æ•°</td></tr><tr><td align="left">query</td><td align="left">æŸ¥è¯¢</td></tr><tr><td align="left">rule end</td><td align="left">è§„åˆ™ä½“</td></tr></tbody></table><p>Droolsæ”¯æŒçš„è§„åˆ™æ–‡ä»¶ï¼Œé™¤äº†drlå½¢å¼ï¼Œè¿˜æœ‰Excelæ–‡ä»¶ç±»å‹çš„ã€‚</p><h3 id="4-2-è§„åˆ™ä½“è¯­æ³•ç»“æ„"><a href="#4-2-è§„åˆ™ä½“è¯­æ³•ç»“æ„" class="headerlink" title="4.2 è§„åˆ™ä½“è¯­æ³•ç»“æ„"></a>4.2 è§„åˆ™ä½“è¯­æ³•ç»“æ„</h3><p>è§„åˆ™ä½“æ˜¯è§„åˆ™æ–‡ä»¶å†…å®¹ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯è¿›è¡Œä¸šåŠ¡è§„åˆ™åˆ¤æ–­ã€å¤„ç†ä¸šåŠ¡ç»“æœçš„éƒ¨åˆ†ã€‚</p><p>è§„åˆ™ä½“è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rule <span class="token string">"ruleName"</span>    attributes    when        LHS     then        RHSend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>rule</strong>ï¼šå…³é”®å­—ï¼Œè¡¨ç¤ºè§„åˆ™å¼€å§‹ï¼Œå‚æ•°ä¸ºè§„åˆ™çš„å”¯ä¸€åç§°ã€‚</p><p><strong>attributes</strong>ï¼šè§„åˆ™å±æ€§ï¼Œæ˜¯ruleä¸whenä¹‹é—´çš„å‚æ•°ï¼Œä¸ºå¯é€‰é¡¹ã€‚</p><p><strong>when</strong>ï¼šå…³é”®å­—ï¼Œåé¢è·Ÿè§„åˆ™çš„æ¡ä»¶éƒ¨åˆ†ã€‚</p><p><strong>LHS</strong>(Left Hand Side)ï¼šæ˜¯è§„åˆ™çš„æ¡ä»¶éƒ¨åˆ†çš„é€šç”¨åç§°ã€‚å®ƒç”±é›¶ä¸ªæˆ–å¤šä¸ªæ¡ä»¶å…ƒç´ ç»„æˆã€‚<strong>å¦‚æœLHSä¸ºç©ºï¼Œåˆ™å®ƒå°†è¢«è§†ä¸ºå§‹ç»ˆä¸ºtrueçš„æ¡ä»¶å…ƒç´ </strong>ã€‚  ï¼ˆå·¦æ‰‹è¾¹ï¼‰</p><p><strong>then</strong>ï¼šå…³é”®å­—ï¼Œåé¢è·Ÿè§„åˆ™çš„ç»“æœéƒ¨åˆ†ã€‚</p><p><strong>RHS</strong>(Right Hand Side)ï¼šæ˜¯è§„åˆ™çš„åæœæˆ–è¡ŒåŠ¨éƒ¨åˆ†çš„é€šç”¨åç§°ã€‚ ï¼ˆå³æ‰‹è¾¹ï¼‰</p><p><strong>end</strong>ï¼šå…³é”®å­—ï¼Œè¡¨ç¤ºä¸€ä¸ªè§„åˆ™ç»“æŸã€‚</p><h3 id="4-3-æ³¨é‡Š"><a href="#4-3-æ³¨é‡Š" class="headerlink" title="4.3 æ³¨é‡Š"></a>4.3 æ³¨é‡Š</h3><p>åœ¨drlå½¢å¼çš„è§„åˆ™æ–‡ä»¶ä¸­ä½¿ç”¨æ³¨é‡Šå’ŒJavaç±»ä¸­ä½¿ç”¨æ³¨é‡Šä¸€è‡´ï¼Œåˆ†ä¸ºå•è¡Œæ³¨é‡Šå’Œå¤šè¡Œæ³¨é‡Šã€‚</p><p>å•è¡Œæ³¨é‡Šç”¨â€&#x2F;&#x2F;â€œè¿›è¡Œæ ‡è®°ï¼Œå¤šè¡Œæ³¨é‡Šä»¥â€&#x2F;<em>â€œå¼€å§‹ï¼Œä»¥â€</em>&#x2F;â€œç»“æŸã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-drl" data-language="drl"><code class="language-drl">&#x2F;&#x2F;è§„åˆ™rule1çš„æ³¨é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Šrule &quot;rule1&quot;    when    then        System.out.println(&quot;rule1è§¦å‘&quot;);end&#x2F;*è§„åˆ™rule2çš„æ³¨é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šè¡Œæ³¨é‡Š*&#x2F;rule &quot;rule2&quot;    when    then        System.out.println(&quot;rule2è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-4-Patternæ¨¡å¼åŒ¹é…"><a href="#4-4-Patternæ¨¡å¼åŒ¹é…" class="headerlink" title="4.4 Patternæ¨¡å¼åŒ¹é…"></a>4.4 Patternæ¨¡å¼åŒ¹é…</h3><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†Droolsä¸­çš„åŒ¹é…å™¨å¯ä»¥å°†Rule Baseä¸­çš„æ‰€æœ‰è§„åˆ™ä¸Working Memoryä¸­çš„Factå¯¹è±¡è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åœ¨è§„åˆ™ä½“çš„LHSéƒ¨åˆ†å®šä¹‰è§„åˆ™å¹¶è¿›è¡Œæ¨¡å¼åŒ¹é…ã€‚LHSéƒ¨åˆ†ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¡ä»¶ç»„æˆï¼Œæ¡ä»¶åˆç§°ä¸ºpatternã€‚</p><p><strong>patternçš„è¯­æ³•ç»“æ„ä¸ºï¼šç»‘å®šå˜é‡å:Object(Fieldçº¦æŸ)</strong></p><p>å…¶ä¸­ç»‘å®šå˜é‡åå¯ä»¥çœç•¥ï¼Œé€šå¸¸ç»‘å®šå˜é‡åçš„å‘½åä¸€èˆ¬å»ºè®®ä»¥$å¼€å§‹ã€‚å¦‚æœå®šä¹‰äº†ç»‘å®šå˜é‡åï¼Œå°±å¯ä»¥åœ¨è§„åˆ™ä½“çš„RHSéƒ¨åˆ†ä½¿ç”¨æ­¤ç»‘å®šå˜é‡åæ¥æ“ä½œç›¸åº”çš„Factå¯¹è±¡ã€‚Fieldçº¦æŸéƒ¨åˆ†æ˜¯éœ€è¦è¿”å›trueæˆ–è€…falseçš„0ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬çš„å…¥é—¨æ¡ˆä¾‹ä¸­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ</span>rule <span class="token string">"book_discount_2"</span>    when        <span class="token comment">//Orderä¸ºç±»å‹çº¦æŸï¼ŒoriginalPriceä¸ºå±æ€§çº¦æŸ</span>        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>originalPrice <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> originalPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒåŒ¹é…çš„æ¡ä»¶ä¸ºï¼š</p><p>1ã€å·¥ä½œå†…å­˜ä¸­å¿…é¡»å­˜åœ¨Orderè¿™ç§ç±»å‹çš„Factå¯¹è±¡â€”â€“ç±»å‹çº¦æŸ</p><p>2ã€Factå¯¹è±¡çš„originalPriceå±æ€§å€¼å¿…é¡»å°äº200â€”â€”å±æ€§çº¦æŸ</p><p>3ã€Factå¯¹è±¡çš„originalPriceå±æ€§å€¼å¿…é¡»å¤§äºç­‰äº100â€”â€”å±æ€§çº¦æŸ</p><p>ä»¥ä¸Šæ¡ä»¶å¿…é¡»åŒæ—¶æ»¡è¶³å½“å‰è§„åˆ™æ‰æœ‰å¯èƒ½è¢«æ¿€æ´»ã€‚</p><p><strong>ç»‘å®šå˜é‡æ—¢å¯ä»¥ç”¨åœ¨å¯¹è±¡ä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨å¯¹è±¡çš„å±æ€§ä¸Š</strong>ã€‚ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­å¯ä»¥æ”¹ä¸ºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ</span>rule <span class="token string">"book_discount_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>$op<span class="token operator">:</span>originalPrice <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> originalPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"$op="</span> <span class="token operator">+</span> $op<span class="token punctuation">)</span><span class="token punctuation">;</span>        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>LHSéƒ¨åˆ†è¿˜å¯ä»¥å®šä¹‰å¤šä¸ªpatternï¼Œå¤šä¸ªpatternä¹‹é—´å¯ä»¥ä½¿ç”¨andæˆ–è€…orè¿›è¡Œè¿æ¥ï¼Œä¹Ÿå¯ä»¥ä¸å†™ï¼Œé»˜è®¤è¿æ¥ä¸ºandã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ</span>rule <span class="token string">"book_discount_2"</span>    when        $order<span class="token operator">:</span><span class="token class-name">Order</span><span class="token punctuation">(</span>$op<span class="token operator">:</span>originalPrice <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> originalPrice <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span> and        $customer<span class="token operator">:</span><span class="token class-name">Customer</span><span class="token punctuation">(</span>age <span class="token operator">></span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> gender<span class="token operator">==</span><span class="token char">'male'</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"$op="</span> <span class="token operator">+</span> $op<span class="token punctuation">)</span><span class="token punctuation">;</span>        $order<span class="token punctuation">.</span><span class="token function">setRealPrice</span><span class="token punctuation">(</span>$order<span class="token punctuation">.</span><span class="token function">getOriginalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸåŒ¹é…åˆ°è§„åˆ™äºŒï¼šæ‰€è´­å›¾ä¹¦æ€»ä»·åœ¨100åˆ°200å…ƒçš„ä¼˜æƒ 20å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-5-æ¯”è¾ƒæ“ä½œç¬¦"><a href="#4-5-æ¯”è¾ƒæ“ä½œç¬¦" class="headerlink" title="4.5 æ¯”è¾ƒæ“ä½œç¬¦"></a>4.5 æ¯”è¾ƒæ“ä½œç¬¦</h3><p>Droolsæä¾›çš„æ¯”è¾ƒæ“ä½œç¬¦ï¼Œå¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th align="left">ç¬¦å·</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">&gt;</td><td align="left">å¤§äº</td></tr><tr><td align="left">&lt;</td><td align="left">å°äº</td></tr><tr><td align="left">&gt;&#x3D;</td><td align="left">å¤§äºç­‰äº</td></tr><tr><td align="left">&lt;&#x3D;</td><td align="left">å°äºç­‰äº</td></tr><tr><td align="left">&#x3D;&#x3D;</td><td align="left">ç­‰äº</td></tr><tr><td align="left">!&#x3D;</td><td align="left">ä¸ç­‰äº</td></tr><tr><td align="left">contains</td><td align="left">æ£€æŸ¥ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼æ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡å€¼</td></tr><tr><td align="left">not contains</td><td align="left">æ£€æŸ¥ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼æ˜¯å¦ä¸åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡å€¼</td></tr><tr><td align="left">memberOf</td><td align="left">åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§æ˜¯å¦åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªé›†åˆä¸­</td></tr><tr><td align="left">not memberOf</td><td align="left">åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„æŸä¸ªå±æ€§æ˜¯å¦ä¸åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªé›†åˆä¸­</td></tr><tr><td align="left">matches</td><td align="left">åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸æä¾›çš„æ ‡å‡†çš„Javaæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…</td></tr><tr><td align="left">not matches</td><td align="left">åˆ¤æ–­ä¸€ä¸ªFactå¯¹è±¡çš„å±æ€§æ˜¯å¦ä¸ä¸æä¾›çš„æ ‡å‡†çš„Javaæ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…</td></tr></tbody></table><p>å‰6ä¸ªæ¯”è¾ƒæ“ä½œç¬¦å’ŒJavaä¸­çš„å®Œå…¨ç›¸åŒï¼Œä¸‹é¢æˆ‘ä»¬é‡ç‚¹å­¦ä¹ å6ä¸ªæ¯”è¾ƒæ“ä½œç¬¦ã€‚</p><h4 id="4-5-1-è¯­æ³•"><a href="#4-5-1-è¯­æ³•" class="headerlink" title="4.5.1 è¯­æ³•"></a>4.5.1 è¯­æ³•</h4><ul><li><p><strong>contains | not containsè¯­æ³•ç»“æ„</strong></p><p>Object(Field[Collection&#x2F;Array] contains value)</p><p>Object(Field[Collection&#x2F;Array] not contains value)</p></li><li><p><strong>memberOf | not memberOfè¯­æ³•ç»“æ„</strong></p><p>Object(field memberOf value[Collection&#x2F;Array])</p><p>Object(field not memberOf value[Collection&#x2F;Array])</p></li><li><p><strong>matches | not matchesè¯­æ³•ç»“æ„</strong></p><p>Object(field matches â€œæ­£åˆ™è¡¨è¾¾å¼â€)</p><p>Object(field not matches â€œæ­£åˆ™è¡¨è¾¾å¼â€)</p></li></ul><p>containæ˜¯å‰é¢åŒ…å«åé¢ï¼ŒmemberOfæ˜¯åé¢åŒ…å«å‰é¢ã€‚</p><h4 id="4-5-2-æ“ä½œæ­¥éª¤"><a href="#4-5-2-æ“ä½œæ­¥éª¤" class="headerlink" title="4.5.2 æ“ä½œæ­¥éª¤"></a>4.5.2 æ“ä½œæ­¥éª¤</h4><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå®ä½“ç±»ï¼Œç”¨äºæµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token comment">/** * å®ä½“ç±» * ç”¨äºæµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ComparisonOperatorEntity</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> names<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> names<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNames</span><span class="token punctuation">(</span><span class="token class-name">String</span> names<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>names <span class="token operator">=</span> names<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåœ¨&#x2F;resources&#x2F;rulesä¸‹åˆ›å»ºè§„åˆ™æ–‡ä»¶comparisonOperator.drl</p><pre class="line-numbers language-drl" data-language="drl"><code class="language-drl">package comparisonOperatorimport com.itheima.drools.entity.ComparisonOperatorEntity&#x2F;* å½“å‰è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•Droolsæä¾›çš„æ¯”è¾ƒæ“ä½œç¬¦*&#x2F;&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦containsrule &quot;rule_comparison_contains&quot;    when        ComparisonOperatorEntity(names contains &quot;å¼ ä¸‰&quot;)        ComparisonOperatorEntity(list contains names)    then        System.out.println(&quot;è§„åˆ™rule_comparison_containsè§¦å‘&quot;);end&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦not containsrule &quot;rule_comparison_notContains&quot;    when        ComparisonOperatorEntity(names not contains &quot;å¼ ä¸‰&quot;)        ComparisonOperatorEntity(list not contains names)    then        System.out.println(&quot;è§„åˆ™rule_comparison_notContainsè§¦å‘&quot;);end&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦memberOfrule &quot;rule_comparison_memberOf&quot;    when        ComparisonOperatorEntity(names memberOf list)    then        System.out.println(&quot;è§„åˆ™rule_comparison_memberOfè§¦å‘&quot;);end&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦not memberOfrule &quot;rule_comparison_notMemberOf&quot;    when        ComparisonOperatorEntity(names not memberOf list)    then        System.out.println(&quot;è§„åˆ™rule_comparison_notMemberOfè§¦å‘&quot;);end&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦matchesrule &quot;rule_comparison_matches&quot;    when        ComparisonOperatorEntity(names matches &quot;å¼ .*&quot;)    then        System.out.println(&quot;è§„åˆ™rule_comparison_matchesè§¦å‘&quot;);end&#x2F;&#x2F;æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦not matchesrule &quot;rule_comparison_notMatches&quot;    when        ComparisonOperatorEntity(names not matches &quot;å¼ .*&quot;)    then        System.out.println(&quot;è§„åˆ™rule_comparison_notMatchesè§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//æµ‹è¯•æ¯”è¾ƒæ“ä½œç¬¦</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ComparisonOperatorEntity</span> comparisonOperatorEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComparisonOperatorEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    comparisonOperatorEntity<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"æå››"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    comparisonOperatorEntity<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™</span>    kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>comparisonOperatorEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>    kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-6-æ‰§è¡ŒæŒ‡å®šè§„åˆ™"><a href="#4-6-æ‰§è¡ŒæŒ‡å®šè§„åˆ™" class="headerlink" title="4.6 æ‰§è¡ŒæŒ‡å®šè§„åˆ™"></a>4.6 æ‰§è¡ŒæŒ‡å®šè§„åˆ™</h3><p>é€šè¿‡å‰é¢çš„æ¡ˆä¾‹å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨è§„åˆ™ä»£ç æ—¶ï¼Œæ»¡è¶³æ¡ä»¶çš„è§„åˆ™éƒ½ä¼šè¢«æ‰§è¡Œã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬åªæƒ³æ‰§è¡Œå…¶ä¸­çš„æŸä¸ªè§„åˆ™å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>Droolsç»™æˆ‘ä»¬æä¾›çš„æ–¹å¼æ˜¯é€šè¿‡è§„åˆ™è¿‡æ»¤å™¨æ¥å®ç°æ‰§è¡ŒæŒ‡å®šè§„åˆ™ã€‚å¯¹äºè§„åˆ™æ–‡ä»¶ä¸ç”¨åšä»»ä½•ä¿®æ”¹ï¼Œåªéœ€è¦ä¿®æ”¹Javaä»£ç å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ComparisonOperatorEntity</span> comparisonOperatorEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComparisonOperatorEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>comparisonOperatorEntity<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"æå››"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>comparisonOperatorEntity<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>comparisonOperatorEntity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€šè¿‡è§„åˆ™è¿‡æ»¤å™¨å®ç°åªæ‰§è¡ŒæŒ‡å®šè§„åˆ™</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RuleNameEqualsAgendaFilter</span><span class="token punctuation">(</span><span class="token string">"rule_comparison_memberOf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-7-å…³é”®å­—"><a href="#4-7-å…³é”®å­—" class="headerlink" title="4.7 å…³é”®å­—"></a>4.7 å…³é”®å­—</h3><p>Droolsçš„å…³é”®å­—åˆ†ä¸ºï¼šç¡¬å…³é”®å­—(Hard keywords)å’Œè½¯å…³é”®å­—(Soft keywords)ã€‚</p><p><strong>ç¡¬å…³é”®å­—æ˜¯æˆ‘ä»¬åœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰åŒ…åæˆ–è€…è§„åˆ™åæ—¶æ˜ç¡®ä¸èƒ½ä½¿ç”¨çš„ï¼Œå¦åˆ™ç¨‹åºä¼šæŠ¥é”™</strong>ã€‚è½¯å…³é”®å­—è™½ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ä¸å»ºè®®ä½¿ç”¨ã€‚</p><p>ç¡¬å…³é”®å­—åŒ…æ‹¬ï¼štrue false null</p><p>è½¯å…³é”®å­—åŒ…æ‹¬ï¼šlock-on-active date-effective date-expires no-loop auto-focus activation-group agenda-group ruleflow-group entry-point duration package import dialect salience enabled attributes rule extend when then template query declare function global eval not in or and exists forall accumulate collect from action reverse result end over init</p><pre class="line-numbers language-javaã€ã€" data-language="javaã€ã€"><code class="language-javaã€ã€">æ¯”å¦‚ï¼šrule true  &#x2F;&#x2F;ä¸å¯ä»¥rule &quot;true&quot;  &#x2F;&#x2F;å¯ä»¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="4-8-Droolså†…ç½®æ–¹æ³•"><a href="#4-8-Droolså†…ç½®æ–¹æ³•" class="headerlink" title="4.8 Droolså†…ç½®æ–¹æ³•"></a>4.8 Droolså†…ç½®æ–¹æ³•</h3><p>è§„åˆ™æ–‡ä»¶çš„<code>RHS</code>éƒ¨åˆ†çš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡<strong>æ’å…¥ï¼Œåˆ é™¤æˆ–ä¿®æ”¹å·¥ä½œå†…å­˜ä¸­çš„Factæ•°æ®</strong>ï¼Œæ¥è¾¾åˆ°æ§åˆ¶è§„åˆ™å¼•æ“æ‰§è¡Œçš„ç›®çš„ã€‚Droolsæä¾›äº†ä¸€äº›æ–¹æ³•å¯ä»¥ç”¨æ¥æ“ä½œå·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œ<strong>æ“ä½œå®Œæˆåè§„åˆ™å¼•æ“ä¼šé‡æ–°è¿›è¡Œç›¸å…³è§„åˆ™çš„åŒ¹é…ï¼Œ</strong>åŸæ¥æ²¡æœ‰åŒ¹é…æˆåŠŸçš„è§„åˆ™åœ¨æˆ‘ä»¬ä¿®æ”¹æ•°æ®å®Œæˆåæœ‰å¯èƒ½å°±ä¼šåŒ¹é…æˆåŠŸäº†ã€‚</p><p>åˆ›å»ºå¦‚ä¸‹å®ä½“ç±»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token comment">/** * å­¦ç”Ÿ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> id<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-8-1-updateæ–¹æ³•"><a href="#4-8-1-updateæ–¹æ³•" class="headerlink" title="4.8.1 updateæ–¹æ³•"></a>4.8.1 updateæ–¹æ³•</h4><p><strong>updateæ–¹æ³•çš„ä½œç”¨æ˜¯æ›´æ–°å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</strong>   ï¼ˆè¦é¿å…æ­»å¾ªç¯ï¼‰</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;student.drlï¼Œæ–‡ä»¶å†…å®¹å¦‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">student</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token comment">/* å½“å‰è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•Droolsæä¾›çš„å†…ç½®æ–¹æ³•*/</span>rule <span class="token string">"rule_student_ageå°äº10å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>    then        $s<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ›´æ–°æ•°æ®ï¼Œå¯¼è‡´ç›¸å…³çš„è§„åˆ™ä¼šé‡æ–°åŒ¹é…</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå°äº10å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageå°äº20å²åŒæ—¶å¤§äº10å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> age <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span>    then        $s<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ›´æ–°æ•°æ®ï¼Œå¯¼è‡´ç›¸å…³çš„è§„åˆ™ä¼šé‡æ–°åŒ¹é…</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå°äº20å²åŒæ—¶å¤§äº10å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageå¤§äº20å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">></span> <span class="token number">20</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå¤§äº20å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-none"><code class="language-none">KieServices kieServices &#x3D; KieServices.Factory.get();KieContainer kieClasspathContainer &#x3D; kieServices.getKieClasspathContainer();KieSession kieSession &#x3D; kieClasspathContainer.newKieSession();Student student &#x3D; new Student();student.setAge(5);&#x2F;&#x2F;å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™kieSession.insert(student);kieSession.fireAllRules();kieSession.dispose();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸‰ä¸ªè§„åˆ™éƒ½è§¦å‘äº†ã€‚</p><p>åœ¨æ›´æ–°æ•°æ®æ—¶éœ€è¦æ³¨æ„é˜²æ­¢å‘ç”Ÿæ­»å¾ªç¯ã€‚</p><h4 id="4-8-2-insertæ–¹æ³•"><a href="#4-8-2-insertæ–¹æ³•" class="headerlink" title="4.8.2 insertæ–¹æ³•"></a>4.8.2 insertæ–¹æ³•</h4><p>insertæ–¹æ³•çš„ä½œç”¨æ˜¯å‘å·¥ä½œå†…å­˜ä¸­æ’å…¥æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹student.drlæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">package studentimport com.itheima.drools.entity.Student&#x2F;* å½“å‰è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•Droolsæä¾›çš„å†…ç½®æ–¹æ³•*&#x2F;rule &quot;rule_insert_student_ageç­‰äº10å²&quot;    when        $s:Student(age &#x3D;&#x3D; 10)    then        &#x2F;&#x2F;æ–°ç”Ÿæˆå¯¹è±¡ï¼Œç›¸å½“äºageæ˜¯0        Student student &#x3D; new Student();        student.setName(&quot;xcc&quot;);        insert(student);&#x2F;&#x2F;æ’å…¥æ•°æ®ï¼Œå¯¼è‡´ç›¸å…³çš„è§„åˆ™ä¼šé‡æ–°åŒ¹é…        &#x2F;&#x2F;ç›´æ¥ç”¨updateä¼šå¯¼è‡´æ­»å¾ªç¯ï¼Œå› ä¸ºä¸€ç›´ç­‰äº10&#x2F;&#x2F;        $s.setName(&quot;xcc&quot;);&#x2F;&#x2F;        update($s);        System.out.println(&quot;è§„åˆ™rule_insert_student_ageç­‰äº10å²è§¦å‘&quot;);endrule &quot;rule_insert_student_ageå°äº10å²&quot;    when        $s:Student(age&gt;0 &amp;&amp; age &lt; 10)    then        $s.setAge(15);        update($s);        System.out.println(&quot;è§„åˆ™rule_insert_student_ageå°äº10å²è§¦å‘&quot;);endrule &quot;rule_insert_student_ageå°äº20å²åŒæ—¶å¤§äº10å²&quot;    when        $s:Student(age &lt; 20 &amp;&amp; age &gt; 10)    then        $s.setAge(25);        update($s);        System.out.println(&quot;è§„åˆ™rule_insert_student_ageå°äº20å²åŒæ—¶å¤§äº10å²è§¦å‘&quot;);endrule &quot;rule_insert_student_ageå¤§äº20å²&quot;    when        $s:Student(age &gt; 20)    then        System.out.println(&quot;è§„åˆ™rule_insert_student_ageå¤§äº20å²è§¦å‘&quot;);endrule &quot;rule_insert_student_nameæ·»åŠ åå­—&quot;    when        $s:Student(name &#x3D;&#x3D; &quot;xcc&quot;)    then        System.out.println(&quot;æ·»åŠ äº†åå­—&quot;+$s.getName());end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>student<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™</span>kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°è¾“å‡ºå¯ä»¥å‘ç°ï¼Œå››ä¸ªè§„åˆ™éƒ½è§¦å‘äº†ï¼Œè¿™æ˜¯å› ä¸ºé¦–å…ˆè¿›è¡Œè§„åˆ™åŒ¹é…æ—¶åªæœ‰ç¬¬ä¸€ä¸ªè§„åˆ™å¯ä»¥åŒ¹é…æˆåŠŸï¼Œä½†æ˜¯åœ¨ç¬¬ä¸€ä¸ªè§„åˆ™ä¸­å‘å·¥ä½œå†…å­˜ä¸­æ’å…¥äº†ä¸€ä¸ªæ•°æ®å¯¼è‡´é‡æ–°è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªè§„åˆ™å¯ä»¥åŒ¹é…æˆåŠŸã€‚åœ¨ç¬¬äºŒä¸ªè§„åˆ™ä¸­è¿›è¡Œäº†æ•°æ®ä¿®æ”¹å¯¼è‡´ç¬¬ä¸‰ä¸ªè§„åˆ™ä¹Ÿå¯ä»¥åŒ¹é…æˆåŠŸï¼Œä»¥æ­¤ç±»æ¨æœ€ç»ˆå››ä¸ªè§„åˆ™éƒ½åŒ¹é…æˆåŠŸå¹¶æ‰§è¡Œäº†ã€‚</p><h4 id="4-8-3-retractæ–¹æ³•"><a href="#4-8-3-retractæ–¹æ³•" class="headerlink" title="4.8.3 retractæ–¹æ³•"></a>4.8.3 retractæ–¹æ³•</h4><p><strong>retractæ–¹æ³•çš„ä½œç”¨æ˜¯åˆ é™¤å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</strong></p><p>ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹student.drlæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">student</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token comment">/* å½“å‰è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•Droolsæä¾›çš„å†…ç½®æ–¹æ³•*/</span>rule <span class="token string">"rule_student_ageç­‰äº10å²æ—¶åˆ é™¤æ•°æ®"</span>    <span class="token comment">/*    salienceï¼šè®¾ç½®å½“å‰è§„åˆ™çš„æ‰§è¡Œä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ‰§è¡Œï¼Œé»˜è®¤å€¼ä¸º0.    å› ä¸ºå½“å‰è§„åˆ™çš„åŒ¹é…æ¡ä»¶å’Œä¸‹é¢è§„åˆ™çš„åŒ¹é…æ¡ä»¶ç›¸åŒï¼Œä¸ºäº†ä¿è¯å…ˆæ‰§è¡Œå½“å‰è§„åˆ™ï¼Œéœ€è¦è®¾ç½®ä¼˜å…ˆçº§    */</span>    salience <span class="token number">100</span>     when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span>    then        <span class="token function">retract</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//retractæ–¹æ³•çš„ä½œç”¨æ˜¯åˆ é™¤å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¹¶è®©ç›¸å…³çš„è§„åˆ™é‡æ–°åŒ¹é…ã€‚</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageç­‰äº10å²æ—¶åˆ é™¤æ•°æ®è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageç­‰äº10å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span>    then        <span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        student<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">insert</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageç­‰äº10å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageå°äº10å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>    then        $s<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå°äº10å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageå°äº20å²åŒæ—¶å¤§äº10å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> age <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span>    then        $s<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå°äº20å²åŒæ—¶å¤§äº10å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_student_ageå¤§äº20å²"</span>    when        $s<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>age <span class="token operator">></span> <span class="token number">20</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_student_ageå¤§äº20å²è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>student<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™</span>kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°è¾“å‡ºå¯ä»¥å‘ç°ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªè§„åˆ™è§¦å‘äº†ï¼Œå› ä¸ºåœ¨ç¬¬ä¸€ä¸ªè§„åˆ™ä¸­å°†å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®åˆ é™¤äº†å¯¼è‡´ç¬¬äºŒä¸ªè§„åˆ™å¹¶æ²¡æœ‰åŒ¹é…æˆåŠŸã€‚</p><h2 id="5-è§„åˆ™å±æ€§-attributes"><a href="#5-è§„åˆ™å±æ€§-attributes" class="headerlink" title="5. è§„åˆ™å±æ€§  attributes"></a>5. è§„åˆ™å±æ€§  attributes</h2><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†è§„åˆ™ä½“çš„æ„æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rule <span class="token string">"ruleName"</span>    attributes    when        LHS    then        RHSend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬ç« èŠ‚å°±æ˜¯é’ˆå¯¹è§„åˆ™ä½“çš„<strong>attributes</strong>å±æ€§éƒ¨åˆ†è¿›è¡Œè®²è§£ã€‚Droolsä¸­æä¾›çš„å±æ€§å¦‚ä¸‹è¡¨(éƒ¨åˆ†å±æ€§)ï¼š</p><table><thead><tr><th align="left">å±æ€§å</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">salience</td><td align="left">æŒ‡å®šè§„åˆ™æ‰§è¡Œä¼˜å…ˆçº§</td></tr><tr><td align="left">dialect</td><td align="left">æŒ‡å®šè§„åˆ™ä½¿ç”¨çš„è¯­è¨€ç±»å‹ï¼Œå–å€¼ä¸ºjavaå’Œmvel</td></tr><tr><td align="left">enabled</td><td align="left">æŒ‡å®šè§„åˆ™æ˜¯å¦å¯ç”¨</td></tr><tr><td align="left">date-effective</td><td align="left">æŒ‡å®šè§„åˆ™ç”Ÿæ•ˆæ—¶é—´</td></tr><tr><td align="left">date-expires</td><td align="left">æŒ‡å®šè§„åˆ™å¤±æ•ˆæ—¶é—´</td></tr><tr><td align="left">activation-group</td><td align="left">æ¿€æ´»åˆ†ç»„ï¼Œå…·æœ‰ç›¸åŒåˆ†ç»„åç§°çš„è§„åˆ™åªèƒ½æœ‰ä¸€ä¸ªè§„åˆ™è§¦å‘</td></tr><tr><td align="left">agenda-group</td><td align="left">è®®ç¨‹åˆ†ç»„ï¼Œåªæœ‰è·å–ç„¦ç‚¹çš„ç»„ä¸­çš„è§„åˆ™æ‰æœ‰å¯èƒ½è§¦å‘</td></tr><tr><td align="left">timer</td><td align="left">å®šæ—¶å™¨ï¼ŒæŒ‡å®šè§„åˆ™è§¦å‘çš„æ—¶é—´</td></tr><tr><td align="left">auto-focus</td><td align="left">è‡ªåŠ¨è·å–ç„¦ç‚¹ï¼Œä¸€èˆ¬ç»“åˆagenda-groupä¸€èµ·ä½¿ç”¨</td></tr><tr><td align="left">no-loop</td><td align="left">é˜²æ­¢æ­»å¾ªç¯</td></tr></tbody></table><h3 id="5-1-enabledå±æ€§"><a href="#5-1-enabledå±æ€§" class="headerlink" title="5.1 enabledå±æ€§"></a>5.1 enabledå±æ€§</h3><p>enabledå±æ€§å¯¹åº”çš„å–å€¼ä¸ºtrueå’Œfalseï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚</p><p>ç”¨äºæŒ‡å®šå½“å‰è§„åˆ™æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœè®¾ç½®çš„å€¼ä¸ºfalseåˆ™å½“å‰è§„åˆ™æ— è®ºæ˜¯å¦åŒ¹é…æˆåŠŸéƒ½ä¸ä¼šè§¦å‘</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">rule <span class="token string">"rule_comparison_notMemberOf"</span>    <span class="token comment">//æŒ‡å®šå½“å‰è§„åˆ™ä¸å¯ç”¨ï¼Œå½“å‰è§„åˆ™æ— è®ºæ˜¯å¦åŒ¹é…æˆåŠŸéƒ½ä¸ä¼šæ‰§è¡Œ</span>    enabled <span class="token boolean">false</span>    when        <span class="token class-name">ComparisonOperatorEntity</span><span class="token punctuation">(</span>names not memberOf list<span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_comparison_notMemberOfè§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-2-dialectå±æ€§"><a href="#5-2-dialectå±æ€§" class="headerlink" title="5.2 dialectå±æ€§"></a>5.2 dialectå±æ€§</h3><p>dialectå±æ€§ç”¨äºæŒ‡å®šå½“å‰è§„åˆ™ä½¿ç”¨çš„è¯­è¨€ç±»å‹ï¼Œå–å€¼ä¸ºjavaå’Œmvelï¼Œé»˜è®¤å€¼ä¸ºjavaã€‚</p><p>æ³¨ï¼šmvelæ˜¯ä¸€ç§åŸºäºjavaè¯­æ³•çš„è¡¨è¾¾å¼è¯­è¨€ã€‚</p><p>mvelåƒæ­£åˆ™è¡¨è¾¾å¼ä¸€æ ·ï¼Œæœ‰ç›´æ¥æ”¯æŒé›†åˆã€æ•°ç»„å’Œå­—ç¬¦ä¸²åŒ¹é…çš„æ“ä½œç¬¦ã€‚</p><p>mvelè¿˜æä¾›äº†ç”¨æ¥é…ç½®å’Œæ„é€ å­—ç¬¦ä¸²çš„æ¨¡æ¿è¯­è¨€ã€‚</p><p>mvelè¡¨è¾¾å¼å†…å®¹åŒ…æ‹¬å±æ€§è¡¨è¾¾å¼ï¼Œå¸ƒå°”è¡¨è¾¾å¼ï¼Œæ–¹æ³•è°ƒç”¨ï¼Œå˜é‡èµ‹å€¼ï¼Œå‡½æ•°å®šä¹‰ç­‰ã€‚</p><h3 id="5-3-salienceå±æ€§"><a href="#5-3-salienceå±æ€§" class="headerlink" title="5.3 salienceå±æ€§"></a>5.3 salienceå±æ€§</h3><p>salienceå±æ€§ç”¨äºæŒ‡å®šè§„åˆ™çš„æ‰§è¡Œä¼˜å…ˆçº§ï¼Œ<strong>å–å€¼ç±»å‹ä¸ºInteger</strong>ã€‚<strong>æ•°å€¼è¶Šå¤§è¶Šä¼˜å…ˆæ‰§è¡Œ</strong>ã€‚æ¯ä¸ªè§„åˆ™éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„æ‰§è¡Œé¡ºåºï¼Œå¦‚æœä¸è®¾ç½®salienceå±æ€§ï¼Œè§„åˆ™ä½“çš„æ‰§è¡Œé¡ºåºä¸ºç”±ä¸Šåˆ°ä¸‹ã€‚</p><p>å¯ä»¥é€šè¿‡åˆ›å»ºè§„åˆ™æ–‡ä»¶salience.drlæ¥æµ‹è¯•salienceå±æ€§ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">package test.saliencerule &quot;rule_1&quot;    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_1è§¦å‘&quot;);end    rule &quot;rule_2&quot;    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_2è§¦å‘&quot;);endrule &quot;rule_3&quot;    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_3è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œç”±äºä»¥ä¸Šä¸‰ä¸ªè§„åˆ™æ²¡æœ‰è®¾ç½®salienceå±æ€§ï¼Œæ‰€ä»¥æ‰§è¡Œçš„é¡ºåºæ˜¯æŒ‰ç…§è§„åˆ™æ–‡ä»¶ä¸­è§„åˆ™çš„é¡ºåºç”±ä¸Šåˆ°ä¸‹æ‰§è¡Œçš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">package testsaliencerule &quot;rule_1&quot;    salience 9    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_1è§¦å‘&quot;);endrule &quot;rule_2&quot;    salience 10    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_2è§¦å‘&quot;);endrule &quot;rule_3&quot;    salience 8    when        eval(true)    then        System.out.println(&quot;è§„åˆ™rule_3è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œè§„åˆ™æ–‡ä»¶æ‰§è¡Œçš„é¡ºåºæ˜¯æŒ‰ç…§æˆ‘ä»¬è®¾ç½®çš„salienceå€¼ç”±å¤§åˆ°å°é¡ºåºæ‰§è¡Œçš„ã€‚</p><p>å»ºè®®åœ¨ç¼–å†™è§„åˆ™æ—¶ä½¿ç”¨salienceå±æ€§æ˜ç¡®æŒ‡å®šæ‰§è¡Œä¼˜å…ˆçº§ã€‚</p><h3 id="5-4-no-loopå±æ€§"><a href="#5-4-no-loopå±æ€§" class="headerlink" title="5.4 no-loopå±æ€§"></a>5.4 no-loopå±æ€§</h3><p>no-loopå±æ€§ç”¨äºé˜²æ­¢æ­»å¾ªç¯ï¼Œå½“è§„åˆ™é€šè¿‡updateä¹‹ç±»çš„å‡½æ•°ä¿®æ”¹äº†Factå¯¹è±¡æ—¶ï¼Œå¯èƒ½ä½¿å½“å‰è§„åˆ™å†æ¬¡è¢«æ¿€æ´»ä»è€Œå¯¼è‡´æ­»å¾ªç¯ã€‚å–å€¼ç±»å‹ä¸ºBooleanï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚æµ‹è¯•æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resource&#x2F;rules&#x2F;noloop.drl</p><pre class="line-numbers language-none"><code class="language-none">package testnoloopimport com.itheima.drools.entity.Student&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•no-loopå±æ€§*&#x2F;rule &quot;rule_noloop&quot;    when        &#x2F;&#x2F; no-loop true        $student:Student(age &#x3D;&#x3D; 25)    then        update($student);&#x2F;&#x2F;æ³¨æ„æ­¤å¤„æ‰§è¡Œupdateä¼šå¯¼è‡´å½“å‰è§„åˆ™é‡æ–°è¢«æ¿€æ´»        System.out.println(&quot;è§„åˆ™rule_noloopè§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-none"><code class="language-none">KieServices kieServices &#x3D; KieServices.Factory.get();KieContainer kieClasspathContainer &#x3D; kieServices.getKieClasspathContainer();KieSession kieSession &#x3D; kieClasspathContainer.newKieSession();Student student &#x3D; new Student();student.setAge(25);&#x2F;&#x2F;å°†æ•°æ®æä¾›ç»™è§„åˆ™å¼•æ“ï¼Œè§„åˆ™å¼•æ“ä¼šæ ¹æ®æä¾›çš„æ•°æ®è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¦‚æœè§„åˆ™åŒ¹é…æˆåŠŸåˆ™æ‰§è¡Œè§„åˆ™kieSession.insert(student);kieSession.fireAllRules();kieSession.dispose();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®no-loopå±æ€§çš„å€¼ï¼Œæ‰€ä»¥å‘ç”Ÿäº†æ­»å¾ªç¯ã€‚æ¥ä¸‹æ¥è®¾ç½®no-loopçš„å€¼ä¸ºtrueå†æ¬¡æµ‹è¯•åˆ™ä¸ä¼šå‘ç”Ÿæ­»å¾ªç¯ã€‚</p><h3 id="5-5-activation-groupå±æ€§"><a href="#5-5-activation-groupå±æ€§" class="headerlink" title="5.5 activation-groupå±æ€§"></a>5.5 activation-groupå±æ€§</h3><p>activation-groupå±æ€§æ˜¯æŒ‡<strong>æ¿€æ´»åˆ†ç»„</strong>ï¼Œå–å€¼ä¸ºStringç±»å‹ã€‚å…·æœ‰ç›¸åŒåˆ†ç»„åç§°çš„è§„åˆ™<strong>åªèƒ½æœ‰ä¸€ä¸ªè§„åˆ™</strong>è¢«è§¦å‘ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;activationgroup.drl</p><pre class="line-numbers language-none"><code class="language-none">package testactivationgroup&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•activation-groupå±æ€§*&#x2F;    rule &quot;rule_activationgroup_1&quot;    activation-group &quot;mygroup&quot;    when    then        System.out.println(&quot;è§„åˆ™rule_activationgroup_1è§¦å‘&quot;);endrule &quot;rule_activationgroup_2&quot;    activation-group &quot;mygroup&quot;    when    then        System.out.println(&quot;è§„åˆ™rule_activationgroup_2è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-none"><code class="language-none">KieServices kieServices &#x3D; KieServices.Factory.get();KieContainer kieClasspathContainer &#x3D; kieServices.getKieClasspathContainer();KieSession kieSession &#x3D; kieClasspathContainer.newKieSession();kieSession.fireAllRules();kieSession.dispose();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥å‘ç°ï¼Œä¸Šé¢çš„ä¸¤ä¸ªè§„åˆ™å› ä¸ºå±äºåŒä¸€ä¸ªåˆ†ç»„ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªè§¦å‘äº†ã€‚åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å¤šä¸ªè§„åˆ™å¦‚æœéƒ½èƒ½å¤ŸåŒ¹é…æˆåŠŸï¼Œå…·ä½“å“ªä¸€ä¸ªæœ€ç»ˆèƒ½å¤Ÿè¢«è§¦å‘å¯ä»¥é€šè¿‡salienceå±æ€§ç¡®å®šã€‚</p><h3 id="5-6-agenda-groupå±æ€§"><a href="#5-6-agenda-groupå±æ€§" class="headerlink" title="5.6 agenda-groupå±æ€§"></a>5.6 agenda-groupå±æ€§</h3><p>agenda-groupå±æ€§ä¸º<strong>è®®ç¨‹åˆ†ç»„</strong>ï¼Œå±äºå¦ä¸€ç§å¯æ§çš„è§„åˆ™æ‰§è¡Œæ–¹å¼ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è®¾ç½®agenda-groupæ¥æ§åˆ¶è§„åˆ™çš„æ‰§è¡Œï¼Œ<strong>åªæœ‰è·å–ç„¦ç‚¹çš„ç»„</strong>ä¸­çš„è§„åˆ™æ‰ä¼šè¢«è§¦å‘ã€‚agenda-groupæœ‰ä¸€ä¸ªé»˜è®¤å€¼MAINï¼Œé€šè¿‡drools.getRule()æ‰“å°å¯ä»¥çœ‹å‡ºæ¥</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºè§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;agendagroup.drl</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testagendagroup</span><span class="token comment">/*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•agenda-groupå±æ€§*/</span>rule <span class="token string">"rule_agendagroup_1"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_agendagroup_2"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//========================================================</span>rule <span class="token string">"rule_agendagroup_3"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_2"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_3è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_agendagroup_4"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_2"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_4è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®ç„¦ç‚¹ï¼Œå¯¹åº”agenda-groupåˆ†ç»„ä¸­çš„è§„åˆ™æ‰å¯èƒ½è¢«è§¦å‘</span><span class="token comment">//æ³¨æ„ï¼šæ˜¯åªå¯¹æœ‰agenda-groupå±æ€§çš„æœ‰æ•ˆï¼Œå¦‚æœæ²¡æœ‰agenda-groupï¼Œè§„åˆ™åŒ¹é…äº†çš„ä¹Ÿä¼šè§¦å‘ï¼Œæ¯”å¦‚æ²¡æœ‰LHSçš„</span>kieSession<span class="token punctuation">.</span><span class="token function">getAgenda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAgendaGroup</span><span class="token punctuation">(</span><span class="token string">"myagendagroup_1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰è·å–ç„¦ç‚¹çš„åˆ†ç»„ä¸­çš„è§„åˆ™æ‰ä¼šè§¦å‘ã€‚<strong>ä¸activation-groupä¸åŒçš„æ˜¯ï¼Œactivation-groupå®šä¹‰çš„åˆ†ç»„ä¸­åªèƒ½å¤Ÿæœ‰ä¸€ä¸ªè§„åˆ™å¯ä»¥è¢«è§¦å‘ï¼Œè€Œagenda-groupåˆ†ç»„ä¸­çš„å¤šä¸ªè§„åˆ™éƒ½å¯ä»¥è¢«è§¦å‘</strong>ã€‚</p><h3 id="5-7-auto-focuså±æ€§"><a href="#5-7-auto-focuså±æ€§" class="headerlink" title="5.7 auto-focuså±æ€§"></a>5.7 auto-focuså±æ€§</h3><p>auto-focuså±æ€§ä¸º<strong>è‡ªåŠ¨è·å–ç„¦ç‚¹</strong>ï¼Œå–å€¼ç±»å‹ä¸ºBooleanï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚ä¸€èˆ¬ç»“åˆagenda-groupå±æ€§ä½¿ç”¨ï¼Œå½“ä¸€ä¸ªè®®ç¨‹åˆ†ç»„æœªè·å–ç„¦ç‚¹æ—¶ï¼Œå¯ä»¥è®¾ç½®auto-focuså±æ€§æ¥æ§åˆ¶ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹&#x2F;resources&#x2F;rules&#x2F;agendagroup.drlæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testagendagroup</span>rule <span class="token string">"rule_agendagroup_1"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_agendagroup_2"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span class="token comment">//========================================================</span>rule <span class="token string">"rule_agendagroup_3"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_2"</span>    auto<span class="token operator">-</span>focus <span class="token boolean">true</span> <span class="token comment">//è‡ªåŠ¨è·å–ç„¦ç‚¹</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_3è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"rule_agendagroup_4"</span>    agenda<span class="token operator">-</span>group <span class="token string">"myagendagroup_2"</span>    auto<span class="token operator">-</span>focus <span class="token boolean">true</span> <span class="token comment">//è‡ªåŠ¨è·å–ç„¦ç‚¹</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™rule_agendagroup_4è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œè®¾ç½®auto-focuså±æ€§ä¸ºtrueçš„è§„åˆ™éƒ½è§¦å‘äº†ã€‚</p><p>æ³¨æ„ï¼šåŒä¸€ä¸ªç»„ï¼Œåªè¦æœ‰ä¸ªè®¾ç½®auto-focus true å…¶ä»–çš„è®¾ç½®ä¸è®¾ç½®éƒ½æ— æ‰€è°“å•¦ã€‚éƒ½ä¼šèµ·ä½œç”¨çš„ã€‚</p><h3 id="5-8-timerå±æ€§"><a href="#5-8-timerå±æ€§" class="headerlink" title="5.8 timerå±æ€§"></a>5.8 timerå±æ€§</h3><p>timerå±æ€§å¯ä»¥é€šè¿‡å®šæ—¶å™¨çš„æ–¹å¼æŒ‡å®šè§„åˆ™æ‰§è¡Œçš„æ—¶é—´ï¼Œä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><p><strong>æ–¹å¼ä¸€</strong>ï¼štimer (int: <initial delay> <repeat interval>?)</p><p>æ­¤ç§æ–¹å¼éµå¾ªjava.util.Timerå¯¹è±¡çš„ä½¿ç”¨æ–¹å¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºå‡ ç§’åæ‰§è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ¯éš”å‡ ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰ã€‚</p><p><strong>æ–¹å¼äºŒ</strong>ï¼štimer(cron: <cron expression>) </p><p>æ­¤ç§æ–¹å¼ä½¿ç”¨æ ‡å‡†çš„unix cronè¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹å¼æ¥å®šä¹‰è§„åˆ™æ‰§è¡Œçš„æ—¶é—´ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºè§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;timer.drl</p><pre class="line-numbers language-none"><code class="language-none">package testtimerimport java.text.SimpleDateFormatimport java.util.Date&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•timerå±æ€§*&#x2F;rule &quot;rule_timer_1&quot;    timer (5s 2s) &#x2F;&#x2F;å«ä¹‰ï¼š5ç§’åè§¦å‘ï¼Œç„¶åæ¯éš”2ç§’è§¦å‘ä¸€æ¬¡    when    then        System.out.println(&quot;è§„åˆ™rule_timer_1è§¦å‘ï¼Œè§¦å‘æ—¶é—´ä¸ºï¼š&quot; +                          new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date()));endrule &quot;rule_timer_2&quot;    timer (cron:0&#x2F;1 * * * * ?) &#x2F;&#x2F;å«ä¹‰ï¼šæ¯éš”1ç§’è§¦å‘ä¸€æ¬¡    when    then        System.out.println(&quot;è§„åˆ™rule_timer_2è§¦å‘ï¼Œè§¦å‘æ—¶é—´ä¸ºï¼š&quot; +                          new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date()));end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">final</span> <span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//å¯åŠ¨è§„åˆ™å¼•æ“è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œç›´åˆ°è°ƒç”¨haltæ–¹æ³•æ‰ç»“æŸè§„åˆ™å¼•æ“</span>        kieSession<span class="token punctuation">.</span><span class="token function">fireUntilHalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»“æŸè§„åˆ™å¼•æ“</span>kieSession<span class="token punctuation">.</span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šå•å…ƒæµ‹è¯•çš„ä»£ç å’Œä»¥å‰çš„æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæˆ‘ä»¬è§„åˆ™æ–‡ä»¶ä¸­ä½¿ç”¨åˆ°äº†timerè¿›è¡Œå®šæ—¶æ‰§è¡Œï¼Œéœ€è¦ç¨‹åºèƒ½å¤ŸæŒç»­ä¸€æ®µæ—¶é—´æ‰èƒ½å¤Ÿçœ‹åˆ°å®šæ—¶å™¨è§¦å‘çš„æ•ˆæœã€‚</p><h3 id="5-9-date-effectiveå±æ€§"><a href="#5-9-date-effectiveå±æ€§" class="headerlink" title="5.9 date-effectiveå±æ€§"></a>5.9 date-effectiveå±æ€§</h3><p>date-effectiveå±æ€§<strong>ç”¨äºæŒ‡å®šè§„åˆ™çš„ç”Ÿæ•ˆæ—¶é—´</strong>ï¼Œå³åªæœ‰å½“å‰ç³»ç»Ÿæ—¶é—´å¤§äºç­‰äºè®¾ç½®çš„æ—¶é—´æˆ–è€…æ—¥æœŸè§„åˆ™æ‰æœ‰å¯èƒ½è§¦å‘ã€‚é»˜è®¤æ—¥æœŸæ ¼å¼ä¸ºï¼šdd-MMM-yyyyã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;dateeffective.drl</p><pre class="line-numbers language-none"><code class="language-none">package testdateeffective&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•date-effectiveå±æ€§*&#x2F;rule &quot;rule_dateeffective_1&quot;    date-effective &quot;2020-10-01 10:00&quot;    when    then        System.out.println(&quot;è§„åˆ™rule_dateeffective_1è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¾ç½®æ—¥æœŸæ ¼å¼</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"drools.dateformat"</span><span class="token punctuation">,</span><span class="token string">"yyyy-MM-dd HH:mm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šä¸Šé¢çš„ä»£ç éœ€è¦è®¾ç½®æ—¥æœŸæ ¼å¼ï¼Œå¦åˆ™æˆ‘ä»¬åœ¨è§„åˆ™æ–‡ä»¶ä¸­å†™çš„æ—¥æœŸæ ¼å¼å’Œé»˜è®¤çš„æ—¥æœŸæ ¼å¼ä¸åŒ¹é…ç¨‹åºä¼šæŠ¥é”™ã€‚</p><h3 id="5-10-date-expireså±æ€§"><a href="#5-10-date-expireså±æ€§" class="headerlink" title="5.10 date-expireså±æ€§"></a>5.10 date-expireså±æ€§</h3><p>date-expireså±æ€§ç”¨äºæŒ‡å®šè§„åˆ™çš„<strong>å¤±æ•ˆæ—¶é—´</strong>ï¼Œå³åªæœ‰å½“å‰ç³»ç»Ÿæ—¶é—´å°äºè®¾ç½®çš„æ—¶é—´æˆ–è€…æ—¥æœŸè§„åˆ™æ‰æœ‰å¯èƒ½è§¦å‘ã€‚é»˜è®¤æ—¥æœŸæ ¼å¼ä¸ºï¼šdd-MMM-yyyyã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼ã€‚<br><strong>æ³¨æ„ï¼š</strong>å¦‚æœæœ‰ä¸€ä¸ªdrlæ–‡ä»¶ä¸­ç”¨äº†è‡ªå®šä¹‰çš„æ—¥æœŸæ ¼å¼ï¼Œä¸€å®šè¦è®¾ç½®å…¨å±€å˜é‡ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resource&#x2F;rules&#x2F;dateexpires.drl</p><pre class="line-numbers language-none"><code class="language-none">package testdateexpires&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•date-expireså±æ€§*&#x2F;rule &quot;rule_dateexpires_1&quot;    date-expires &quot;2019-10-01 10:00&quot;    when    then        System.out.println(&quot;è§„åˆ™rule_dateexpires_1è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¾ç½®æ—¥æœŸæ ¼å¼</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"drools.dateformat"</span><span class="token punctuation">,</span><span class="token string">"yyyy-MM-dd HH:mm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šä¸Šé¢çš„ä»£ç éœ€è¦è®¾ç½®æ—¥æœŸæ ¼å¼ï¼Œå¦åˆ™æˆ‘ä»¬åœ¨è§„åˆ™æ–‡ä»¶ä¸­å†™çš„æ—¥æœŸæ ¼å¼å’Œé»˜è®¤çš„æ—¥æœŸæ ¼å¼ä¸åŒ¹é…ç¨‹åºä¼šæŠ¥é”™ã€‚</p><h2 id="6-Droolsé«˜çº§è¯­æ³•"><a href="#6-Droolsé«˜çº§è¯­æ³•" class="headerlink" title="6. Droolsé«˜çº§è¯­æ³•"></a>6. Droolsé«˜çº§è¯­æ³•</h2><p>å‰é¢ç« èŠ‚æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€å¥—å®Œæ•´çš„è§„åˆ™æ–‡ä»¶å†…å®¹æ„æˆå¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">package</td><td align="left">åŒ…åï¼Œåªé™äºé€»è¾‘ä¸Šçš„ç®¡ç†ï¼ŒåŒä¸€ä¸ªåŒ…åä¸‹çš„æŸ¥è¯¢æˆ–è€…å‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨</td></tr><tr><td align="left">import</td><td align="left">ç”¨äºå¯¼å…¥ç±»æˆ–è€…é™æ€æ–¹æ³•</td></tr><tr><td align="left">global</td><td align="left">å…¨å±€å˜é‡</td></tr><tr><td align="left">function</td><td align="left">è‡ªå®šä¹‰å‡½æ•°</td></tr><tr><td align="left">query</td><td align="left">æŸ¥è¯¢</td></tr><tr><td align="left">rule end</td><td align="left">è§„åˆ™ä½“</td></tr></tbody></table><p>æœ¬ç« èŠ‚æˆ‘ä»¬å°±æ¥å­¦ä¹ å…¶ä¸­çš„å‡ ä¸ªå…³é”®å­—ã€‚</p><h3 id="6-1-globalå…¨å±€å˜é‡"><a href="#6-1-globalå…¨å±€å˜é‡" class="headerlink" title="6.1 globalå…¨å±€å˜é‡"></a>6.1 globalå…¨å±€å˜é‡</h3><p>globalå…³é”®å­—ç”¨äºåœ¨è§„åˆ™æ–‡ä»¶ä¸­<strong>å®šä¹‰å…¨å±€å˜é‡</strong>ï¼Œå®ƒå¯ä»¥è®©åº”ç”¨ç¨‹åºçš„å¯¹è±¡åœ¨è§„åˆ™æ–‡ä»¶ä¸­èƒ½å¤Ÿè¢«è®¿é—®ã€‚å¯ä»¥ç”¨æ¥ä¸ºè§„åˆ™æ–‡ä»¶æä¾›æ•°æ®æˆ–æœåŠ¡ã€‚</p><p>è¯­æ³•ç»“æ„ä¸ºï¼š<strong>global å¯¹è±¡ç±»å‹ å¯¹è±¡åç§°</strong></p><p>åœ¨ä½¿ç”¨globalå®šä¹‰çš„å…¨å±€å˜é‡æ—¶æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p><p>1ã€å¦‚æœå¯¹è±¡ç±»å‹ä¸º<strong>åŒ…è£…ç±»å‹</strong>æ—¶ï¼Œåœ¨ä¸€ä¸ªè§„åˆ™ä¸­æ”¹å˜äº†globalçš„å€¼ï¼Œé‚£ä¹ˆ<strong>åªé’ˆå¯¹å½“å‰è§„åˆ™æœ‰æ•ˆ</strong>ï¼Œå¯¹å…¶ä»–è§„åˆ™ä¸­çš„globalä¸ä¼šæœ‰å½±å“ã€‚å¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯å½“å‰è§„åˆ™ä»£ç ä¸­çš„globalå‰¯æœ¬ï¼Œè§„åˆ™å†…éƒ¨ä¿®æ”¹ä¸ä¼šå½±å“å…¨å±€çš„ä½¿ç”¨ã€‚</p><p>2ã€å¦‚æœå¯¹è±¡ç±»å‹ä¸º<strong>é›†åˆç±»å‹æˆ–JavaBean</strong>æ—¶ï¼Œåœ¨ä¸€ä¸ªè§„åˆ™ä¸­æ”¹å˜äº†globalçš„å€¼ï¼Œå¯¹javaä»£ç å’Œæ‰€æœ‰è§„åˆ™éƒ½æœ‰æ•ˆã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç è¿›è¡ŒéªŒè¯ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºUserServiceç±»</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools.service;public class UserService &#123;    public void save()&#123;        System.out.println(&quot;UserService.save()...&quot;);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;global.drl</p><pre class="line-numbers language-none"><code class="language-none">package testglobal&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•globalå…¨å±€å˜é‡*&#x2F;global java.lang.Integer count &#x2F;&#x2F;å®šä¹‰ä¸€ä¸ªåŒ…è£…ç±»å‹çš„å…¨å±€å˜é‡global com.itheima.drools.service.UserService userService &#x2F;&#x2F;å®šä¹‰ä¸€ä¸ªJavaBeanç±»å‹çš„å…¨å±€å˜é‡global java.util.List gList &#x2F;&#x2F;å®šä¹‰ä¸€ä¸ªé›†åˆç±»å‹çš„å…¨å±€å˜é‡rule &quot;rule_global_1&quot;    when    then        count +&#x3D; 10; &#x2F;&#x2F;å…¨å±€å˜é‡è®¡ç®—ï¼Œåªå¯¹å½“å‰è§„åˆ™æœ‰æ•ˆï¼Œå…¶ä»–è§„åˆ™ä¸å—å½±å“        userService.save();&#x2F;&#x2F;è°ƒç”¨å…¨å±€å˜é‡çš„æ–¹æ³•        gList.add(&quot;itcast&quot;);&#x2F;&#x2F;å‘é›†åˆç±»å‹çš„å…¨å±€å˜é‡ä¸­æ·»åŠ å…ƒç´ ï¼ŒJavaä»£ç å’Œæ‰€æœ‰è§„åˆ™éƒ½å—å½±å“        gList.add(&quot;itheima&quot;);        System.out.println(&quot;count&#x3D;&quot; + count);        System.out.println(&quot;gList.size&#x3D;&quot; + gList.size());endrule &quot;rule_global_2&quot;    when    then        userService.save();        System.out.println(&quot;count&#x3D;&quot; + count);        System.out.println(&quot;gList.size&#x3D;&quot; + gList.size());end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-none"><code class="language-none">KieServices kieServices &#x3D; KieServices.Factory.get();KieContainer kieClasspathContainer &#x3D; kieServices.getKieClasspathContainer();KieSession kieSession &#x3D; kieClasspathContainer.newKieSession();&#x2F;&#x2F;è®¾ç½®å…¨å±€å˜é‡ï¼Œåç§°å’Œç±»å‹å¿…é¡»å’Œè§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰çš„å…¨å±€å˜é‡åç§°å¯¹åº”kieSession.setGlobal(&quot;userService&quot;,new UserService());kieSession.setGlobal(&quot;count&quot;,5);List list &#x3D; new ArrayList();&#x2F;&#x2F;sizeä¸º0kieSession.setGlobal(&quot;gList&quot;,list);kieSession.fireAllRules();kieSession.dispose();&#x2F;&#x2F;å› ä¸ºåœ¨è§„åˆ™ä¸­ä¸ºå…¨å±€å˜é‡æ·»åŠ äº†ä¸¤ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ç°åœ¨çš„sizeä¸º2System.out.println(list.size());<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼š</p><p>åé¢çš„ä»£ç ä¸­å®šä¹‰äº†å…¨å±€å˜é‡ä»¥åï¼Œå‰é¢çš„testï¼ˆç”¨çš„fireAllRules()æ²¡æœ‰ä¼ å‚ï¼‰éƒ½éœ€è¦åŠ ï¼Œä¸ç„¶ä¼šå‡ºé”™ã€‚</p><h3 id="6-2-queryæŸ¥è¯¢"><a href="#6-2-queryæŸ¥è¯¢" class="headerlink" title="6.2 queryæŸ¥è¯¢"></a>6.2 queryæŸ¥è¯¢</h3><p>queryæŸ¥è¯¢æä¾›äº†ä¸€ç§<strong>æŸ¥è¯¢working memoryä¸­ç¬¦åˆçº¦æŸæ¡ä»¶çš„Factå¯¹è±¡</strong>çš„ç®€å•æ–¹æ³•ã€‚å®ƒä»…åŒ…å«è§„åˆ™æ–‡ä»¶ä¸­çš„LHSéƒ¨åˆ†ï¼Œä¸ç”¨æŒ‡å®šâ€œwhenâ€å’Œâ€œthenâ€éƒ¨åˆ†å¹¶ä¸”ä»¥endç»“æŸã€‚å…·ä½“è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">query æŸ¥è¯¢çš„åç§°(å¯é€‰å‚æ•°)    LHSend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…·ä½“æ“ä½œæ­¥éª¤ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;query.drl</p><pre class="line-numbers language-none"><code class="language-none">package testqueryimport com.itheima.drools.entity.Student&#x2F;*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•queryæŸ¥è¯¢*&#x2F;&#x2F;&#x2F;ä¸å¸¦å‚æ•°çš„æŸ¥è¯¢&#x2F;&#x2F;å½“å‰queryç”¨äºæŸ¥è¯¢Working Memoryä¸­age&gt;10çš„Studentå¯¹è±¡query &quot;query_1&quot;    $student:Student(age &gt; 10)end&#x2F;&#x2F;å¸¦æœ‰å‚æ•°çš„æŸ¥è¯¢&#x2F;&#x2F;å½“å‰queryç”¨äºæŸ¥è¯¢Working Memoryä¸­age&gt;10åŒæ—¶nameéœ€è¦å’Œä¼ é€’çš„å‚æ•°nameç›¸åŒçš„Studentå¯¹è±¡query &quot;query_2&quot;(String sname)    $student:Student(age &gt; 20 &amp;&amp; name &#x3D;&#x3D; sname)end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-none"><code class="language-none">KieServices kieServices &#x3D; KieServices.Factory.get();KieContainer kieClasspathContainer &#x3D; kieServices.getKieClasspathContainer();KieSession kieSession &#x3D; kieClasspathContainer.newKieSession();Student student1 &#x3D; new Student();student1.setName(&quot;å¼ ä¸‰&quot;);student1.setAge(12);Student student2 &#x3D; new Student();student2.setName(&quot;æå››&quot;);student2.setAge(8);Student student3 &#x3D; new Student();student3.setName(&quot;ç‹äº”&quot;);student3.setAge(22);&#x2F;&#x2F;å°†å¯¹è±¡æ’å…¥Working Memoryä¸­kieSession.insert(student1);kieSession.insert(student2);kieSession.insert(student3);&#x2F;&#x2F;è°ƒç”¨è§„åˆ™æ–‡ä»¶ä¸­çš„æŸ¥è¯¢QueryResults results1 &#x3D; kieSession.getQueryResults(&quot;query_1&quot;);int size &#x3D; results1.size();System.out.println(&quot;size&#x3D;&quot; + size);for (QueryResultsRow row : results1) &#123;    Student student &#x3D; (Student) row.get(&quot;$student&quot;);    System.out.println(student);&#125;&#x2F;&#x2F;è°ƒç”¨è§„åˆ™æ–‡ä»¶ä¸­çš„æŸ¥è¯¢QueryResults results2 &#x3D; kieSession.getQueryResults(&quot;query_2&quot;,&quot;ç‹äº”&quot;);size &#x3D; results2.size();System.out.println(&quot;size&#x3D;&quot; + size);for (QueryResultsRow row : results2) &#123;    Student student &#x3D; (Student) row.get(&quot;$student&quot;);    System.out.println(student);&#125;&#x2F;&#x2F;kieSession.fireAllRules();kieSession.dispose();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-3-functionå‡½æ•°"><a href="#6-3-functionå‡½æ•°" class="headerlink" title="6.3 functionå‡½æ•°"></a>6.3 functionå‡½æ•°</h3><p>functionå…³é”®å­—ç”¨äºåœ¨è§„åˆ™æ–‡ä»¶ä¸­å®šä¹‰å‡½æ•°ï¼Œå°±ç›¸å½“äºjavaç±»ä¸­çš„æ–¹æ³•ä¸€æ ·ã€‚å¯ä»¥åœ¨è§„åˆ™ä½“ä¸­è°ƒç”¨å®šä¹‰çš„å‡½æ•°ã€‚ä½¿ç”¨å‡½æ•°çš„å¥½å¤„æ˜¯å¯ä»¥å°†ä¸šåŠ¡é€»è¾‘é›†ä¸­æ”¾ç½®åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæ ¹æ®éœ€è¦å¯ä»¥å¯¹å‡½æ•°è¿›è¡Œä¿®æ”¹ã€‚</p><p>å‡½æ•°å®šä¹‰çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">function è¿”å›å€¼ç±»å‹ å‡½æ•°å<span class="token punctuation">(</span>å¯é€‰å‚æ•°<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//é€»è¾‘ä»£ç </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…·ä½“æ“ä½œæ­¥éª¤ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™è§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;function.drl</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testfunction</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token comment">/*    æ­¤è§„åˆ™æ–‡ä»¶ç”¨äºæµ‹è¯•functionå‡½æ•°*/</span><span class="token comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°</span>function <span class="token class-name">String</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"hello "</span> <span class="token operator">+</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>rule <span class="token string">"rule_function_1"</span>    when        $student<span class="token operator">:</span><span class="token class-name">Student</span><span class="token punctuation">(</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>    then        <span class="token comment">//è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°</span>        <span class="token class-name">String</span> ret <span class="token operator">=</span> <span class="token function">sayHello</span><span class="token punctuation">(</span>$student<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieContainer</span> kieClasspathContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getKieClasspathContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieClasspathContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>student<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å°æ˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-4-LHSåŠ å¼º"><a href="#6-4-LHSåŠ å¼º" class="headerlink" title="6.4 LHSåŠ å¼º"></a>6.4 LHSåŠ å¼º</h3><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†åœ¨è§„åˆ™ä½“ä¸­çš„LHSéƒ¨åˆ†æ˜¯<strong>ä»‹äºwhenå’Œthenä¹‹é—´çš„éƒ¨åˆ†</strong>ï¼Œä¸»è¦ç”¨äºæ¨¡å¼åŒ¹é…ï¼Œåªæœ‰åŒ¹é…ç»“æœä¸ºtrueæ—¶ï¼Œæ‰ä¼šè§¦å‘RHSéƒ¨åˆ†çš„æ‰§è¡Œã€‚æœ¬ç« èŠ‚æˆ‘ä»¬ä¼šé’ˆå¯¹LHSéƒ¨åˆ†å­¦ä¹ å‡ ä¸ªæ–°çš„ç”¨æ³•ã€‚</p><h4 id="6-4-1-å¤åˆå€¼é™åˆ¶in-x2F-not-in"><a href="#6-4-1-å¤åˆå€¼é™åˆ¶in-x2F-not-in" class="headerlink" title="6.4.1 å¤åˆå€¼é™åˆ¶in&#x2F;not in"></a>6.4.1 å¤åˆå€¼é™åˆ¶in&#x2F;not in</h4><p>å¤åˆå€¼é™åˆ¶æ˜¯æŒ‡è¶…è¿‡ä¸€ç§åŒ¹é…å€¼çš„é™åˆ¶æ¡ä»¶ï¼Œç±»ä¼¼äºSQLè¯­å¥ä¸­çš„inå…³é”®å­—ã€‚Droolsè§„åˆ™ä½“ä¸­çš„LHSéƒ¨åˆ†å¯ä»¥ä½¿ç”¨inæˆ–è€…not inè¿›è¡Œå¤åˆå€¼çš„åŒ¹é…ã€‚å…·ä½“è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><p><strong>Object(field in (æ¯”è¾ƒå€¼1,æ¯”è¾ƒå€¼2â€¦))</strong></p><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">$s:Student(name in (&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;))$s:Student(name not in (&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="6-4-2-æ¡ä»¶å…ƒç´ eval"><a href="#6-4-2-æ¡ä»¶å…ƒç´ eval" class="headerlink" title="6.4.2 æ¡ä»¶å…ƒç´ eval"></a>6.4.2 æ¡ä»¶å…ƒç´ eval</h4><p>evalç”¨äºè§„åˆ™ä½“çš„LHSéƒ¨åˆ†ï¼Œå¹¶è¿”å›ä¸€ä¸ªBooleanç±»å‹çš„å€¼ã€‚è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><p><strong>eval(è¡¨è¾¾å¼)</strong></p><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">eval(true)eval(false)eval(1 &#x3D;&#x3D; 1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="6-4-3-æ¡ä»¶å…ƒç´ not"><a href="#6-4-3-æ¡ä»¶å…ƒç´ not" class="headerlink" title="6.4.3 æ¡ä»¶å…ƒç´ not"></a>6.4.3 æ¡ä»¶å…ƒç´ not</h4><p>notç”¨äºåˆ¤æ–­Working Memoryä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªFactå¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›trueï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›falseã€‚è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><p><strong>not Object(å¯é€‰å±æ€§çº¦æŸ)</strong></p><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">not Student()not Student(age &lt; 10)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="6-4-4-æ¡ä»¶å…ƒç´ exists"><a href="#6-4-4-æ¡ä»¶å…ƒç´ exists" class="headerlink" title="6.4.4 æ¡ä»¶å…ƒç´ exists"></a>6.4.4 æ¡ä»¶å…ƒç´ exists</h4><p>existsçš„ä½œç”¨ä¸notç›¸åï¼Œç”¨äºåˆ¤æ–­Working Memoryä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªFactå¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨åˆ™è¿”å›falseã€‚è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p><p><strong>exists Object(å¯é€‰å±æ€§çº¦æŸ)</strong></p><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">exists Student()exists Student(age &lt; 10 &amp;&amp; name !&#x3D; null)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯èƒ½æœ‰äººä¼šæœ‰ç–‘é—®ï¼Œæˆ‘ä»¬å‰é¢åœ¨LHSéƒ¨åˆ†è¿›è¡Œæ¡ä»¶ç¼–å†™æ—¶å¹¶æ²¡æœ‰ä½¿ç”¨existsä¹Ÿå¯ä»¥è¾¾åˆ°åˆ¤æ–­Working Memoryä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªç¬¦åˆæ¡ä»¶çš„Factå…ƒç´ çš„ç›®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨existsè¿˜æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</p><p>ä¸¤è€…çš„åŒºåˆ«ï¼šå½“å‘Working Memoryä¸­åŠ å…¥å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„Factå¯¹è±¡æ—¶ï¼Œä½¿ç”¨äº†existsçš„è§„åˆ™æ‰§è¡Œä¸€æ¬¡ï¼Œä¸ä½¿ç”¨existsçš„è§„åˆ™ä¼šæ‰§è¡Œå¤šæ¬¡ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>è§„åˆ™æ–‡ä»¶(åªæœ‰è§„åˆ™ä½“)ï¼š</p><pre class="line-numbers language-none"><code class="language-none">rule &quot;ä½¿ç”¨existsçš„è§„åˆ™&quot;    when        exists Student()    then        System.out.println(&quot;è§„åˆ™ï¼šä½¿ç”¨existsçš„è§„åˆ™è§¦å‘&quot;);endrule &quot;æ²¡æœ‰ä½¿ç”¨existsçš„è§„åˆ™&quot;    when        Student()    then        System.out.println(&quot;è§„åˆ™ï¼šæ²¡æœ‰ä½¿ç”¨existsçš„è§„åˆ™è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Javaä»£ç ï¼š</p><pre class="line-numbers language-none"><code class="language-none">kieSession.insert(new Student());kieSession.insert(new Student());kieSession.fireAllRules();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ç¬¬ä¸€ä¸ªè§„åˆ™åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºWorking Memoryä¸­å­˜åœ¨ä¸¤ä¸ªæ»¡è¶³æ¡ä»¶çš„Factå¯¹è±¡ï¼Œç¬¬äºŒä¸ªè§„åˆ™ä¼šæ‰§è¡Œä¸¤æ¬¡ã€‚</p><h4 id="6-4-5-è§„åˆ™ç»§æ‰¿"><a href="#6-4-5-è§„åˆ™ç»§æ‰¿" class="headerlink" title="6.4.5 è§„åˆ™ç»§æ‰¿"></a>6.4.5 è§„åˆ™ç»§æ‰¿</h4><p>è§„åˆ™ä¹‹é—´å¯ä»¥ä½¿ç”¨extendså…³é”®å­—è¿›è¡Œè§„åˆ™æ¡ä»¶éƒ¨åˆ†çš„ç»§æ‰¿ï¼Œç±»ä¼¼äºjavaç±»ä¹‹é—´çš„ç»§æ‰¿ã€‚<br><strong>æ³¨æ„ï¼š</strong>ç”¨äº†ç»§æ‰¿ï¼Œruleä¸­å˜é‡åä¸­çš„å˜é‡ä¿ä¸èƒ½é‡å¤ï¼Œæ¯”å¦‚rule_1ä¸­æ˜¯$sï¼Œrule_2ä¸­ä¹Ÿæ˜¯$så°±ä¼šç¼–è¯‘å¼‚å¸¸</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">rule &quot;rule_1&quot;    when        Student(age &gt; 10)    then        System.out.println(&quot;è§„åˆ™ï¼šrule_1è§¦å‘&quot;);endrule &quot;rule_2&quot; extends &quot;rule_1&quot; &#x2F;&#x2F;ç»§æ‰¿ä¸Šé¢çš„è§„åˆ™    when        &#x2F;*        æ­¤å¤„çš„æ¡ä»¶è™½ç„¶åªå†™äº†ä¸€ä¸ªï¼Œä½†æ˜¯ä»ä¸Šé¢çš„è§„åˆ™ç»§æ‰¿äº†ä¸€ä¸ªæ¡ä»¶ï¼Œ        æ‰€ä»¥å½“å‰è§„åˆ™å­˜åœ¨ä¸¤ä¸ªæ¡ä»¶ï¼Œå³Student(age &lt; 20)å’ŒStudent(age &gt; 10)        *&#x2F;        Student(age &lt; 20)     then        System.out.println(&quot;è§„åˆ™ï¼šrule_2è§¦å‘&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-5-RHSåŠ å¼º"><a href="#6-5-RHSåŠ å¼º" class="headerlink" title="6.5 RHSåŠ å¼º"></a>6.5 RHSåŠ å¼º</h3><p>RHSéƒ¨åˆ†æ˜¯è§„åˆ™ä½“çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå½“LHSéƒ¨åˆ†çš„æ¡ä»¶åŒ¹é…æˆåŠŸåï¼Œå¯¹åº”çš„RHSéƒ¨åˆ†å°±ä¼šè§¦å‘æ‰§è¡Œã€‚ä¸€èˆ¬åœ¨RHSéƒ¨åˆ†ä¸­éœ€è¦è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚</p><p>åœ¨RHSéƒ¨åˆ†Droolsä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå†…ç½®å¯¹è±¡ï¼Œåç§°å°±æ˜¯droolsã€‚æœ¬å°èŠ‚æˆ‘ä»¬æ¥ä»‹ç»å‡ ä¸ªdroolså¯¹è±¡æä¾›çš„æ–¹æ³•ã€‚</p><h4 id="6-5-1-halt"><a href="#6-5-1-halt" class="headerlink" title="6.5.1 halt"></a>6.5.1 halt</h4><p>haltæ–¹æ³•çš„ä½œç”¨æ˜¯<strong>ç«‹å³ç»ˆæ­¢åé¢æ‰€æœ‰è§„åˆ™çš„æ‰§è¡Œ</strong>ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testhalt</span>rule <span class="token string">"rule_halt_1"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™ï¼šrule_halt_1è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        drools<span class="token punctuation">.</span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç«‹å³ç»ˆæ­¢åé¢æ‰€æœ‰è§„åˆ™æ‰§è¡Œ</span>end<span class="token comment">//å½“å‰è§„åˆ™å¹¶ä¸ä¼šè§¦å‘ï¼Œå› ä¸ºä¸Šé¢çš„è§„åˆ™è°ƒç”¨äº†haltæ–¹æ³•å¯¼è‡´åé¢æ‰€æœ‰è§„åˆ™éƒ½ä¸ä¼šæ‰§è¡Œ</span>rule <span class="token string">"rule_halt_2"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™ï¼šrule_halt_2è§¦å‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-5-2-getWorkingMemory"><a href="#6-5-2-getWorkingMemory" class="headerlink" title="6.5.2 getWorkingMemory"></a>6.5.2 getWorkingMemory</h4><p>getWorkingMemoryæ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›å·¥ä½œå†…å­˜å¯¹è±¡ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testgetWorkingMemory</span>rule <span class="token string">"rule_getWorkingMemory"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>drools<span class="token punctuation">.</span><span class="token function">getWorkingMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-5-3-getRule"><a href="#6-5-3-getRule" class="headerlink" title="6.5.3 getRule"></a>6.5.3 getRule</h4><p>getRuleæ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›è§„åˆ™å¯¹è±¡ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">testgetRule</span>rule <span class="token string">"rule_getRule"</span>    when    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>drools<span class="token punctuation">.</span><span class="token function">getRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-6-è§„åˆ™æ–‡ä»¶ç¼–ç è§„èŒƒï¼ˆé‡è¦ï¼‰"><a href="#6-6-è§„åˆ™æ–‡ä»¶ç¼–ç è§„èŒƒï¼ˆé‡è¦ï¼‰" class="headerlink" title="6.6 è§„åˆ™æ–‡ä»¶ç¼–ç è§„èŒƒï¼ˆé‡è¦ï¼‰"></a>6.6 è§„åˆ™æ–‡ä»¶ç¼–ç è§„èŒƒï¼ˆé‡è¦ï¼‰</h3><p>æˆ‘ä»¬åœ¨è¿›è¡Œdrlç±»å‹çš„è§„åˆ™æ–‡ä»¶ç¼–å†™æ—¶å°½é‡éµå¾ªå¦‚ä¸‹è§„èŒƒï¼š</p><ul><li>æ‰€æœ‰çš„è§„åˆ™æ–‡ä»¶(.drl)åº”ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªè§„å®šçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚ï¼š&#x2F;rulesæ–‡ä»¶å¤¹</li><li>ä¹¦å†™çš„æ¯ä¸ªè§„åˆ™åº”å°½é‡åŠ ä¸Šæ³¨é‡Šã€‚æ³¨é‡Šè¦æ¸…æ™°æ˜äº†ï¼Œè¨€ç®€æ„èµ…</li><li>åŒä¸€ç±»å‹çš„å¯¹è±¡å°½é‡æ”¾åœ¨ä¸€ä¸ªè§„åˆ™æ–‡ä»¶ä¸­ï¼Œå¦‚æ‰€æœ‰Studentç±»å‹çš„å¯¹è±¡å°½é‡æ”¾åœ¨ä¸€ä¸ªè§„åˆ™æ–‡ä»¶ä¸­</li><li>è§„åˆ™ç»“æœéƒ¨åˆ†(RHS)å°½é‡ä¸è¦æœ‰æ¡ä»¶è¯­å¥ï¼Œå¦‚if(â€¦)ï¼Œå°½é‡ä¸è¦æœ‰å¤æ‚çš„é€»è¾‘å’Œæ·±å±‚æ¬¡çš„åµŒå¥—è¯­å¥</li><li>æ¯ä¸ªè§„åˆ™æœ€å¥½éƒ½åŠ ä¸Šsalienceå±æ€§ï¼Œæ˜ç¡®æ‰§è¡Œé¡ºåº</li><li>Droolsé»˜è®¤dialectä¸ºâ€Javaâ€ï¼Œå°½é‡é¿å…ä½¿ç”¨dialect â€œmvelâ€</li></ul><h2 id="7-Springæ•´åˆDrools"><a href="#7-Springæ•´åˆDrools" class="headerlink" title="7. Springæ•´åˆDrools"></a>7. Springæ•´åˆDrools</h2><h3 id="7-1-Springç®€å•æ•´åˆDrools"><a href="#7-1-Springç®€å•æ•´åˆDrools" class="headerlink" title="7.1 Springç®€å•æ•´åˆDrools"></a>7.1 Springç®€å•æ•´åˆDrools</h3><p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Droolsæ—¶å¾€å¾€ä¼šè·ŸSpringæ•´åˆæ¥ä½¿ç”¨ã€‚å…·ä½“æ•´åˆæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹drools_springå¹¶é…ç½®pom.xml</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools_spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>drools.version</span><span class="token punctuation">></span></span>7.10.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>drools.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring.version</span><span class="token punctuation">></span></span>5.0.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--æ³¨æ„ï¼šæ­¤å¤„å¿…é¡»æ’é™¤ä¼ é€’è¿‡æ¥çš„ä¾èµ–ï¼Œå¦åˆ™ä¼šè·Ÿæˆ‘ä»¬è‡ªå·±å¯¼å…¥çš„Spring jaråŒ…äº§ç”Ÿå†²çª--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºè§„åˆ™ç›®å½•&#x2F;resources&#x2F;rulesï¼Œä¸­rulesç›®å½•ä¸­åˆ›å»ºè§„åˆ™æ–‡ä»¶helloworld.drl</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">helloworld</span>rule <span class="token string">"rule_helloworld"</span>    when        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>    then        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§„åˆ™ï¼šrule_helloworldè§¦å‘..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºSpringé…ç½®æ–‡ä»¶&#x2F;resources&#x2F;spring.xml</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>kie</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://drools.org/schema/kie-spring<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans                            http://www.springframework.org/schema/beans/spring-beans.xsd                            http://drools.org/schema/kie-spring                            http://drools.org/schema/kie-spring.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>kmodule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kmodule<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>kbase</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kbase<span class="token punctuation">"</span></span> <span class="token attr-name">packages</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rules<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>ksession</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ksession<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>ksession</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>kbase</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>kmodule</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.kie.spring.annotations.KModuleAnnotationPostProcessor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•ç±»</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.test;import org.junit.Test;import org.junit.runner.RunWith;import org.kie.api.KieBase;import org.kie.api.cdi.KBase;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations &#x3D; &quot;classpath:spring.xml&quot;)public class DroolsSpringTest &#123;    @KBase(&quot;kbase&quot;)    private KieBase kieBase;&#x2F;&#x2F;æ³¨å…¥KieBaseå¯¹è±¡    @Test    public void test1()&#123;        KieSession kieSession &#x3D; kieBase.newKieSession();        kieSession.fireAllRules();        kieSession.dispose();    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-2-Springæ•´åˆDrools-web"><a href="#7-2-Springæ•´åˆDrools-web" class="headerlink" title="7.2 Springæ•´åˆDrools+web"></a>7.2 Springæ•´åˆDrools+web</h3><p>æœ¬å°èŠ‚æˆ‘ä»¬æ¥è¿›è¡ŒDroolså’ŒSpring Webçš„æ•´åˆã€‚å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavençš„warå·¥ç¨‹drools_springwebå¹¶åœ¨pom.xmlæ–‡ä»¶ä¸­å¯¼å…¥ç›¸å…³mavenåæ ‡</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>  <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools_springweb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>drools.version</span><span class="token punctuation">></span></span>7.10.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>drools.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring.version</span><span class="token punctuation">></span></span>5.0.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring.version</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;drools.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--æ³¨æ„ï¼šæ­¤å¤„å¿…é¡»æ’é™¤ä¼ é€’è¿‡æ¥çš„ä¾èµ–ï¼Œå¦åˆ™ä¼šè·Ÿæˆ‘ä»¬è‡ªå·±å¯¼å…¥çš„Spring jaråŒ…äº§ç”Ÿå†²çª--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat7-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   è‡ªå·±åŠ çš„ç‰ˆæœ¬å·ï¼Œä¸åŠ çš„è¯ï¼Œä¼šæŠ¥é”™        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>          <span class="token comment">&lt;!-- æŒ‡å®šç«¯å£ --></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">></span></span>80<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>port</span><span class="token punctuation">></span></span>          <span class="token comment">&lt;!-- è¯·æ±‚è·¯å¾„ --></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šé…ç½®web.xml</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">web-app</span> <span class="token name">PUBLIC</span> <span class="token string">"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"</span> <span class="token string">"http://java.sun.com/dtd/web-app_2_3.dtd"</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">></span></span>Archetype Created Web Application<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>springmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- æŒ‡å®šåŠ è½½çš„é…ç½®æ–‡ä»¶ ï¼Œé€šè¿‡å‚æ•°contextConfigLocationåŠ è½½ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:springmvc.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>springmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>*.do<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º&#x2F;resources&#x2F;springmvc.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>kie</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://drools.org/schema/kie-spring<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd       http://drools.org/schema/kie-spring       http://drools.org/schema/kie-spring.xsd       http://www.springframework.org/schema/mvc       http://www.springframework.org/schema/mvc/spring-mvc.xsd       http://www.springframework.org/schema/context       http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>kmodule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kmodule<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>kbase</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kbase<span class="token punctuation">"</span></span> <span class="token attr-name">packages</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rules<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">kie:</span>ksession</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ksession<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>ksession</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>kbase</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">kie:</span>kmodule</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.kie.spring.annotations.KModuleAnnotationPostProcessor<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--springæ‰¹é‡æ‰«æ--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.itheima<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>annotation-config</span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--springMVCæ³¨è§£é©±åŠ¨--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šåˆ›å»ºè§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;helloworld.drl</p><pre class="line-numbers language-none"><code class="language-none">package helloworldrule &quot;rule_helloworld&quot;    when        eval(true)    then        System.out.println(&quot;è§„åˆ™ï¼šrule_helloworldè§¦å‘...&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šåˆ›å»ºRuleService</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cdi<span class="token punctuation">.</span></span><span class="token class-name">KBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuleService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@KBase</span><span class="token punctuation">(</span><span class="token string">"kbase"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">KieBase</span> kieBase<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieBase<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šåˆ›å»ºHelloController</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">RuleService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RuleService</span> ruleService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/rule"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">rule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        ruleService<span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"OK"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-3-Spring-Bootæ•´åˆDrools"><a href="#7-3-Spring-Bootæ•´åˆDrools" class="headerlink" title="7.3 Spring Bootæ•´åˆDrools"></a>7.3 Spring Bootæ•´åˆDrools</h3><p>ç›®å‰åœ¨ä¼ä¸šå¼€å‘ä¸­Spring Bootå·²ç»æˆä¸ºä¸»æµï¼Œæœ¬å°èŠ‚æˆ‘ä»¬æ¥è¿›è¡ŒSpring Bootæ•´åˆDroolsã€‚å…·ä½“æ“ä½œæ­¥éª¤ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹drools_springbootå¹¶é…ç½®pom.xml</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starters<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools_springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--droolsè§„åˆ™å¼•æ“--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-templates<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>$&#123;project.artifactId&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»º&#x2F;resources&#x2F;application.ymlæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">server:  port: 8080spring:  application:    name: drools_springboot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºè§„åˆ™æ–‡ä»¶&#x2F;resources&#x2F;rules&#x2F;helloworld.drl</p><pre class="line-numbers language-none"><code class="language-none">package helloworldrule &quot;rule_helloworld&quot;    when        eval(true)    then        System.out.println(&quot;è§„åˆ™ï¼šrule_helloworldè§¦å‘...&quot;);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šç¼–å†™é…ç½®ç±»DroolsConfig</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieServices</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieFileSystem</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieRepository</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieContainer</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ResourceFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnMissingBean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token comment">/** * è§„åˆ™å¼•æ“é…ç½®ç±» */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æŒ‡å®šè§„åˆ™æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> RULES_PATH <span class="token operator">=</span> <span class="token string">"rules/"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieFileSystem</span> <span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">KieFileSystem</span> kieFileSystem <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ResourcePatternResolver</span> resourcePatternResolver <span class="token operator">=</span>             <span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span>             resourcePatternResolver<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">"classpath*:"</span> <span class="token operator">+</span> RULES_PATH <span class="token operator">+</span> <span class="token string">"*.*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            path <span class="token operator">=</span> RULES_PATH <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            kieFileSystem<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">ResourceFactory</span><span class="token punctuation">.</span><span class="token function">newClassPathResource</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> kieFileSystem<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieContainer</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">KieRepository</span> kieRepository <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieRepository<span class="token punctuation">.</span><span class="token function">addKieModule</span><span class="token punctuation">(</span>kieRepository<span class="token operator">::</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieBuilder</span> kieBuilder <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieBuilder</span><span class="token punctuation">(</span><span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieBuilder<span class="token punctuation">.</span><span class="token function">buildAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieContainer</span><span class="token punctuation">(</span>kieRepository<span class="token punctuation">.</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieBase</span> <span class="token function">kieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span> <span class="token function">kiePostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šåˆ›å»ºRuleServiceç±»</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools.service;import org.kie.api.KieBase;import org.kie.api.runtime.KieSession;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Servicepublic class RuleService &#123;    @Autowired    private KieBase kieBase;    public void rule()&#123;        KieSession kieSession &#x3D; kieBase.newKieSession();        kieSession.fireAllRules();        kieSession.dispose();    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šåˆ›å»ºHelloControllerç±»</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools.controller;import com.itheima.drools.service.RuleService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(&quot;&#x2F;hello&quot;)public class HelloController &#123;    @Autowired    private RuleService ruleService;    @RequestMapping(&quot;&#x2F;rule&quot;)    public String rule()&#123;        ruleService.rule();        return &quot;OK&quot;;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºå¯åŠ¨ç±»DroolsApplication</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class DroolsApplication &#123;    public static void main(String[] args) &#123;        SpringApplication.run(DroolsApplication.class,args);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…«æ­¥ï¼šå¯åŠ¨æœåŠ¡ï¼Œè®¿é—®<a href="http://localhost:8080/hello/rule">http://localhost:8080/hello/rule</a></p><h2 id="8-WorkBench"><a href="#8-WorkBench" class="headerlink" title="8. WorkBench"></a>8. WorkBench</h2><h3 id="8-1-WorkBenchç®€ä»‹"><a href="#8-1-WorkBenchç®€ä»‹" class="headerlink" title="8.1 WorkBenchç®€ä»‹"></a>8.1 WorkBenchç®€ä»‹</h3><p>WorkBenchæ˜¯KIEç»„ä»¶ä¸­çš„å…ƒç´ ï¼Œä¹Ÿç§°ä¸ºKIE-WBï¼Œæ˜¯Drools-WBä¸JBPM-WBçš„ç»“åˆä½“ã€‚å®ƒæ˜¯ä¸€ä¸ª<strong>å¯è§†åŒ–çš„è§„åˆ™ç¼–è¾‘å™¨</strong>ã€‚WorkBenchå…¶å®å°±æ˜¯ä¸€ä¸ªwaråŒ…ï¼Œå®‰è£…åˆ°tomcatä¸­å°±å¯ä»¥è¿è¡Œã€‚ä½¿ç”¨WorkBenchå¯ä»¥åœ¨æµè§ˆå™¨ä¸­åˆ›å»ºæ•°æ®å¯¹è±¡ã€åˆ›å»ºè§„åˆ™æ–‡ä»¶ã€åˆ›å»ºæµ‹è¯•åœºæ™¯å¹¶å°†è§„åˆ™éƒ¨ç½²åˆ°mavenä»“åº“ä¾›å…¶ä»–åº”ç”¨ä½¿ç”¨ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://download.jboss.org/drools/release/7.6.0.Final/kie-drools-wb-7.6.0.Final-tomcat8.war">https://download.jboss.org/drools/release/7.6.0.Final/kie-drools-wb-7.6.0.Final-tomcat8.war</a></p><p>æ³¨æ„ï¼šä¸‹è½½çš„waråŒ…éœ€è¦å®‰è£…åˆ°tomcat8ä¸­ã€‚</p><img src="https://gitee.com/EverSpring007/picbed/raw/master/20160726000447542" alt="img" style="zoom: 50%;" /><h3 id="8-2-å®‰è£…æ–¹å¼"><a href="#8-2-å®‰è£…æ–¹å¼" class="headerlink" title="8.2 å®‰è£…æ–¹å¼"></a>8.2 å®‰è£…æ–¹å¼</h3><h4 id="8-2-1è‡ªå·±å®‰è£…"><a href="#8-2-1è‡ªå·±å®‰è£…" class="headerlink" title="8.2.1è‡ªå·±å®‰è£…"></a>8.2.1è‡ªå·±å®‰è£…</h4><p>è½¯ä»¶å®‰è£…æ—¶ç»å¸¸ä¼šæ¶‰åŠåˆ°è½¯ä»¶ç‰ˆæœ¬å…¼å®¹æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦æ˜ç¡®å„ä¸ªè½¯ä»¶çš„ä½¿ç”¨ç‰ˆæœ¬ã€‚</p><p>æœ¬è¯¾ç¨‹ä½¿ç”¨çš„è½¯ä»¶ç¯å¢ƒå¦‚ä¸‹ï¼š</p><ul><li>æ“ä½œç³»ç»Ÿï¼šWindows 10 64ä½</li><li>JDKç‰ˆæœ¬ï¼š1.8</li><li>mavenç‰ˆæœ¬ï¼š3.5.4</li><li>Tomcatç‰ˆæœ¬ï¼š8.5</li></ul><p>å…·ä½“å®‰è£…æ­¥éª¤ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šé…ç½®Tomcatçš„ç¯å¢ƒå˜é‡CATALINA_HOMEï¼Œå¯¹åº”çš„å€¼ä¸ºTomcatå®‰è£…ç›®å½•</p><p>ç¬¬äºŒæ­¥ï¼šåœ¨Tomcatçš„binç›®å½•ä¸‹åˆ›å»ºsetenv.batæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">CATALINA_OPTS&#x3D;&quot;-Xmx512M \    -Djava.security.auth.login.config&#x3D;$CATALINA_HOME&#x2F;webapps&#x2F;kie-drools-wb&#x2F;WEB-INF&#x2F;classes&#x2F;login.config \    -Dorg.jboss.logging.provider&#x3D;jdk&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šå°†ä¸‹è½½çš„WorkBenchçš„waråŒ…æ”¹åä¸ºkie-drools-wb.warå¹¶å¤åˆ¶åˆ°Tomcatçš„webappsç›®å½•ä¸‹</p><p>ç¬¬å››æ­¥ï¼šä¿®æ”¹Tomcatä¸‹conf&#x2F;tomcat-users.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version='1.0' encoding='utf-8'?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tomcat-users</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml<span class="token punctuation">"</span></span>              <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>              <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml tomcat-users.xsd<span class="token punctuation">"</span></span>              <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å®šä¹‰adminè§’è‰²--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>admin<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  <span class="token comment">&lt;!--å®šä¹‰ä¸€ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åä¸ºkieï¼Œå¯†ç ä¸ºkieï¼Œå¯¹åº”çš„è§’è‰²ä¸ºadminè§’è‰²--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kie<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kie<span class="token punctuation">"</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>admin<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tomcat-users</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šä¸‹è½½ä»¥ä¸‹ä¸‰ä¸ªjaråŒ…å¹¶å¤åˆ¶åˆ°Tomcatçš„libç›®å½•ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">kie-tomcat-integration-7.10.0.Final.jarjavax.security.jacc-api-1.5.jarslf4j-api-1.7.25.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šä¿®æ”¹Tomcatçš„conf&#x2F;server.xmlæ–‡ä»¶ï¼Œæ·»åŠ Valveæ ‡ç­¾ï¼Œå†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.kie.integration.tomcat.JACCValve<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨Tomcatå¹¶è®¿é—®<a href="http://localhost:8080/kie-drools-wb%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0WorkBench%E7%9A%84%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2%E3%80%82%E4%BD%BF%E7%94%A8%E5%89%8D%E9%9D%A2%E5%9C%A8tomcat-users.xml%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84%E7%94%A8%E6%88%B7%E8%BF%9B%E8%A1%8C%E7%99%BB%E5%BD%95%E5%8D%B3%E5%8F%AF">http://localhost:8080/kie-drools-wbï¼Œå¯ä»¥çœ‹åˆ°WorkBenchçš„ç™»å½•é¡µé¢ã€‚ä½¿ç”¨å‰é¢åœ¨tomcat-users.xmlæ–‡ä»¶ä¸­å®šä¹‰çš„ç”¨æˆ·è¿›è¡Œç™»å½•å³å¯</a></p><p>æ³¨æ„ï¼šè¿™é‡Œæˆ‘è‡ªå·±çš„æ˜¯80ç«¯å£ï¼Œ<a href="http://localhost/kie-drools-wb">http://localhost/kie-drools-wb</a></p><p><img src="/media/pictures/Drools.assets/12.png" alt="12"></p><p>ç™»å½•æˆåŠŸåè¿›å…¥ç³»ç»Ÿé¦–é¡µï¼š</p><p><img src="/media/pictures/Drools.assets/13.png" alt="13"></p><h4 id="8-2-2-dockerå®‰è£…"><a href="#8-2-2-dockerå®‰è£…" class="headerlink" title="8.2.2 dockerå®‰è£…"></a>8.2.2 dockerå®‰è£…</h4><p>ä½¿ç”¨dockerå®‰è£…æ–¹ä¾¿å¾ˆå¤šï¼Œdockeré•œåƒåœ°å€ï¼š<a href="https://hub.docker.com/r/jboss/drools-workbench-showcase">https://hub.docker.com/r/jboss/drools-workbench-showcase</a> ã€‚<br>æ³¨æ„ä¸€ä¸‹ï¼šæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œdrools-workbench-showcaseå’Œdrools-workbenchï¼Œå®ƒä»¬çš„ä¸åŒä¹‹å¤„åœ¨äºâ€œdrools-workbench-showcaseâ€æ˜¯å®˜æ–¹é…ç½®å¥½çš„â€œdrools-workbenchâ€ï¼Œå› è€Œåœ¨â€œdrools-workbench-showcaseâ€ä¸­ç”¨æˆ·ä¸ç”¨è‡ªå·±å»æ³¨å†Œï¼Œç›´æ¥å°†è´¦å·æ‹¿æ¥ç™»å½•å°±å¯ä»¥äº†ï¼Œè€Œâ€œdrools-workbenchâ€ä¸æ˜¯ï¼Œå®ƒè¿˜å¾—éœ€è¦æ‰‹åŠ¨å»æ³¨å†Œè´¦å·ï¼Œå› è€Œä½¿ç”¨æœ€å¤šçš„ä¹Ÿå°±æ˜¯â€œdrools-workbench-showcaseâ€<br>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©å¯¹åº”çš„7.6.0ç‰ˆæœ¬</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker pull jboss&#x2F;drools-workbench-showcase:7.6.0.Final<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šå¯åŠ¨å®¹å™¨</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ docker run -p 10076:8080 -p 10077:8001 -d --name drools-workbench jboss&#x2F;drools-workbench-showcase:7.6.0.Final<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>10076ç«¯å£ä¸ºæ§åˆ¶å°åœ°å€ï¼Œ10077ä¸ºå†…ç½®çš„gitä»“åº“ç«¯å£<br>kie workbenchå†…ç½®äº†ä¸€ä¸ªgitä»“åº“ï¼Œåˆ›å»ºçš„å·¥ç¨‹ç­‰å†…å®¹å°±å­˜å‚¨åœ¨ä»“åº“ä¸­çš„ã€‚ä¸ºäº†å®‰å…¨ï¼Œå¯ä»¥å¯åŠ¨çš„æ—¶å€™æŒ‡å®švolumnï¼ŒæŒ‚è½½åˆ°hostã€‚gité»˜è®¤åœ°å€ä¸º$WORKING_DIR&#x2F;.niogitï¼Œ7.6.0ç‰ˆæœ¬æŒ‡å‘çš„æ˜¯&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;bin&#x2F;.niogitã€‚å¯åŠ¨å¯ä»¥å‘½ä»¤æ”¹ä¸º</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ docker cp é•œåƒid:&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;bin&#x2F;.niogit &#x2F;home&#x2F;docker&#x2F;drools-workbench$ docker run -p 10076:8080 -p 10077:8001 --user&#x3D;$UID:$(id -g $USER) -v &#x2F;home&#x2F;docker&#x2F;drools-workbench&#x2F;.niogit:&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;bin&#x2F;.niogit -d --name drools-workbench jboss&#x2F;drools-workbench-showcase:7.6.0.Final<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æ³¨æ„</strong>ï¼šè¦æŒ‡å®šç”¨æˆ·â€“user&#x3D;$UID:$(id -g $USER)ï¼Œå¦åˆ™åœ¨å¯åŠ¨æ—¶å‡ºç°æƒé™ä¸è¶³çš„é—®é¢˜<br>ç¬¬ä¸‰æ­¥ï¼šè®¿é—®<a href="http://xxx:10076/drools-wb">http://xxx:10076/drools-wb</a><br>é»˜è®¤å·²æœ‰çš„ç”¨æˆ·å’Œè§’è‰²</p><table><thead><tr><th>USER</th><th>PASSWORD</th><th>ROLE</th></tr></thead><tbody><tr><td>admin</td><td>admin</td><td>admin,analyst,kiemgmt</td></tr><tr><td>krisv</td><td>krisv</td><td>admin,analyst</td></tr><tr><td>john</td><td>john</td><td>analyst,Accounting,PM</td></tr><tr><td>sales-rep</td><td>sales-rep</td><td>analyst,sales</td></tr><tr><td>katy</td><td>katy</td><td>analyst,HR</td></tr><tr><td>jack</td><td>jack</td><td>analyst,IT</td></tr><tr><td>ç¬¬å››æ­¥ï¼š</td><td></td><td></td></tr><tr><td>åé¢åˆ›å»ºproject,facts,drlæ–‡ä»¶å’Œ8.2ä¸€æ ·</td><td></td><td></td></tr></tbody></table><h3 id="8-3-ä½¿ç”¨æ–¹å¼"><a href="#8-3-ä½¿ç”¨æ–¹å¼" class="headerlink" title="8.3 ä½¿ç”¨æ–¹å¼"></a>8.3 ä½¿ç”¨æ–¹å¼</h3><h4 id="8-3-1-åˆ›å»ºç©ºé—´ã€é¡¹ç›®"><a href="#8-3-1-åˆ›å»ºç©ºé—´ã€é¡¹ç›®" class="headerlink" title="8.3.1 åˆ›å»ºç©ºé—´ã€é¡¹ç›®"></a>8.3.1 åˆ›å»ºç©ºé—´ã€é¡¹ç›®</h4><p>WorkBenchä¸­å­˜åœ¨ç©ºé—´å’Œé¡¹ç›®çš„æ¦‚å¿µã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨WorkBenchæ—¶é¦–å…ˆéœ€è¦åˆ›å»ºç©ºé—´ï¼ˆSpaceï¼‰ï¼Œåœ¨ç©ºé—´ä¸­åˆ›å»ºé¡¹ç›®ï¼Œåœ¨é¡¹ç›®ä¸­åˆ›å»ºæ•°æ®å¯¹è±¡ã€è§„åˆ™æ–‡ä»¶ç­‰ã€‚</p><ul><li><p>åˆ›å»ºç©ºé—´</p><p>ç¬¬ä¸€æ­¥ï¼šç™»å½•WorkBenchåè¿›è¡Œç³»ç»Ÿé¦–é¡µï¼Œç‚¹å‡»é¦–é¡µä¸­çš„DesignåŒºåŸŸè¿›å…¥é¡¹ç›®åˆ—è¡¨é¡µé¢ï¼š</p><p><img src="/media/pictures/Drools.assets/14.png" alt="14"></p><p>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ç™»å½•è¿˜æ²¡æœ‰åˆ›å»ºé¡¹ç›®åˆ™æ— æ³•çœ‹åˆ°é¡¹ç›®</p><p>ç¬¬äºŒæ­¥ï¼šç‚¹å‡»å·¦ä¸Šè§’Spaceså¯¼èˆªé“¾æ¥è¿›å…¥ç©ºé—´åˆ—è¡¨é¡µé¢</p><p><img src="/media/pictures/Drools.assets/15.png" alt="15"></p><p>ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡»å³ä¸Šè§’Add SpaceæŒ‰é’®å¼¹å‡ºåˆ›å»ºæ·»åŠ ç©ºé—´çª—å£</p><p><img src="/media/pictures/Drools.assets/16.png" alt="16"></p><p>å½•å…¥ç©ºé—´åç§°ï¼Œç‚¹å‡»SaveæŒ‰é’®åˆ™å®Œæˆç©ºé—´çš„åˆ›å»ºï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/media/pictures/Drools.assets/17.png" alt="17"></p></li><li><p>åˆ›å»ºé¡¹ç›®</p><p>å‰é¢å·²ç»æåˆ°ï¼Œæˆ‘ä»¬åœ¨WorkBenchä¸­éœ€è¦å…ˆåˆ›å»ºç©ºé—´ï¼Œåœ¨ç©ºé—´ä¸­æ‰èƒ½åˆ›å»ºé¡¹ç›®ã€‚ä¸Šé¢æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªç©ºé—´itheimaï¼Œç°åœ¨éœ€è¦ä½æ­¤ç©ºé—´ä¸­åˆ›å»ºé¡¹ç›®ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šç‚¹å‡»itheimaç©ºé—´ï¼Œè¿›å…¥æ­¤ç©ºé—´</p><p><img src="/media/pictures/Drools.assets/18.png" alt="18"></p><p>å¯ä»¥çœ‹åˆ°å½“å‰ç©ºé—´ä¸­è¿˜æ²¡æœ‰é¡¹ç›®</p><p>ç¬¬äºŒæ­¥ï¼šç‚¹å‡»Add ProjectæŒ‰é’®å¼¹å‡ºæ·»åŠ é¡¹ç›®çª—å£</p><p><img src="/media/pictures/Drools.assets/19.png" alt="19"></p><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨æ·»åŠ é¡¹ç›®çª—å£ä¸­å½•å…¥é¡¹ç›®åç§°ï¼ˆä¾‹å¦‚é¡¹ç›®åç§°ä¸ºpro1ï¼‰ï¼Œç‚¹å‡»AddæŒ‰é’®å®Œæˆæ“ä½œ</p><p><img src="/media/pictures/Drools.assets/20.png" alt="20"></p><p>å¯ä»¥çœ‹åˆ°åœ¨å®Œæˆé¡¹ç›®åˆ›å»ºåï¼Œç³»ç»Ÿç›´æ¥è·³è½¬åˆ°äº†é¡¹ç›®é¡µé¢ã€‚è¦æŸ¥çœ‹å½“å‰itheimaç©ºé—´ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼Œå¯ä»¥ç‚¹å‡»å·¦ä¸Šè§’itheimaé“¾æ¥ï¼š</p><p><img src="/media/pictures/Drools.assets/21.png" alt="21"></p></li></ul><h4 id="8-3-2-åˆ›å»ºæ•°æ®å¯¹è±¡"><a href="#8-3-2-åˆ›å»ºæ•°æ®å¯¹è±¡" class="headerlink" title="8.3.2 åˆ›å»ºæ•°æ®å¯¹è±¡"></a>8.3.2 åˆ›å»ºæ•°æ®å¯¹è±¡</h4><p>æ•°æ®å¯¹è±¡å…¶å®å°±æ˜¯JavaBeanï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨drlè§„åˆ™æ–‡ä»¶ä¸­ä½¿ç”¨è¿›è¡Œè§„åˆ™åŒ¹é…ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨itheimaç©ºé—´ä¸­ç‚¹å‡»pro1é¡¹ç›®ï¼Œè¿›å…¥æ­¤é¡¹ç›®é¡µé¢</p><p><img src="/media/pictures/Drools.assets/22.png" alt="22"></p><p>ç¬¬äºŒæ­¥ï¼šç‚¹å‡»Create New AssetæŒ‰é’®é€‰æ‹©â€œæ•°æ®å¯¹è±¡â€</p><p><img src="/media/pictures/Drools.assets/23.png" alt="23"></p><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨å¼¹å‡ºçš„åˆ›å»ºæ•°æ®å¯¹è±¡çª—å£ä¸­è¾“å…¥æ•°æ®å¯¹è±¡çš„åç§°ï¼Œç‚¹å‡»ç¡®å®šæŒ‰é’®å®Œæˆæ“ä½œ</p><p><img src="/media/pictures/Drools.assets/24.png" alt="24"></p><p>æ“ä½œå®Œæˆåå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š</p><p><img src="/media/pictures/Drools.assets/25.png" alt="25"></p><p>ç¬¬å››æ­¥ï¼šç‚¹å‡»â€œæ·»åŠ å­—æ®µâ€æŒ‰é’®å¼¹å‡ºæ–°å»ºå­—æ®µçª—å£</p><p><img src="/media/pictures/Drools.assets/26.png" alt="26"></p><p>ç¬¬äº”æ­¥ï¼šåœ¨æ–°å»ºå­—æ®µçª—å£ä¸­å½•å…¥å­—æ®µIdï¼ˆå…¶å®å°±æ˜¯å±æ€§åï¼‰ï¼Œé€‰æ‹©ç±»å‹ï¼Œç‚¹å‡»åˆ›å»ºæŒ‰é’®å®Œæˆæ“ä½œ</p><p><img src="/media/pictures/Drools.assets/27.png" alt="27"></p><p>å®Œæˆæ“ä½œåå¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„å­—æ®µï¼š</p><p><img src="/media/pictures/Drools.assets/28.png" alt="28"></p><p>å¯ä»¥ç‚¹å‡»æ·»åŠ å­—æ®µæŒ‰é’®ç»§ç»­åˆ›å»ºå…¶ä»–å­—æ®µï¼š</p><p><img src="/media/pictures/Drools.assets/29.png" alt="29"></p><p>æ³¨æ„æ·»åŠ å®Œå­—æ®µåéœ€è¦ç‚¹å‡»å³ä¸Šè§’ä¿å­˜æŒ‰é’®å®Œæˆä¿å­˜æ“ä½œï¼š</p><p><img src="/media/pictures/Drools.assets/32.png" alt="32"></p><p>ç‚¹å‡»æºä»£ç æŒ‰é’®å¯ä»¥æŸ¥çœ‹åˆšæ‰åˆ›å»ºçš„Personå¯¹è±¡æºç ï¼š</p><p><img src="/media/pictures/Drools.assets/30.png" alt="30"></p><p>ç‚¹å‡»å·¦ä¸Šè§’pro1é¡¹ç›®é“¾æ¥ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰pro1é¡¹ç›®ä¸­å·²ç»åˆ›å»ºçš„å„ç§ç±»å‹çš„å¯¹è±¡ï¼š</p><p><img src="/media/pictures/Drools.assets/31.png" alt="31"></p><h4 id="8-3-3-åˆ›å»ºDRLè§„åˆ™æ–‡ä»¶"><a href="#8-3-3-åˆ›å»ºDRLè§„åˆ™æ–‡ä»¶" class="headerlink" title="8.3.3 åˆ›å»ºDRLè§„åˆ™æ–‡ä»¶"></a>8.3.3 åˆ›å»ºDRLè§„åˆ™æ–‡ä»¶</h4><p>ç¬¬ä¸€æ­¥ï¼šåœ¨pro1é¡¹ç›®é¡µé¢ç‚¹å‡»å³ä¸Šè§’Create New AssetæŒ‰é’®ï¼Œé€‰æ‹©â€œDRLæ–‡ä»¶â€ï¼Œå¼¹å‡ºåˆ›å»ºDRLæ–‡ä»¶çª—å£</p><p><img src="/media/pictures/Drools.assets/33.png" alt="33"></p><p>ç¬¬äºŒæ­¥ï¼šåœ¨æ·»åŠ DRLæ–‡ä»¶çª—å£å½•å…¥DRLæ–‡ä»¶åç§°ï¼Œç‚¹å‡»ç¡®å®šæŒ‰é’®å®Œæˆæ“ä½œ</p><p><img src="/media/pictures/Drools.assets/34.png" alt="34"></p><p>ç¬¬ä¸‰æ­¥ï¼šä¸Šé¢ç‚¹å‡»ç¡®å®šæŒ‰é’®å®Œæˆåˆ›å»ºDRLæ–‡ä»¶åï¼Œé¡µé¢ä¼šè·³è½¬åˆ°ç¼–è¾‘DRLæ–‡ä»¶é¡µé¢</p><p><img src="/media/pictures/Drools.assets/35.png" alt="35"></p><p>å¯ä»¥çœ‹åˆ°DRLè§„åˆ™æ–‡ä»¶é¡µé¢åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå·¦ä¾§ä¸ºé¡¹ç›®æµè§ˆè§†å›¾ã€å³ä¾§ä¸ºç¼–è¾‘åŒºåŸŸï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å·¦ä¾§é»˜è®¤å±•ç¤ºçš„ä¸æ˜¯é¡¹ç›®æµè§ˆè§†å›¾ï¼Œéœ€è¦ç‚¹å‡»ä¸Šé¢è®¾ç½®æŒ‰é’®ï¼Œé€‰æ‹©â€œèµ„æ–™åº“è§†å›¾â€å’Œâ€œæ˜¾ç¤ºä¸ºæ–‡ä»¶å¤¹â€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/media/pictures/Drools.assets/36.png" alt="36"></p><p>ç¬¬å››æ­¥ï¼šåœ¨ç¼–è¾‘DRLæ–‡ä»¶é¡µé¢å³ä¾§åŒºåŸŸè¿›è¡ŒDRLæ–‡ä»¶çš„ç¼–å†™ï¼Œç‚¹å‡»å³ä¸Šè§’ä¿å­˜æŒ‰é’®å®Œæˆä¿å­˜æ“ä½œï¼Œç‚¹å‡»æ£€éªŒæŒ‰é’®è¿›è¡Œè§„åˆ™æ–‡ä»¶è¯­æ³•æ£€æŸ¥</p><p><img src="/media/pictures/Drools.assets/37.png" alt="37"></p><p>ç‚¹å‡»å·¦ä¸Šè§’pro1é¡¹ç›®å›åˆ°é¡¹ç›®é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æ­¤é¡¹ç›®ä¸‹å·²ç»å­˜åœ¨ä¸¤ä¸ªå¯¹è±¡ï¼Œå³person.drlè§„åˆ™æ–‡ä»¶å’ŒPersonç±»ï¼š</p><p><img src="/media/pictures/Drools.assets/38.png" alt="38"></p><h4 id="8-3-4-åˆ›å»ºæµ‹è¯•åœºæ™¯"><a href="#8-3-4-åˆ›å»ºæµ‹è¯•åœºæ™¯" class="headerlink" title="8.3.4 åˆ›å»ºæµ‹è¯•åœºæ™¯"></a>8.3.4 åˆ›å»ºæµ‹è¯•åœºæ™¯</h4><p>å‰é¢æˆ‘ä»¬å·²ç»åˆ›å»ºäº†Personæ•°æ®å¯¹è±¡å’Œpersonè§„åˆ™æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æµ‹è¯•ä¸€ä¸‹è§„åˆ™æ–‡ä»¶ä¸­çš„è§„åˆ™ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºæµ‹è¯•åœºæ™¯æ¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨é¡¹ç›®é¡µé¢ç‚¹å‡»Create New AssetæŒ‰é’®é€‰æ‹©â€œæµ‹è¯•åœºæ™¯â€ï¼Œå¼¹å‡ºåˆ›å»ºæµ‹è¯•åœºæ™¯çª—å£</p><p><img src="/media/pictures/Drools.assets/39.png" alt="39"></p><p>ç¬¬äºŒæ­¥ï¼šåœ¨å¼¹å‡ºçš„åˆ›å»ºæµ‹è¯•åœºæ™¯çª—å£ä¸­å½•å…¥æµ‹è¯•åœºæ™¯çš„åç§°ï¼Œç‚¹å‡»ç¡®å®šå®Œæˆæ“ä½œ</p><p><img src="/media/pictures/Drools.assets/40.png" alt="40"></p><p>å®Œæˆæµ‹è¯•åœºæ™¯çš„åˆ›å»ºåï¼Œé¡µé¢ä¼šè·³è½¬åˆ°æµ‹è¯•åœºæ™¯ç¼–è¾‘é¡µé¢ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/media/pictures/Drools.assets/41.png" alt="41"></p><p>ç¬¬ä¸‰æ­¥ï¼šå› ä¸ºæˆ‘ä»¬ç¼–å†™çš„è§„åˆ™æ–‡ä»¶ä¸­éœ€è¦ä»å·¥ä½œå†…å­˜ä¸­è·å–Personå¯¹è±¡è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œæ‰€ä»¥åœ¨æµ‹è¯•åœºæ™¯ä¸­éœ€è¦å‡†å¤‡Personå¯¹è±¡ç»™å·¥ä½œå†…å­˜ï¼Œç‚¹å‡»â€œGIVENâ€æŒ‰é’®å¼¹å‡ºæ–°å»ºæ•°æ®å½•å…¥çª—å£ï¼Œé€‰æ‹©Personç±»ï¼Œè¾“å…¥æ¡†ä¸­è¾“å…¥äº‹å®åç§°ï¼ˆåç§°ä»»æ„ï¼‰ï¼Œå¦‚ä¸‹å›¾</p><p><img src="/media/pictures/Drools.assets/42.png" alt="42"></p><p>ç¬¬å››æ­¥ï¼šå½•å…¥äº‹å®åç§°åç‚¹å‡»åé¢çš„æ·»åŠ æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°Personå¯¹è±¡å·²ç»æ·»åŠ æˆåŠŸ</p><p><img src="/media/pictures/Drools.assets/43.png" alt="43"></p><p>ç¬¬äº”æ­¥ï¼šæˆ‘ä»¬ç»™å·¥ä½œå†…å­˜æä¾›çš„Personå¯¹è±¡è¿˜éœ€è¦è®¾ç½®ageå±æ€§çš„å€¼ï¼Œç‚¹å‡»â€œæ·»åŠ å­—æ®µâ€æŒ‰é’®å¼¹å‡ºçª—å£ï¼Œé€‰æ‹©ageå±æ€§</p><p><img src="/media/pictures/Drools.assets/44.png" alt="44"></p><p>ç‚¹å‡»ç¡®å®šæŒ‰é’®åå¯ä»¥çœ‹åˆ°å­—æ®µå·²ç»æ·»åŠ æˆåŠŸï¼š</p><p><img src="/media/pictures/Drools.assets/45.png" alt="45"></p><p>ç¬¬å…­æ­¥ï¼šç‚¹å‡»ageå±æ€§åé¢çš„ç¼–è¾‘æŒ‰é’®ï¼Œå¼¹å‡ºå­—æ®µå€¼çª—å£</p><p><img src="/media/pictures/Drools.assets/image-20200113154817582.png" alt="image-20200113154817582"></p><p>ç¬¬ä¸ƒæ­¥ï¼šåœ¨å¼¹å‡ºçš„çª—å£ä¸­ç‚¹å‡»å­—é¢å€¼æŒ‰é’®ï¼Œé‡æ–°å›åˆ°æµ‹è¯•åœºæ™¯é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ageåé¢å‡ºç°è¾“å…¥æ¡†ï¼Œå¯ä»¥ä¸ºageå±æ€§è®¾ç½®å€¼</p><p><img src="/media/pictures/Drools.assets/image-20200113155136957.png" alt="image-20200113155136957"></p><p>è®¾ç½®å¥½ageå±æ€§çš„å€¼åç‚¹å‡»ä¿å­˜æŒ‰é’®ä¿å­˜æµ‹è¯•åœºæ™¯</p><p>ç¬¬å…«æ­¥ï¼šç‚¹å‡»å³ä¸Šè§’â€œè¿è¡Œæµ‹è¯•åœºæ™¯â€æŒ‰é’®è¿›è¡Œæµ‹è¯•</p><p><img src="/media/pictures/Drools.assets/image-20200113155332666.png" alt="image-20200113155332666"></p><p>æµ‹è¯•æˆåŠŸåå¯ä»¥æŸ¥çœ‹WorkBenchéƒ¨ç½²çš„Tomcatæ§åˆ¶å°ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200113155819517.png" alt="image-20200113155819517"></p><h4 id="8-3-5-è®¾ç½®KieBaseå’ŒKieSession"><a href="#8-3-5-è®¾ç½®KieBaseå’ŒKieSession" class="headerlink" title="8.3.5 è®¾ç½®KieBaseå’ŒKieSession"></a>8.3.5 è®¾ç½®KieBaseå’ŒKieSession</h4><p>ç¬¬ä¸€æ­¥ï¼šåœ¨pro1é¡¹ç›®é¡µé¢ç‚¹å‡»å³ä¸Šè§’SettingsæŒ‰é’®è¿›å…¥è®¾ç½®é¡µé¢</p><p><img src="/media/pictures/Drools.assets/image-20200113162923877.png" alt="image-20200113162923877"></p><p>ç¬¬äºŒæ­¥ï¼šåœ¨è®¾ç½®é¡µé¢é€‰æ‹©â€œçŸ¥è¯†åº“å’Œä¼šè¯â€é€‰é¡¹</p><p><img src="/media/pictures/Drools.assets/image-20200113163005061.png" alt="image-20200113163005061"></p><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨å¼¹å‡ºçš„çŸ¥è¯†åº“å’Œä¼šè¯é¡µé¢ç‚¹å‡»â€œæ·»åŠ â€æŒ‰é’®è¿›è¡Œè®¾ç½®</p><p><img src="/media/pictures/Drools.assets/image-20200113163313305.png" alt="image-20200113163313305"></p><p><img src="/media/pictures/Drools.assets/image-20200113163344174.png" alt="image-20200113163344174"></p><p>ç¬¬å››æ­¥ï¼šè®¾ç½®å®Œæˆåç‚¹å‡»å³ä¸Šè§’ä¿å­˜æŒ‰é’®å®Œæˆè®¾ç½®æ“ä½œï¼Œå¯ä»¥é€šè¿‡å·¦ä¾§æµè§ˆè§†å›¾ç‚¹å‡»kmodule.xmlï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p>æ³¨æ„ï¼šå‡ºä¸æ¥çš„è¯ï¼Œè¦åˆ·æ–°ä¸€ä¸‹ã€‚</p><p><img src="/media/pictures/Drools.assets/image-20200113163539676.png" alt="image-20200113163539676"></p><h4 id="8-3-6-ç¼–è¯‘ã€æ„å»ºã€éƒ¨ç½²"><a href="#8-3-6-ç¼–è¯‘ã€æ„å»ºã€éƒ¨ç½²" class="headerlink" title="8.3.6 ç¼–è¯‘ã€æ„å»ºã€éƒ¨ç½²"></a>8.3.6 ç¼–è¯‘ã€æ„å»ºã€éƒ¨ç½²</h4><p>å‰é¢æˆ‘ä»¬å·²ç»åœ¨WorkBenchä¸­åˆ›å»ºäº†ä¸€ä¸ªç©ºé—´itheimaï¼Œå¹¶ä¸”åœ¨æ­¤ç©ºé—´ä¸­åˆ›å»ºäº†ä¸€ä¸ªé¡¹ç›®pro1ï¼Œåœ¨æ­¤é¡¹ç›®ä¸­åˆ›å»ºäº†æ•°æ®æ–‡ä»¶ã€è§„åˆ™æ–‡ä»¶å’Œæµ‹è¯•åœºæ™¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200113160102668.png" alt="image-20200113160102668"></p><p>ç‚¹å‡»å³ä¸Šè§’â€œCompileâ€æŒ‰é’®å¯ä»¥å¯¹é¡¹ç›®è¿›è¡Œç¼–è¯‘ï¼Œç‚¹å‡»â€œBulid&amp;Deployâ€æŒ‰é’®è¿›è¡Œæ„å»ºå’Œéƒ¨ç½²ã€‚</p><p>éƒ¨ç½²æˆåŠŸåå¯ä»¥åœ¨æœ¬åœ°mavenä»“åº“ä¸­çœ‹åˆ°å½“å‰é¡¹ç›®å·²ç»è¢«æ‰“æˆjaråŒ…ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200113160728259.png" alt="image-20200113160728259"></p><p>å°†ä¸Šé¢çš„jaråŒ…è¿›è¡Œè§£å‹ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºçš„æ•°æ®å¯¹è±¡Personå’Œè§„åˆ™æ–‡ä»¶personä»¥åŠkmodule.xmléƒ½å·²ç»æ‰“åˆ°jaråŒ…ä¸­äº†ã€‚</p><h4 id="8-3-7-åœ¨é¡¹ç›®ä¸­ä½¿ç”¨éƒ¨ç½²çš„è§„åˆ™"><a href="#8-3-7-åœ¨é¡¹ç›®ä¸­ä½¿ç”¨éƒ¨ç½²çš„è§„åˆ™" class="headerlink" title="8.3.7 åœ¨é¡¹ç›®ä¸­ä½¿ç”¨éƒ¨ç½²çš„è§„åˆ™"></a>8.3.7 åœ¨é¡¹ç›®ä¸­ä½¿ç”¨éƒ¨ç½²çš„è§„åˆ™</h4><p>å‰é¢æˆ‘ä»¬å·²ç»åœ¨WorkBenchä¸­åˆ›å»ºäº†pro1é¡¹ç›®ï¼Œå¹¶ä¸”åœ¨pro1é¡¹ç›®ä¸­åˆ›å»ºäº†æ•°æ®æ–‡ä»¶ã€è§„åˆ™æ–‡ä»¶ç­‰ã€‚æœ€åæˆ‘ä»¬å°†æ­¤é¡¹ç›®æ‰“æˆjaråŒ…éƒ¨ç½²åˆ°äº†mavenä»“åº“ä¸­ã€‚æœ¬å°èŠ‚å°±éœ€è¦åœ¨å¤–éƒ¨é¡¹ç›®ä¸­ä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„è§„åˆ™ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨IDEAä¸­åˆ›å»ºä¸€ä¸ªmavené¡¹ç›®å¹¶åœ¨pom.xmlæ–‡ä»¶ä¸­å¯¼å…¥ç›¸å…³åæ ‡</p><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;    &lt;groupId&gt;org.drools&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;drools-compiler&lt;&#x2F;artifactId&gt;    &lt;version&gt;7.10.0.Final&lt;&#x2F;version&gt;&lt;&#x2F;dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;junit&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;junit&lt;&#x2F;artifactId&gt;    &lt;version&gt;4.12&lt;&#x2F;version&gt;&lt;&#x2F;dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ•°æ®å¯¹è±¡Personï¼Œéœ€è¦å’ŒWorkBenchä¸­åˆ›å»ºçš„PersonåŒ…åã€ç±»åå®Œå…¨ç›¸åŒï¼Œå±æ€§ä¹Ÿéœ€è¦å¯¹åº”</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>pro1</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> id<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™å•å…ƒæµ‹è¯•ï¼Œè¿œç¨‹åŠ è½½mavenä»“åº“ä¸­çš„jaråŒ…æœ€ç»ˆå®Œæˆè§„åˆ™è°ƒç”¨</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>    <span class="token comment">//é€šè¿‡æ­¤URLå¯ä»¥è®¿é—®åˆ°mavenä»“åº“ä¸­çš„jaråŒ…</span>    <span class="token comment">//URLåœ°å€æ„æˆï¼šhttp://ipåœ°å€:Tomcatç«¯å£å·/WorkBenchå·¥ç¨‹å/maven2/åæ ‡/ç‰ˆæœ¬å·/xxx.jar</span>    <span class="token class-name">String</span> url <span class="token operator">=</span>     <span class="token string">"http://localhost:8080/kie-drools-wb/maven2/com/itheima/pro1/1.0.0/pro1-1.0.0.jar"</span><span class="token punctuation">;</span>        <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//é€šè¿‡Resourceèµ„æºå¯¹è±¡åŠ è½½jaråŒ…</span>    <span class="token class-name">UrlResource</span> resource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UrlResource</span><span class="token punctuation">)</span> kieServices<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newUrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//é€šè¿‡Workbenchæä¾›çš„æœåŠ¡æ¥è®¿é—®mavenä»“åº“ä¸­çš„jaråŒ…èµ„æºï¼Œéœ€è¦å…ˆè¿›è¡ŒWorkbenchçš„è®¤è¯</span>    resource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"kie"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    resource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"kie"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    resource<span class="token punctuation">.</span><span class="token function">setBasicAuthentication</span><span class="token punctuation">(</span><span class="token string">"enabled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†èµ„æºè½¬æ¢ä¸ºè¾“å…¥æµï¼Œé€šè¿‡æ­¤è¾“å…¥æµå¯ä»¥è¯»å–jaråŒ…æ•°æ®</span>    <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åˆ›å»ºä»“åº“å¯¹è±¡ï¼Œä»“åº“å¯¹è±¡ä¸­ä¿å­˜Droolsçš„è§„åˆ™ä¿¡æ¯</span>    <span class="token class-name">KieRepository</span> repository <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//é€šè¿‡è¾“å…¥æµè¯»å–mavenä»“åº“ä¸­çš„jaråŒ…æ•°æ®ï¼ŒåŒ…è£…æˆKieModuleæ¨¡å—æ·»åŠ åˆ°ä»“åº“ä¸­</span>    <span class="token class-name">KieModule</span> kieModule <span class="token operator">=</span>     repository<span class="token punctuation">.</span>        <span class="token function">addKieModule</span><span class="token punctuation">(</span>kieServices<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInputStreamResource</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åŸºäºKieModuleæ¨¡å—åˆ›å»ºå®¹å™¨å¯¹è±¡ï¼Œä»å®¹å™¨ä¸­å¯ä»¥è·å–sessionä¼šè¯</span>    <span class="token class-name">KieContainer</span> kieContainer <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieContainer</span><span class="token punctuation">(</span>kieModule<span class="token punctuation">.</span><span class="token function">getReleaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieSession</span> session <span class="token operator">=</span> kieContainer<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    person<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œå•å…ƒæµ‹è¯•å¯ä»¥å‘ç°æ§åˆ¶å°å·²ç»è¾“å‡ºäº†ç›¸å…³å†…å®¹ã€‚é€šè¿‡WorkBenchä¿®æ”¹è§„åˆ™è¾“å‡ºå†…å®¹å¹¶å‘å¸ƒï¼Œå†æ¬¡æ‰§è¡Œå•å…ƒæµ‹è¯•å¯ä»¥å‘ç°æ§åˆ¶å°è¾“å‡ºçš„å†…å®¹ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ã€‚</p><p><strong>é€šè¿‡ä¸Šé¢çš„æ¡ˆä¾‹å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬åœ¨IEDAä¸­å¼€å‘çš„é¡¹ç›®ä¸­å¹¶æ²¡æœ‰ç¼–å†™è§„åˆ™æ–‡ä»¶ï¼Œè§„åˆ™æ–‡ä»¶æ˜¯æˆ‘ä»¬é€šè¿‡WorkBenchå¼€å‘å¹¶å®‰è£…éƒ¨ç½²åˆ°mavenä»“åº“ä¸­ï¼Œæˆ‘ä»¬è‡ªå·±å¼€å‘çš„é¡¹ç›®åªéœ€è¦è¿œç¨‹åŠ è½½mavenä»“åº“ä¸­çš„jaråŒ…å°±å¯ä»¥å®Œæˆè§„åˆ™çš„è°ƒç”¨ã€‚è¿™ç§å¼€å‘æ–¹å¼çš„å¥½å¤„æ˜¯æˆ‘ä»¬çš„åº”ç”¨å¯ä»¥å’Œä¸šåŠ¡è§„åˆ™å®Œå…¨åˆ†ç¦»ï¼ŒåŒæ—¶é€šè¿‡WorkBenchä¿®æ”¹è§„åˆ™åæˆ‘ä»¬çš„åº”ç”¨ä¸éœ€è¦ä»»ä½•ä¿®æ”¹å°±å¯ä»¥åŠ è½½åˆ°æœ€æ–°çš„è§„åˆ™ä»è€Œå®ç°è§„åˆ™çš„åŠ¨æ€å˜æ›´ã€‚</strong></p><h2 id="9-Droolså®æˆ˜"><a href="#9-Droolså®æˆ˜" class="headerlink" title="9. Droolså®æˆ˜"></a>9. Droolså®æˆ˜</h2><h3 id="9-1-ä¸ªäººæ‰€å¾—ç¨è®¡ç®—å™¨"><a href="#9-1-ä¸ªäººæ‰€å¾—ç¨è®¡ç®—å™¨" class="headerlink" title="9.1 ä¸ªäººæ‰€å¾—ç¨è®¡ç®—å™¨"></a>9.1 ä¸ªäººæ‰€å¾—ç¨è®¡ç®—å™¨</h3><p>æœ¬å°èŠ‚æˆ‘ä»¬éœ€è¦é€šè¿‡Droolsè§„åˆ™å¼•æ“æ¥æ ¹æ®è§„åˆ™è®¡ç®—ä¸ªäººæ‰€å¾—ç¨ï¼Œæœ€ç»ˆé¡µé¢æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200214132448956.png" alt="image-20200214132448956"></p><h4 id="9-1-1-åè¯è§£é‡Š"><a href="#9-1-1-åè¯è§£é‡Š" class="headerlink" title="9.1.1 åè¯è§£é‡Š"></a>9.1.1 åè¯è§£é‡Š</h4><p>ç¨å‰æœˆæ”¶å…¥ï¼šå³ç¨å‰å·¥èµ„ï¼ŒæŒ‡äº¤çº³ä¸ªäººæ‰€å¾—ç¨ä¹‹å‰çš„æ€»å·¥èµ„</p><p>åº”çº³ç¨æ‰€å¾—é¢ï¼šæŒ‡æŒ‰ç…§ç¨æ³•è§„å®šç¡®å®šçº³ç¨äººåœ¨ä¸€å®šæœŸé—´æ‰€è·å¾—çš„æ‰€æœ‰åº”ç¨æ”¶å…¥å‡é™¤åœ¨è¯¥çº³ç¨æœŸé—´ä¾æ³•å…è®¸å‡é™¤çš„å„ç§æ”¯å‡ºåçš„ä½™é¢</p><p>ç¨ç‡ï¼šæ˜¯å¯¹å¾ç¨å¯¹è±¡çš„å¾æ”¶æ¯”ä¾‹æˆ–å¾æ”¶é¢åº¦</p><p>é€Ÿç®—æ‰£é™¤æ•°ï¼šæŒ‡ä¸ºè§£å†³è¶…é¢ç´¯è¿›ç¨ç‡åˆ†çº§è®¡ç®—ç¨é¢çš„å¤æ‚æŠ€æœ¯é—®é¢˜ï¼Œè€Œé¢„å…ˆè®¡ç®—å‡ºçš„ä¸€ä¸ªæ•°æ®ï¼Œå¯ä»¥ç®€åŒ–è®¡ç®—è¿‡ç¨‹</p><p>æ‰£ç¨é¢ï¼šæ˜¯æŒ‡å®é™…ç¼´çº³çš„ç¨é¢</p><p>ç¨åå·¥èµ„ï¼šæ˜¯æŒ‡æ‰£å®Œç¨åå®é™…åˆ°æ‰‹çš„å·¥èµ„æ”¶å…¥</p><h4 id="9-1-2-è®¡ç®—è§„åˆ™"><a href="#9-1-2-è®¡ç®—è§„åˆ™" class="headerlink" title="9.1.2 è®¡ç®—è§„åˆ™"></a>9.1.2 è®¡ç®—è§„åˆ™</h4><p>è¦å®ç°ä¸ªäººæ‰€å¾—ç¨è®¡ç®—å™¨ï¼Œéœ€è¦äº†è§£å¦‚ä¸‹è®¡ç®—è§„åˆ™ï¼šï¼ˆ2011ï¼‰</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">è®¡ç®—åº”çº³ç¨æ‰€å¾—é¢</td><td align="left">åº”çº³ç¨æ‰€å¾—é¢ä¸ºç¨å‰å·¥èµ„å‡å»3500</td></tr><tr><td align="left">2</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢&lt;&#x3D;1500</td><td align="left">ç¨ç‡ä¸º0.03ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º0</td></tr><tr><td align="left">3</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨1500è‡³4500ä¹‹é—´</td><td align="left">ç¨ç‡ä¸º0.1ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º105</td></tr><tr><td align="left">4</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨4500å¿—9000ä¹‹é—´</td><td align="left">ç¨ç‡ä¸º0.2ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º555</td></tr><tr><td align="left">5</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨9000å¿—35000ä¹‹é—´</td><td align="left">ç¨ç‡ä¸º0.25ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º1005</td></tr><tr><td align="left">6</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨35000è‡³55000ä¹‹é—´</td><td align="left">ç¨ç‡ä¸º0.3ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º2755</td></tr><tr><td align="left">7</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨55000è‡³80000ä¹‹é—´</td><td align="left">ç¨ç‡ä¸º0.35ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º5505</td></tr><tr><td align="left">8</td><td align="left">è®¾ç½®ç¨ç‡ï¼Œåº”çº³ç¨æ‰€å¾—é¢åœ¨80000ä»¥ä¸Š</td><td align="left">ç¨ç‡ä¸º0.45ï¼Œé€Ÿç®—æ‰£é™¤æ•°ä¸º13505</td></tr><tr><td align="left">9</td><td align="left">è®¡ç®—ç¨åå·¥èµ„</td><td align="left">æ‰£ç¨é¢&#x3D;åº”çº³ç¨æ‰€å¾—é¢*ç¨ç‡-é€Ÿç®—æ‰£é™¤æ•° ç¨åå·¥èµ„&#x3D;ç¨å‰å·¥èµ„-æ‰£ç¨é¢</td></tr></tbody></table><p>ç¨å‰å·¥èµ„ï¼š10000</p><p>åº”ç¼´çº³æ‰€å¾—ç¨ï¼š10000-3500 &#x3D; 6500</p><p>ç¨ç‡ï¼š0.2</p><p>é€Ÿç®—æ‰£é™¤æ•°ï¼š555</p><p>æ‰£ç¨é¢ï¼š6500 * 0.2 - 555 &#x3D; 745</p><p>ç¨åå·¥èµ„ï¼š10000 - 745 &#x3D; 9255</p><h4 id="9-1-3-å®ç°æ­¥éª¤"><a href="#9-1-3-å®ç°æ­¥éª¤" class="headerlink" title="9.1.3 å®ç°æ­¥éª¤"></a>9.1.3 å®ç°æ­¥éª¤</h4><p>æœ¬å®æˆ˜æ¡ˆä¾‹æˆ‘ä»¬åŸºäºSpring Bootæ•´åˆDroolsçš„æ–¹å¼æ¥å®ç°ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹calculationå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starters<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>cn.itcast<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>calculation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--droolsè§„åˆ™å¼•æ“--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-templates<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>$&#123;project.artifactId&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»º&#x2F;resources&#x2F;application.ymlæ–‡ä»¶</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">server:  port: 8080spring:  application:    name: calculation<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™é…ç½®ç±»DroolsConfig</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieServices</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieFileSystem</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieRepository</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieContainer</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ResourceFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnMissingBean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token comment">/** * è§„åˆ™å¼•æ“é…ç½®ç±» */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æŒ‡å®šè§„åˆ™æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> RULES_PATH <span class="token operator">=</span> <span class="token string">"rules/"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieFileSystem</span> <span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"drools.dateformat"</span><span class="token punctuation">,</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieFileSystem</span> kieFileSystem <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ResourcePatternResolver</span> resourcePatternResolver <span class="token operator">=</span>             <span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span>             resourcePatternResolver<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">"classpath*:"</span> <span class="token operator">+</span> RULES_PATH <span class="token operator">+</span> <span class="token string">"*.*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            path <span class="token operator">=</span> RULES_PATH <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            kieFileSystem<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">ResourceFactory</span><span class="token punctuation">.</span><span class="token function">newClassPathResource</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> kieFileSystem<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieContainer</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">KieRepository</span> kieRepository <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieRepository<span class="token punctuation">.</span><span class="token function">addKieModule</span><span class="token punctuation">(</span>kieRepository<span class="token operator">::</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieBuilder</span> kieBuilder <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieBuilder</span><span class="token punctuation">(</span><span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieBuilder<span class="token punctuation">.</span><span class="token function">buildAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieContainer</span><span class="token punctuation">(</span>kieRepository<span class="token punctuation">.</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieBase</span> <span class="token function">kieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span> <span class="token function">kiePostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šç¼–å†™å®ä½“ç±»Calculation</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Calculation</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> wage<span class="token punctuation">;</span><span class="token comment">//ç¨å‰å·¥èµ„</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> wagemore<span class="token punctuation">;</span><span class="token comment">//åº”çº³ç¨æ‰€å¾—é¢</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> cess<span class="token punctuation">;</span><span class="token comment">//ç¨ç‡</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> preminus<span class="token punctuation">;</span><span class="token comment">//é€Ÿç®—æ‰£é™¤æ•°</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> wageminus<span class="token punctuation">;</span><span class="token comment">//æ‰£ç¨é¢</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> actualwage<span class="token punctuation">;</span><span class="token comment">//ç¨åå·¥èµ„</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getWage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> wage<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWage</span><span class="token punctuation">(</span><span class="token keyword">double</span> wage<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>wage <span class="token operator">=</span> wage<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getActualwage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> actualwage<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setActualwage</span><span class="token punctuation">(</span><span class="token keyword">double</span> actualwage<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>actualwage <span class="token operator">=</span> actualwage<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getWagemore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> wagemore<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWagemore</span><span class="token punctuation">(</span><span class="token keyword">double</span> wagemore<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>wagemore <span class="token operator">=</span> wagemore<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getCess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> cess<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCess</span><span class="token punctuation">(</span><span class="token keyword">double</span> cess<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cess <span class="token operator">=</span> cess<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getPreminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> preminus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token keyword">double</span> preminus<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>preminus <span class="token operator">=</span> preminus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getWageminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> wageminus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWageminus</span><span class="token punctuation">(</span><span class="token keyword">double</span> wageminus<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>wageminus <span class="token operator">=</span> wageminus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"Calculation&#123;"</span> <span class="token operator">+</span>                <span class="token string">"wage="</span> <span class="token operator">+</span> wage <span class="token operator">+</span>                <span class="token string">", actualwage="</span> <span class="token operator">+</span> actualwage <span class="token operator">+</span>                <span class="token string">", wagemore="</span> <span class="token operator">+</span> wagemore <span class="token operator">+</span>                <span class="token string">", cess="</span> <span class="token operator">+</span> cess <span class="token operator">+</span>                <span class="token string">", preminus="</span> <span class="token operator">+</span> preminus <span class="token operator">+</span>                <span class="token string">", wageminus="</span> <span class="token operator">+</span> wageminus <span class="token operator">+</span>                <span class="token char">'&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šåœ¨resources&#x2F;rulesä¸‹åˆ›å»ºè§„åˆ™æ–‡ä»¶calculation.drlæ–‡ä»¶</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">calculation</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Calculation</span>rule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¡ç®—åº”çº³ç¨æ‰€å¾—é¢"</span>    enabled <span class="token boolean">true</span>    salience <span class="token number">3</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    date<span class="token operator">-</span>effective <span class="token string">"2011-09-01"</span> <span class="token comment">//ç”Ÿæ•ˆæ—¥æœŸ</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wage<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setWagemore</span><span class="token punctuation">(</span>$cal<span class="token punctuation">.</span><span class="token function">getWage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢&lt;=1500"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">&lt;=</span> <span class="token number">1500</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.03</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨1500è‡³4500ä¹‹é—´"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">1500</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">&lt;=</span> <span class="token number">4500</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">105</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨4500å¿—9000ä¹‹é—´"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">4500</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">&lt;=</span> <span class="token number">9000</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">555</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨9000å¿—35000ä¹‹é—´"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">9000</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">&lt;=</span> <span class="token number">35000</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨35000è‡³55000ä¹‹é—´"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">35000</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">&lt;=</span> <span class="token number">55000</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">2755</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨55000è‡³80000ä¹‹é—´"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">55000</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">&lt;=</span> <span class="token number">80000</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.35</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">5505</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¾ç½®ç¨ç‡-->>åº”çº³ç¨æ‰€å¾—é¢åœ¨80000ä»¥ä¸Š"</span>    salience <span class="token number">2</span>    no<span class="token operator">-</span>loop <span class="token boolean">true</span>    activation<span class="token operator">-</span>group <span class="token string">"SETCess_Group"</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wagemore <span class="token operator">></span> <span class="token number">80000</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setCess</span><span class="token punctuation">(</span><span class="token number">0.45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setPreminus</span><span class="token punctuation">(</span><span class="token number">13505</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>$cal<span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"ä¸ªäººæ‰€å¾—ç¨ï¼šè®¡ç®—ç¨åå·¥èµ„"</span>    salience <span class="token number">1</span>    when        $cal <span class="token operator">:</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span>wage <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> wagemore <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> cess <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>    then        $cal<span class="token punctuation">.</span><span class="token function">setWageminus</span><span class="token punctuation">(</span>$cal<span class="token punctuation">.</span><span class="token function">getWagemore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>$cal<span class="token punctuation">.</span><span class="token function">getCess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>$cal<span class="token punctuation">.</span><span class="token function">getPreminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $cal<span class="token punctuation">.</span><span class="token function">setActualwage</span><span class="token punctuation">(</span>$cal<span class="token punctuation">.</span><span class="token function">getWage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>$cal<span class="token punctuation">.</span><span class="token function">getWageminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----ç¨å‰å·¥èµ„ï¼š"</span><span class="token operator">+</span>$cal<span class="token punctuation">.</span><span class="token function">getWage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----åº”çº³ç¨æ‰€å¾—é¢ï¼š"</span><span class="token operator">+</span>$cal<span class="token punctuation">.</span><span class="token function">getWagemore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----ç¨ç‡ï¼š"</span> <span class="token operator">+</span> $cal<span class="token punctuation">.</span><span class="token function">getCess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----é€Ÿç®—æ‰£é™¤æ•°ï¼š"</span> <span class="token operator">+</span> $cal<span class="token punctuation">.</span><span class="token function">getPreminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----æ‰£ç¨é¢ï¼š"</span> <span class="token operator">+</span> $cal<span class="token punctuation">.</span><span class="token function">getWageminus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----ç¨åå·¥èµ„ï¼š"</span> <span class="token operator">+</span> $cal<span class="token punctuation">.</span><span class="token function">getActualwage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šåˆ›å»ºRuleService</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Calculation</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token comment">/** * è°ƒç”¨è§„åˆ™å¼•æ“ï¼Œæ‰§è¡Œè§„åˆ™ */</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuleService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">KieBase</span> kieBase<span class="token punctuation">;</span>    <span class="token comment">//ä¸ªäººæ‰€å¾—ç¨è®¡ç®—</span>    <span class="token keyword">public</span> <span class="token class-name">Calculation</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token class-name">Calculation</span> calculation<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">KieSession</span> kieSession <span class="token operator">=</span> kieBase<span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieSession<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>calculation<span class="token punctuation">)</span><span class="token punctuation">;</span>        kieSession<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieSession<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> calculation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºRuleController</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Calculation</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">RuleService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/rule"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuleController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RuleService</span> ruleService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/calculate"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Calculation</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">double</span> wage<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Calculation</span> calculation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        calculation<span class="token punctuation">.</span><span class="token function">setWage</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span><span class="token punctuation">;</span>        calculation <span class="token operator">=</span> ruleService<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span>calculation<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>calculation<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> calculation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…«æ­¥ï¼šåˆ›å»ºå¯åŠ¨ç±»DroolsApplication</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DroolsApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¹æ­¥ï¼šå¯¼å…¥é™æ€èµ„æºæ–‡ä»¶åˆ°resources&#x2F;staticç›®å½•ä¸‹</p><h3 id="9-2-ä¿¡ç”¨å¡ç”³è¯·"><a href="#9-2-ä¿¡ç”¨å¡ç”³è¯·" class="headerlink" title="9.2 ä¿¡ç”¨å¡ç”³è¯·"></a>9.2 ä¿¡ç”¨å¡ç”³è¯·</h3><p>æœ¬å°èŠ‚æˆ‘ä»¬éœ€è¦é€šè¿‡Droolsè§„åˆ™å¼•æ“æ¥æ ¹æ®è§„åˆ™è¿›è¡Œç”³è¯·äººçš„åˆæ³•æ€§æ£€æŸ¥ï¼Œæ£€æŸ¥é€šè¿‡åå†æ ¹æ®è§„åˆ™ç¡®å®šä¿¡ç”¨å¡é¢åº¦ï¼Œæœ€ç»ˆé¡µé¢æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200214202525859.png" alt="image-20200214202525859"></p><h4 id="9-2-1-è®¡ç®—è§„åˆ™"><a href="#9-2-1-è®¡ç®—è§„åˆ™" class="headerlink" title="9.2.1 è®¡ç®—è§„åˆ™"></a>9.2.1 è®¡ç®—è§„åˆ™</h4><p>åˆæ³•æ€§æ£€æŸ¥è§„åˆ™å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´1</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“ä»¥ä¸‹ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº5000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">2</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´2</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“æˆ–æœ¬ç§‘ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº3000ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">3</td><td align="left">æ£€æŸ¥å­¦å†ä¸è–ªæ°´3</td><td align="left">å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºæœ¬ç§‘ä»¥ä¸Šï¼Œå¹¶ä¸”æœˆè–ªå°‘äº2000ï¼ŒåŒæ—¶ä¹‹å‰æ²¡æœ‰ä¿¡ç”¨å¡çš„ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr><tr><td align="left">4</td><td align="left">æ£€æŸ¥ç”³è¯·äººå·²æœ‰çš„ä¿¡ç”¨å¡æ•°é‡</td><td align="left">å¦‚æœç”³è¯·äººç°æœ‰çš„ä¿¡ç”¨å¡æ•°é‡å¤§äº10ï¼Œé‚£ä¹ˆä¸é€šè¿‡</td></tr></tbody></table><p>ä¿¡ç”¨å¡é¢åº¦ç¡®å®šè§„åˆ™ï¼š</p><table><thead><tr><th align="left">è§„åˆ™ç¼–å·</th><th align="left">åç§°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">è§„åˆ™1</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æœ‰è½¦ï¼Œæˆ–è€…æœˆæ”¶å…¥åœ¨20000ä»¥ä¸Šï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º15000</td></tr><tr><td align="left">2</td><td align="left">è§„åˆ™2</td><td align="left">å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œä½†æœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º6000</td></tr><tr><td align="left">3</td><td align="left">è§„åˆ™3</td><td align="left">å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º3000</td></tr><tr><td align="left">4</td><td align="left">è§„åˆ™4</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º5000</td></tr><tr><td align="left">5</td><td align="left">è§„åˆ™5</td><td align="left">å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ˜¯æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º8000</td></tr></tbody></table><h4 id="9-2-2-å®ç°æ­¥éª¤"><a href="#9-2-2-å®ç°æ­¥éª¤" class="headerlink" title="9.2.2 å®ç°æ­¥éª¤"></a>9.2.2 å®ç°æ­¥éª¤</h4><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹creditCardApplyå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starters<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>creditCardApply<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--droolsè§„åˆ™å¼•æ“--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-templates<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>$&#123;project.artifactId&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»º&#x2F;resources&#x2F;application.ymlæ–‡ä»¶</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">server:  port: 8080spring:  application:    name: creditCardApply<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™é…ç½®ç±»DroolsConfig</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieBase</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">KieServices</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieFileSystem</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">KieRepository</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieContainer</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ResourceFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnMissingBean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token comment">/** * è§„åˆ™å¼•æ“é…ç½®ç±» */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æŒ‡å®šè§„åˆ™æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> RULES_PATH <span class="token operator">=</span> <span class="token string">"rules/"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">KieServices</span> kieServices <span class="token operator">=</span> <span class="token class-name">KieServices<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieFileSystem</span> <span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">KieFileSystem</span> kieFileSystem <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ResourcePatternResolver</span> resourcePatternResolver <span class="token operator">=</span>                <span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span>                resourcePatternResolver<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token string">"classpath*:"</span> <span class="token operator">+</span> RULES_PATH <span class="token operator">+</span> <span class="token string">"*.*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            path <span class="token operator">=</span> RULES_PATH <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            kieFileSystem<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">ResourceFactory</span><span class="token punctuation">.</span><span class="token function">newClassPathResource</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> kieFileSystem<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieContainer</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">KieRepository</span> kieRepository <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieRepository<span class="token punctuation">.</span><span class="token function">addKieModule</span><span class="token punctuation">(</span>kieRepository<span class="token operator">::</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KieBuilder</span> kieBuilder <span class="token operator">=</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieBuilder</span><span class="token punctuation">(</span><span class="token function">kieFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieBuilder<span class="token punctuation">.</span><span class="token function">buildAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> kieServices<span class="token punctuation">.</span><span class="token function">newKieContainer</span><span class="token punctuation">(</span>kieRepository<span class="token punctuation">.</span><span class="token function">getDefaultReleaseId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KieBase</span> <span class="token function">kieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">kieContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKieBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token annotation punctuation">@ConditionalOnMissingBean</span>    <span class="token keyword">public</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span> <span class="token function">kiePostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KModuleBeanFactoryPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šç¼–å†™å®ä½“ç±»CreditCardApplyInfo</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token comment">/** * ä¿¡ç”¨å¡ç”³è¯·ä¿¡æ¯ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreditCardApplyInfo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EDUCATION_1 <span class="token operator">=</span> <span class="token string">"ä¸“ç§‘ä»¥ä¸‹"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EDUCATION_2 <span class="token operator">=</span> <span class="token string">"ä¸“ç§‘"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EDUCATION_3 <span class="token operator">=</span> <span class="token string">"æœ¬ç§‘"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EDUCATION_4 <span class="token operator">=</span> <span class="token string">"æœ¬ç§‘ä»¥ä¸Š"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> education<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> telephone<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> monthlyIncome <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æœˆæ”¶å…¥</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> hasHouse <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æœ‰æˆ¿</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> hasCar <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æœ‰è½¦</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> hasCreditCardCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ç°æŒæœ‰ä¿¡ç”¨å¡æ•°é‡</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> checkResult <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//å®¡æ ¸æ˜¯å¦é€šè¿‡</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> quota <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//é¢åº¦</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token class-name">String</span> sex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> education<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEducation</span><span class="token punctuation">(</span><span class="token class-name">String</span> education<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>education <span class="token operator">=</span> education<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTelephone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> telephone<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTelephone</span><span class="token punctuation">(</span><span class="token class-name">String</span> telephone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>telephone <span class="token operator">=</span> telephone<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getMonthlyIncome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> monthlyIncome<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMonthlyIncome</span><span class="token punctuation">(</span><span class="token keyword">double</span> monthlyIncome<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>monthlyIncome <span class="token operator">=</span> monthlyIncome<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> address<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token class-name">String</span> address<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isHasHouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> hasHouse<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHasHouse</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> hasHouse<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hasHouse <span class="token operator">=</span> hasHouse<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isHasCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> hasCar<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHasCar</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> hasCar<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hasCar <span class="token operator">=</span> hasCar<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getHasCreditCardCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> hasCreditCardCount<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHasCreditCardCount</span><span class="token punctuation">(</span><span class="token keyword">int</span> hasCreditCardCount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hasCreditCardCount <span class="token operator">=</span> hasCreditCardCount<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isCheckResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> checkResult<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCheckResult</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> checkResult<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>checkResult <span class="token operator">=</span> checkResult<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getQuota</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> quota<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setQuota</span><span class="token punctuation">(</span><span class="token keyword">double</span> quota<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>quota <span class="token operator">=</span> quota<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>checkResult<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string">"å®¡æ ¸é€šè¿‡ï¼Œä¿¡ç”¨å¡é¢åº¦ä¸ºï¼š"</span> <span class="token operator">+</span> quota<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string">"å®¡æ ¸ä¸é€šè¿‡"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äº”æ­¥ï¼šåœ¨resources&#x2F;rulesä¸‹åˆ›å»ºè§„åˆ™æ–‡ä»¶creditCardApply.drlæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.creditCardApplyimport com.itheima.drools.entity.CreditCardApplyInfo&#x2F;&#x2F;åˆæ³•æ€§æ£€æŸ¥rule &quot;å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“ä»¥ä¸‹ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº5000ï¼Œé‚£ä¹ˆä¸é€šè¿‡&quot;    salience 10    no-loop true    when        $c:CreditCardApplyInfo(hasCar &#x3D;&#x3D; false &amp;&amp;                                hasHouse &#x3D;&#x3D; false &amp;&amp;                                education &#x3D;&#x3D; CreditCardApplyInfo.EDUCATION_1 &amp;&amp;                                monthlyIncome &lt; 5000)    then        $c.setCheckResult(false);        drools.halt();endrule &quot;å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºå¤§ä¸“æˆ–æœ¬ç§‘ï¼Œå¹¶ä¸”æœˆè–ªå°‘äº3000ï¼Œé‚£ä¹ˆä¸é€šè¿‡&quot;    salience 10    no-loop true    when        $c:CreditCardApplyInfo(hasCar &#x3D;&#x3D; false &amp;&amp;                                hasHouse &#x3D;&#x3D; false &amp;&amp;                                (education &#x3D;&#x3D; CreditCardApplyInfo.EDUCATION_2  ||                                education &#x3D;&#x3D; CreditCardApplyInfo.EDUCATION_3) &amp;&amp;                                monthlyIncome &lt; 3000)    then        $c.setCheckResult(false);        drools.halt();endrule &quot;å¦‚æœç”³è¯·äººæ—¢æ²¡æˆ¿ä¹Ÿæ²¡è½¦ï¼ŒåŒæ—¶å­¦å†ä¸ºæœ¬ç§‘ä»¥ä¸Šï¼Œå¹¶ä¸”æœˆè–ªå°‘äº2000ï¼ŒåŒæ—¶ä¹‹å‰æ²¡æœ‰ä¿¡ç”¨å¡çš„ï¼Œé‚£ä¹ˆä¸é€šè¿‡&quot;    salience 10    no-loop true    when        $c:CreditCardApplyInfo(hasCar &#x3D;&#x3D; false &amp;&amp;                                hasHouse &#x3D;&#x3D; false &amp;&amp;                                education &#x3D;&#x3D; CreditCardApplyInfo.EDUCATION_4 &amp;&amp;                                monthlyIncome &lt; 2000 &amp;&amp;                                hasCreditCardCount &#x3D;&#x3D; 0)    then        $c.setCheckResult(false);        drools.halt();endrule &quot;å¦‚æœç”³è¯·äººç°æœ‰çš„ä¿¡ç”¨å¡æ•°é‡å¤§äº10ï¼Œé‚£ä¹ˆä¸é€šè¿‡&quot;    salience 10    no-loop true    when        $c:CreditCardApplyInfo(hasCreditCardCount &gt; 10)    then        $c.setCheckResult(false);        drools.halt();end&#x2F;&#x2F;--------------------------------------------------------------------------&#x2F;&#x2F;ç¡®å®šé¢åº¦rule &quot;å¦‚æœç”³è¯·äººæœ‰æˆ¿æœ‰è½¦ï¼Œæˆ–è€…æœˆæ”¶å…¥åœ¨20000ä»¥ä¸Šï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º15000&quot;    salience 1    no-loop true    activation-group &quot;quota_group&quot;    when        $c:CreditCardApplyInfo(checkResult &#x3D;&#x3D; true &amp;&amp;                                ((hasHouse &#x3D;&#x3D; true &amp;&amp; hasCar &#x3D;&#x3D; true) ||                                (monthlyIncome &gt; 20000)))    then        $c.setQuota(15000);endrule &quot;å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œä½†æœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º6000&quot;    salience 1    no-loop true    activation-group &quot;quota_group&quot;    when        $c:CreditCardApplyInfo(checkResult &#x3D;&#x3D; true &amp;&amp;                                hasHouse &#x3D;&#x3D; false &amp;&amp;                                hasCar &#x3D;&#x3D; false &amp;&amp;                                monthlyIncome &gt;&#x3D; 10000 &amp;&amp;                                monthlyIncome &lt;&#x3D; 20000)    then        $c.setQuota(6000);endrule &quot;å¦‚æœç”³è¯·äººæ²¡æˆ¿æ²¡è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º3000&quot;    salience 1    no-loop true    activation-group &quot;quota_group&quot;    when        $c:CreditCardApplyInfo(checkResult &#x3D;&#x3D; true &amp;&amp;                                        hasHouse &#x3D;&#x3D; false &amp;&amp;                                        hasCar &#x3D;&#x3D; false &amp;&amp;                                        monthlyIncome &lt; 10000)    then        $c.setQuota(3000);endrule &quot;å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000ä»¥ä¸‹ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º5000&quot;    salience 1    no-loop true    activation-group &quot;quota_group&quot;    when        $c:CreditCardApplyInfo(checkResult &#x3D;&#x3D; true &amp;&amp;                                ((hasHouse &#x3D;&#x3D; true &amp;&amp; hasCar &#x3D;&#x3D; false) ||                                (hasHouse &#x3D;&#x3D; false &amp;&amp; hasCar &#x3D;&#x3D; true)) &amp;&amp;                                monthlyIncome &lt; 10000)    then        $c.setQuota(5000);endrule &quot;å¦‚æœç”³è¯·äººæœ‰æˆ¿æ²¡è½¦æˆ–è€…æ˜¯æ²¡æˆ¿ä½†æœ‰è½¦ï¼Œæœˆæ”¶å…¥åœ¨10000~20000ä¹‹é—´ï¼Œé‚£ä¹ˆå‘æ”¾çš„ä¿¡ç”¨å¡é¢åº¦ä¸º8000&quot;    salience 1    no-loop true    activation-group &quot;quota_group&quot;    when        $c:CreditCardApplyInfo(checkResult &#x3D;&#x3D; true &amp;&amp;                                ((hasHouse &#x3D;&#x3D; true &amp;&amp; hasCar &#x3D;&#x3D; false) ||                                (hasHouse &#x3D;&#x3D; false &amp;&amp; hasCar &#x3D;&#x3D; true)) &amp;&amp;                                monthlyIncome &gt;&#x3D; 10000 &amp;&amp;                                monthlyIncome &lt;&#x3D; 20000)    then        $c.setQuota(8000);end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šåˆ›å»ºRuleService</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools.service;import com.itheima.drools.entity.CreditCardApplyInfo;import org.kie.api.KieBase;import org.kie.api.runtime.KieSession;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Servicepublic class RuleService &#123;    @Autowired    private KieBase kieBase;    &#x2F;&#x2F;è°ƒç”¨Droolsè§„åˆ™å¼•æ“å®ç°ä¿¡ç”¨å¡ç”³è¯·    public CreditCardApplyInfo creditCardApply(CreditCardApplyInfo creditCardApplyInfo)&#123;        KieSession session &#x3D; kieBase.newKieSession();        session.insert(creditCardApplyInfo);        session.fireAllRules();        session.dispose();        return creditCardApplyInfo;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºRuleController</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools.controller;import com.itheima.drools.entity.CreditCardApplyInfo;import com.itheima.drools.service.RuleService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(&quot;&#x2F;rule&quot;)public class RuleController &#123;    @Autowired    private RuleService ruleService;    @RequestMapping(&quot;&#x2F;creditCardApply&quot;)    public CreditCardApplyInfo creditCardApply(@RequestBody         CreditCardApplyInfo creditCardApplyInfo)&#123;        creditCardApplyInfo &#x3D; ruleService.creditCardApply(creditCardApplyInfo);        return creditCardApplyInfo;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…«æ­¥ï¼šåˆ›å»ºå¯åŠ¨ç±»DroolsApplication</p><pre class="line-numbers language-none"><code class="language-none">package com.itheima.drools;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class DroolsApplication &#123;    public static void main(String[] args) &#123;        SpringApplication.run(DroolsApplication.class);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¹æ­¥ï¼šå¯¼å…¥é™æ€èµ„æºæ–‡ä»¶åˆ°resources&#x2F;staticç›®å½•ä¸‹</p><h3 id="9-3-ä¿é™©äº§å“å‡†å…¥è§„åˆ™-å­¦åˆ°å†³ç­–è¡¨è¿™é‡Œ-é«˜çº§éƒ¨åˆ†è·³è¿‡"><a href="#9-3-ä¿é™©äº§å“å‡†å…¥è§„åˆ™-å­¦åˆ°å†³ç­–è¡¨è¿™é‡Œ-é«˜çº§éƒ¨åˆ†è·³è¿‡" class="headerlink" title="9.3 ä¿é™©äº§å“å‡†å…¥è§„åˆ™  (å­¦åˆ°å†³ç­–è¡¨è¿™é‡Œ é«˜çº§éƒ¨åˆ†è·³è¿‡)"></a>9.3 ä¿é™©äº§å“å‡†å…¥è§„åˆ™  (å­¦åˆ°å†³ç­–è¡¨è¿™é‡Œ é«˜çº§éƒ¨åˆ†è·³è¿‡)</h3><h4 id="9-3-1-å†³ç­–è¡¨"><a href="#9-3-1-å†³ç­–è¡¨" class="headerlink" title="9.3.1 å†³ç­–è¡¨"></a>9.3.1 å†³ç­–è¡¨</h4><p>å‰é¢çš„è¯¾ç¨‹ä¸­æˆ‘ä»¬ç¼–å†™çš„è§„åˆ™æ–‡ä»¶éƒ½æ˜¯drlå½¢å¼çš„æ–‡ä»¶ï¼ŒDroolsé™¤äº†æ”¯æŒdrlå½¢å¼çš„æ–‡ä»¶å¤–è¿˜æ”¯æŒxlsæ ¼å¼çš„æ–‡ä»¶ï¼ˆå³Excelæ–‡ä»¶ï¼‰ã€‚è¿™ç§xlsæ ¼å¼çš„æ–‡ä»¶é€šå¸¸ç§°ä¸ºå†³ç­–è¡¨ï¼ˆdecision tableï¼‰ã€‚</p><p>å†³ç­–è¡¨ï¼ˆdecision tableï¼‰æ˜¯ä¸€ä¸ªâ€œç²¾ç¡®è€Œç´§å‡‘çš„â€è¡¨ç¤ºæ¡ä»¶é€»è¾‘çš„æ–¹å¼ï¼Œéå¸¸é€‚åˆå•†ä¸šçº§åˆ«çš„è§„åˆ™ã€‚å†³ç­–è¡¨ä¸ç°æœ‰çš„drlæ–‡ä»¶å¯ä»¥æ— ç¼æ›¿æ¢ã€‚Droolsæä¾›äº†ç›¸åº”çš„APIå¯ä»¥å°†xlsæ–‡ä»¶ç¼–è¯‘ä¸ºdrlæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p><p>ä¸€ä¸ªå†³ç­–è¡¨çš„ä¾‹å­å¦‚ä¸‹ï¼š</p><p><img src="/media/pictures/Drools.assets/image-20200217160930138.png" alt="image-20200217160930138"></p><p>å†³ç­–è¡¨è¯­æ³•ï¼š</p><table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">è¯´æ˜</th><th align="left">æ˜¯å¦å¿…é¡»</th></tr></thead><tbody><tr><td align="left">RuleSet</td><td align="left">ç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„package</td><td align="left">å¿…é¡»ï¼Œåªèƒ½æœ‰ä¸€ä¸ªã€‚å¦‚æœæ²¡æœ‰è®¾ç½®RuleSetå¯¹åº”çš„å€¼åˆ™ä½¿ç”¨é»˜è®¤å€¼rule_table</td></tr><tr><td align="left">Sequential</td><td align="left">å–å€¼ä¸ºBooleanç±»å‹ã€‚trueè¡¨ç¤ºè§„åˆ™æŒ‰ç…§è¡¨æ ¼è‡ªä¸Šåˆ°ä¸‹çš„é¡ºåºæ‰§è¡Œï¼Œfalseè¡¨ç¤ºä¹±åº</td><td align="left">å¯é€‰</td></tr><tr><td align="left">Import</td><td align="left">ç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„importï¼Œå¦‚æœå¼•å…¥å¤šä¸ªç±»åˆ™ç±»ä¹‹é—´ç”¨é€—å·åˆ†éš”</td><td align="left">å¯é€‰</td></tr><tr><td align="left">Variables</td><td align="left">ç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„globalï¼Œç”¨äºå®šä¹‰å…¨å±€å˜é‡ï¼Œå¦‚æœæœ‰å¤šä¸ªå…¨å±€å˜é‡åˆ™ä¸­é—´ç”¨é€—å·åˆ†éš”</td><td align="left">å¯é€‰</td></tr><tr><td align="left">RuleTable</td><td align="left">å®ƒæŒ‡ç¤ºäº†åé¢å°†ä¼šæœ‰ä¸€æ‰¹ruleï¼ŒRuleTableçš„åç§°å°†ä¼šä½œä¸ºä»¥åç”Ÿæˆruleçš„å‰ç¼€</td><td align="left">å¿…é¡»</td></tr><tr><td align="left">CONDITION</td><td align="left">è§„åˆ™æ¡ä»¶å…³é”®å­—ï¼Œç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„whenã€‚ä¸‹é¢ä¸¤è¡Œåˆ™è¡¨ç¤º LHS éƒ¨åˆ†ï¼Œç¬¬ä¸‰è¡Œåˆ™ä¸ºæ³¨é‡Šè¡Œï¼Œä¸è®¡ä¸ºè§„åˆ™éƒ¨åˆ†ï¼Œä»ç¬¬å››è¡Œå¼€å§‹ï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºä¸€æ¡è§„åˆ™</td><td align="left">æ¯ä¸ªè§„åˆ™è¡¨è‡³å°‘æœ‰ä¸€ä¸ª</td></tr><tr><td align="left">ACTION</td><td align="left">è§„åˆ™ç»“æœå…³é”®å­—ï¼Œç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„then</td><td align="left">æ¯ä¸ªè§„åˆ™è¡¨è‡³å°‘æœ‰ä¸€ä¸ª</td></tr><tr><td align="left">NO-LOOP</td><td align="left">ç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„no-loop</td><td align="left">å¯é€‰</td></tr><tr><td align="left">AGENDA-GROUP</td><td align="left">ç›¸å½“äºdrlæ–‡ä»¶ä¸­çš„agenda-group</td><td align="left">å¯é€‰</td></tr></tbody></table><p>åœ¨å†³ç­–è¡¨ä¸­è¿˜ç»å¸¸ä½¿ç”¨åˆ°å ä½ç¬¦ï¼Œè¯­æ³•ä¸º$åé¢åŠ æ•°å­—ï¼Œç”¨äºæ›¿æ¢æ¯æ¡è§„åˆ™ä¸­è®¾ç½®çš„å…·ä½“å€¼ã€‚</p><p>ä¸Šé¢çš„å†³ç­–è¡¨ä¾‹å­è½¬æ¢ä¸ºdrlæ ¼å¼çš„è§„åˆ™æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">rules</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">PersonInfoEntity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>global <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>List</span> listRules<span class="token punctuation">;</span>rule <span class="token string">"personCheck_10"</span>    salience <span class="token number">65535</span>    agenda<span class="token operator">-</span>group <span class="token string">"sign"</span>    when        $person <span class="token operator">:</span> <span class="token class-name">PersonInfoEntity</span><span class="token punctuation">(</span>sex <span class="token operator">!=</span> <span class="token string">"ç”·"</span><span class="token punctuation">)</span>    then        listRules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"æ€§åˆ«ä¸å¯¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"personCheck_11"</span>    salience <span class="token number">65534</span>    agenda<span class="token operator">-</span>group <span class="token string">"sign"</span>    when        $person <span class="token operator">:</span> <span class="token class-name">PersonInfoEntity</span><span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">22</span> <span class="token operator">||</span> age <span class="token operator">></span> <span class="token number">25</span><span class="token punctuation">)</span>    then        listRules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"å¹´é¾„ä¸åˆé€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>endrule <span class="token string">"personCheck_12"</span>    salience <span class="token number">65533</span>    agenda<span class="token operator">-</span>group <span class="token string">"sign"</span>    when        $person <span class="token operator">:</span> <span class="token class-name">PersonInfoEntity</span><span class="token punctuation">(</span>salary <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">)</span>    then        listRules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"å·¥èµ„å¤ªä½äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦è¿›è¡Œå†³ç­–è¡¨ç›¸å…³æ“ä½œï¼Œéœ€è¦å¯¼å…¥å¦‚ä¸‹mavenåæ ‡ï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-decisiontables<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.10.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸‹å›¾å¯ä»¥å‘ç°ï¼Œç”±äºmavençš„ä¾èµ–ä¼ é€’ç‰¹æ€§åœ¨å¯¼å…¥drools-decisiontablesåæ ‡åï¼Œdrools-coreå’Œdrools-compilerç­‰åæ ‡ä¹Ÿè¢«ä¼ é€’äº†è¿‡æ¥</p><p><img src="/media/pictures/Drools.assets/image-20200218105819932.png" alt="image-20200218105819932"></p><p>Droolsæä¾›çš„å°†xlsæ–‡ä»¶ç¼–è¯‘ä¸ºdrlæ ¼å¼å­—ç¬¦ä¸²çš„APIå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> realPath <span class="token operator">=</span> <span class="token string">"C:\\testRule.xls"</span><span class="token punctuation">;</span><span class="token comment">//æŒ‡å®šå†³ç­–è¡¨xlsæ–‡ä»¶çš„ç£ç›˜è·¯å¾„</span><span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">SpreadsheetCompiler</span> compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpreadsheetCompiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> drl <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token class-name">InputType</span><span class="token punctuation">.</span>XLS<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Droolsè¿˜æä¾›äº†åŸºäºdrlæ ¼å¼å­—ç¬¦ä¸²åˆ›å»ºKieSessionçš„APIï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">KieHelper</span> kieHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KieHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>kieHelper<span class="token punctuation">.</span><span class="token function">addContent</span><span class="token punctuation">(</span>drl<span class="token punctuation">,</span> <span class="token class-name">ResourceType</span><span class="token punctuation">.</span>DRL<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">KieSession</span> session <span class="token operator">=</span> kieHelper<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åŸºäºå†³ç­–è¡¨çš„å…¥é—¨æ¡ˆä¾‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹drools_decisiontable_demoå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-decisiontables<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.10.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå®ä½“ç±»PersonInfoEntity</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonInfoEntity</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token class-name">String</span> sex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> salary<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> salary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºxlsè§„åˆ™æ–‡ä»¶ï¼ˆå¯ä»¥ç›´æ¥ä½¿ç”¨èµ„æ–™ä¸­æä¾›çš„testRule.xlsæ–‡ä»¶ï¼‰</p><p>ç¬¬å››æ­¥ï¼šåˆ›å»ºå•å…ƒæµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> realPath <span class="token operator">=</span> <span class="token string">"d:\\testRule.xls"</span><span class="token punctuation">;</span><span class="token comment">//æŒ‡å®šå†³ç­–è¡¨xlsæ–‡ä»¶çš„ç£ç›˜è·¯å¾„</span>    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">SpreadsheetCompiler</span> compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpreadsheetCompiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> drl <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token class-name">InputType</span><span class="token punctuation">.</span>XLS<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>drl<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieHelper</span> kieHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KieHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    kieHelper<span class="token punctuation">.</span><span class="token function">addContent</span><span class="token punctuation">(</span>drl<span class="token punctuation">,</span> <span class="token class-name">ResourceType</span><span class="token punctuation">.</span>DRL<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">KieSession</span> session <span class="token operator">=</span> kieHelper<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">PersonInfoEntity</span> personInfoEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PersonInfoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    personInfoEntity<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span><span class="token string">"ç”·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    personInfoEntity<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    personInfoEntity<span class="token punctuation">.</span><span class="token function">setSalary</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">setGlobal</span><span class="token punctuation">(</span><span class="token string">"listRules"</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>    session<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>personInfoEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">getAgenda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAgendaGroup</span><span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    session<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-3-2-è§„åˆ™ä»‹ç»"><a href="#9-3-2-è§„åˆ™ä»‹ç»" class="headerlink" title="9.3.2 è§„åˆ™ä»‹ç»"></a>9.3.2 è§„åˆ™ä»‹ç»</h4><p>å„ä¿é™©å…¬å¸é’ˆå¯¹äººèº«ã€è´¢äº§æ¨å‡ºäº†ä¸åŒçš„ä¿é™©äº§å“ï¼Œä½œä¸ºå•†ä¸šä¿é™©å…¬å¸ï¼Œç­›é€‰å‡ºç¬¦åˆå…¬å¸åˆ©ç›Šæœ€å¤§åŒ–çš„å®¢æˆ·æ˜¯éå¸¸é‡è¦çš„ï¼Œå³å„ä¿é™©äº§å“çš„å‡†å…¥äººç¾¤æ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¿é™©å…¬å¸ä¼šé’ˆå¯¹ä¸åŒçš„äººç¾¤ç‰¹å¾ï¼Œåˆ¶å®šä¸åŒçš„äº§å“ç¼´è´¹å’Œèµ”ä»˜è§„åˆ™ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æŸä¿é™©äº§å“å‡†å…¥è§„åˆ™çš„ç®€åŒ–ç‰ˆï¼Œå½“ä¸æ»¡è¶³ä»¥ä¸‹è§„åˆ™æ—¶ï¼Œç³»ç»Ÿæ¨¡å—éœ€è¦è¿”å›å‡†å…¥å¤±è´¥æ ‡è¯†å’Œå¤±è´¥åŸå› </p><pre class="line-numbers language-none"><code class="language-none">è§„åˆ™1ï¼š  ä¿é™©å…¬å¸æ˜¯ï¼šPICCè§„åˆ™2ï¼š  é”€å”®åŒºåŸŸæ˜¯ï¼šåŒ—äº¬ã€å¤©æ´¥è§„åˆ™3ï¼š  æŠ•ä¿äººå¹´é¾„ï¼š0 ~ 17å²è§„åˆ™4ï¼š  ä¿é™©æœŸé—´æ˜¯ï¼š20å¹´ã€25å¹´ã€30å¹´è§„åˆ™5ï¼š  ç¼´è´¹æ–¹å¼æ˜¯ï¼šè¶¸äº¤ï¼ˆä¸€æ¬¡æ€§äº¤æ¸…ï¼‰æˆ–å¹´äº¤è§„åˆ™6ï¼š  ä¿é™©æœŸä¸äº¤è´¹æœŸè§„åˆ™ä¸€ï¼šä¿é™©æœŸé—´ä¸º20å¹´æœŸäº¤è´¹æœŸé—´æœ€é•¿10å¹´äº¤ä¸”ä¸èƒ½é€‰æ‹©[è¶¸äº¤]è§„åˆ™7ï¼š  ä¿é™©æœŸä¸äº¤è´¹æœŸè§„åˆ™äºŒï¼šä¿é™©æœŸé—´ä¸º25å¹´æœŸäº¤è´¹æœŸé—´æœ€é•¿15å¹´äº¤ä¸”ä¸èƒ½é€‰æ‹©[è¶¸äº¤]è§„åˆ™8ï¼š  ä¿é™©æœŸä¸äº¤è´¹æœŸè§„åˆ™ä¸‰ï¼šä¿é™©æœŸé—´ä¸º30å¹´æœŸäº¤è´¹æœŸé—´æœ€é•¿20å¹´äº¤ä¸”ä¸èƒ½é€‰æ‹©[è¶¸äº¤]è§„åˆ™9ï¼š  è¢«ä¿äººè¦æ±‚ï¼šï¼ˆæŠ•ä¿å¹´é¾„+ä¿é™©æœŸé—´ï¼‰ä¸å¾—å¤§äº40å‘¨å²è§„åˆ™10ï¼š ä¿é™©é‡‘é¢è§„åˆ™ï¼šæŠ•ä¿æ—¶çº¦å®šï¼Œæœ€ä½ä¸º5ä¸‡å…ƒï¼Œè¶…è¿‡éƒ¨åˆ†å¿…é¡»ä¸º1000å…ƒçš„æ•´æ•°å€è§„åˆ™11ï¼š å‡ºå•åŸºæœ¬ä¿é¢é™é¢è§„åˆ™ï¼šçº¿ä¸Šå‡ºå•åŸºæœ¬ä¿é¢é™é¢62.5ä¸‡å…ƒï¼Œè¶…62.5ä¸‡å…ƒéœ€é…åˆå¥‘è°ƒè½¬çº¿ä¸‹å‡ºå•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æœ¬æ¡ˆä¾‹ä¸­è§„åˆ™æ–‡ä»¶æ˜¯ä¸€ä¸ªExcelæ–‡ä»¶ï¼Œä¸šåŠ¡äººå‘˜å¯ä»¥ç›´æ¥æ›´æ”¹è¿™ä¸ªæ–‡ä»¶ä¸­æŒ‡æ ‡çš„å€¼ï¼Œç³»ç»Ÿä¸éœ€è¦åšä»»ä½•å˜æ›´ã€‚</p><h4 id="9-3-3-å®ç°æ­¥éª¤"><a href="#9-3-3-å®ç°æ­¥éª¤" class="headerlink" title="9.3.3 å®ç°æ­¥éª¤"></a>9.3.3 å®ç°æ­¥éª¤</h4><p>æœ¬æ¡ˆä¾‹è¿˜æ˜¯åŸºäºSpring Bootæ•´åˆDroolsçš„æ¶æ„æ¥å®ç°ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºmavenå·¥ç¨‹insuranceInfoCheckå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0                              http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starters<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>insuranceInfoCheck<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>commons-lang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--droolsè§„åˆ™å¼•æ“--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-compiler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.drools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>drools-templates<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.kie<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>kie-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-tx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-beans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>7.6.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>$&#123;project.artifactId&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼šåˆ›å»º&#x2F;resources&#x2F;application.ymlæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">server:  port: 8080spring:  application:    name: insuranceInfoCheck<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå®ä½“ç±»InsuranceInfo</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span><span class="token comment">/** * ä¿é™©ä¿¡æ¯ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InsuranceInfo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param1<span class="token punctuation">;</span><span class="token comment">//ä¿é™©å…¬å¸</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param2<span class="token punctuation">;</span><span class="token comment">//æ–¹æ¡ˆä»£ç </span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param3<span class="token punctuation">;</span><span class="token comment">//æ¸ é“å·</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param4<span class="token punctuation">;</span><span class="token comment">//é”€å”®åŒºåŸŸ</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param5<span class="token punctuation">;</span><span class="token comment">//æŠ•ä¿å¹´é¾„</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param6<span class="token punctuation">;</span><span class="token comment">//ä¿é™©æœŸé—´</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param7<span class="token punctuation">;</span><span class="token comment">//ç¼´è´¹æœŸé—´</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param8<span class="token punctuation">;</span><span class="token comment">//ç¼´è´¹æ–¹å¼</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param9<span class="token punctuation">;</span><span class="token comment">//ä¿éšœç±»å‹</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param10<span class="token punctuation">;</span><span class="token comment">//ç­‰å¾…æœŸ</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param11<span class="token punctuation">;</span><span class="token comment">//çŠ¹è±«æœŸ</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param12<span class="token punctuation">;</span><span class="token comment">//èŒä¸šç±»å‹</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param13<span class="token punctuation">;</span><span class="token comment">//ä¿é¢é™åˆ¶</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param14<span class="token punctuation">;</span><span class="token comment">//å…èµ”é¢</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param15<span class="token punctuation">;</span><span class="token comment">//ä¸»é™©ä¿é¢</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param16<span class="token punctuation">;</span><span class="token comment">//ä¸»é™©ä¿è´¹</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param17<span class="token punctuation">;</span><span class="token comment">//é™„åŠ é™©ä¿é¢</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param18<span class="token punctuation">;</span><span class="token comment">//é™„åŠ é™©ä¿è´¹</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param19<span class="token punctuation">;</span><span class="token comment">//ä¸æŠ•ä¿äººå…³ç³»</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param20<span class="token punctuation">;</span><span class="token comment">//ä¸è¢«ä¿äººå…³ç³»</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param21<span class="token punctuation">;</span><span class="token comment">//æ€§åˆ«</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param22<span class="token punctuation">;</span><span class="token comment">//è¯ä»¶</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param23<span class="token punctuation">;</span><span class="token comment">//ä¿è´¹</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> param24<span class="token punctuation">;</span><span class="token comment">//ä¿é¢</span>    <span class="token comment">//getter setterçœç•¥</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å››æ­¥ï¼šåˆ›å»ºå†³ç­–è¡¨æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®æˆ˜èµ„æ–™ä¸­æä¾›çš„insuranceInfoCheck.xlsæ–‡ä»¶ï¼‰</p><p><img src="/media/pictures/Drools.assets/image-20200218120618384.png" alt="image-20200218120618384"></p><p>ç¬¬äº”æ­¥ï¼šå°è£…å·¥å…·ç±»KieSessionUtils</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">InsuranceInfo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">PersonInfoEntity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>decisiontable<span class="token punctuation">.</span></span><span class="token class-name">InputType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>decisiontable<span class="token punctuation">.</span></span><span class="token class-name">SpreadsheetCompiler</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">Message</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">Results</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ResourceType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">KieHelper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileNotFoundException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KieSessionUtils</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">KieSessionUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// æŠŠxlsæ–‡ä»¶è§£æä¸ºString</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> getDRL <span class="token punctuation">(</span><span class="token class-name">String</span> realPath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¾‹å¦‚ï¼šC:\\abc.xls</span>        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SpreadsheetCompiler</span> compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpreadsheetCompiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> drl <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token class-name">InputType</span><span class="token punctuation">.</span>XLS<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>drl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> drl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// drlä¸ºå«æœ‰å†…å®¹çš„å­—ç¬¦ä¸²</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">KieSession</span> <span class="token function">createKieSessionFromDRL</span><span class="token punctuation">(</span><span class="token class-name">String</span> drl<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        <span class="token class-name">KieHelper</span> kieHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KieHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        kieHelper<span class="token punctuation">.</span><span class="token function">addContent</span><span class="token punctuation">(</span>drl<span class="token punctuation">,</span> <span class="token class-name">ResourceType</span><span class="token punctuation">.</span>DRL<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Results</span> results <span class="token operator">=</span> kieHelper<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token function">hasMessages</span><span class="token punctuation">(</span><span class="token class-name">Message<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span>WARNING<span class="token punctuation">,</span> <span class="token class-name">Message<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span>ERROR<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">></span></span> messages <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">getMessages</span><span class="token punctuation">(</span><span class="token class-name">Message<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span>WARNING<span class="token punctuation">,</span> <span class="token class-name">Message<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span>ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Message</span> message <span class="token operator">:</span> messages<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Error: "</span><span class="token operator">+</span>message<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// throw new IllegalStateException("Compilation errors were found. Check the logs.");</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> kieHelper<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newKieSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// realPathä¸ºExcelæ–‡ä»¶ç»å¯¹è·¯å¾„</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">KieSession</span> <span class="token function">getKieSessionFromXLS</span><span class="token punctuation">(</span><span class="token class-name">String</span> realPath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">createKieSessionFromDRL</span><span class="token punctuation">(</span><span class="token function">getDRL</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…­æ­¥ï¼šåˆ›å»ºRuleServiceç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">InsuranceInfo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">KieSessionUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>kie<span class="token punctuation">.</span>api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">KieSession</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuleService</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">insuranceInfoCheck</span><span class="token punctuation">(</span><span class="token class-name">InsuranceInfo</span> insuranceInfo<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        <span class="token class-name">KieSession</span> session <span class="token operator">=</span> <span class="token class-name">KieSessionUtils</span><span class="token punctuation">.</span><span class="token function">getKieSessionFromXLS</span><span class="token punctuation">(</span><span class="token string">"D:\\rules.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">getAgenda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAgendaGroup</span><span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>insuranceInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> listRules <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">setGlobal</span><span class="token punctuation">(</span><span class="token string">"listRules"</span><span class="token punctuation">,</span> listRules<span class="token punctuation">)</span><span class="token punctuation">;</span>        session<span class="token punctuation">.</span><span class="token function">fireAllRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> listRules<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºRuleControllerç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">InsuranceInfo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">RuleService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/rule"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuleController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RuleService</span> ruleService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/insuranceInfoCheck"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Map</span> <span class="token function">insuranceInfoCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”ä¸ºé¡µé¢ä¼ é€’è¿‡æ¥</span>        <span class="token class-name">InsuranceInfo</span> insuranceInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InsuranceInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam1</span><span class="token punctuation">(</span><span class="token string">"picc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam4</span><span class="token punctuation">(</span><span class="token string">"ä¸Šæµ·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam5</span><span class="token punctuation">(</span><span class="token string">"101"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam6</span><span class="token punctuation">(</span><span class="token string">"12"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam7</span><span class="token punctuation">(</span><span class="token string">"222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam8</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        insuranceInfo<span class="token punctuation">.</span><span class="token function">setParam13</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> ruleService<span class="token punctuation">.</span><span class="token function">insuranceInfoCheck</span><span class="token punctuation">(</span>insuranceInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>list <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"checkResult"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span><span class="token string">"å‡†å…¥å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"detail"</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"checkResult"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span><span class="token string">"å‡†å…¥æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> map<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"checkResult"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span><span class="token string">"æœªçŸ¥é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> map<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬å…«æ­¥ï¼šåˆ›å»ºå¯åŠ¨ç±»DroolsApplication</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>drools</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DroolsApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DroolsApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Drools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLæ•°æ®åº“ä½¿ç”¨è§„èŒƒ</title>
      <link href="/2022/01/17/mysql-shu-ju-ku-shi-yong-gui-fan/"/>
      <url>/2022/01/17/mysql-shu-ju-ku-shi-yong-gui-fan/</url>
      
        <content type="html"><![CDATA[<p>æ ¹æ®åŸå…¬å¸è§„èŒƒã€é˜¿é‡Œå·´å·´JAVAè§„èŒƒã€58åˆ°å®¶MySQLå†›è§„åˆæˆ</p><h3 id="MySQLæ•°æ®åº“ä½¿ç”¨è§„èŒƒ"><a href="#MySQLæ•°æ®åº“ä½¿ç”¨è§„èŒƒ" class="headerlink" title="MySQLæ•°æ®åº“ä½¿ç”¨è§„èŒƒ"></a>MySQLæ•°æ®åº“ä½¿ç”¨è§„èŒƒ</h3><h4 id="ä¸€ã€å»ºè¡¨è§„çº¦"><a href="#ä¸€ã€å»ºè¡¨è§„çº¦" class="headerlink" title="ä¸€ã€å»ºè¡¨è§„çº¦"></a>ä¸€ã€å»ºè¡¨è§„çº¦</h4><ol><li>ã€å¼ºåˆ¶ã€‘æ•°æ®åº“åã€è¡¨åã€å­—æ®µåç»Ÿä¸€ä½¿ç”¨å°å†™ï¼Œå¤šå•è¯ç»Ÿä¸€ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å‰²<br> è¯´æ˜ï¼šè¡¨åå¤§å°å†™æ˜¯å¦æ•æ„Ÿå¯ä¿®æ”¹æ•°æ®åº“å‚æ•°lower_case_table_namesæ§åˆ¶ï¼Œä½†å»ºè®®æ•°æ®åº“å»ºå¥½åæ­¤ç±»å‚æ•°ä¸å¯å˜æ›´</li><li>ã€å¼ºåˆ¶ã€‘è¡¨è¾¾æ˜¯ä¸å¦æ¦‚å¿µçš„å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨ is_xxx çš„æ–¹å¼å‘½åï¼Œæ•°æ®ç±»å‹æ˜¯ unsigned tinyintï¼ˆ1 è¡¨ç¤ºæ˜¯ï¼Œ0 è¡¨ç¤ºå¦ï¼‰</li><li>ã€å¼ºåˆ¶ã€‘ç¦ç”¨ä¿ç•™å­—ï¼Œå¦‚ descã€rangeã€matchã€delayed ç­‰ï¼Œè¯·å‚è€ƒ MySQL å®˜æ–¹ä¿ç•™å­—</li><li>ã€å¼ºåˆ¶ã€‘ä¸»é”®ç´¢å¼•åä¸º<code> pk_å­—æ®µå</code>ï¼›å”¯ä¸€ç´¢å¼•åä¸º <code>uk_å­—æ®µå</code>ï¼›æ™®é€šç´¢å¼•ååˆ™ä¸º<code> idx_å­—æ®µå</code></li><li>ã€å¼ºåˆ¶ã€‘å°æ•°ç±»å‹ä¸º decimalï¼Œç¦æ­¢ä½¿ç”¨ float å’Œ double<br> è¯´æ˜ï¼šåœ¨å­˜å‚¨çš„æ—¶å€™ï¼Œfloat å’Œ double éƒ½å­˜åœ¨ç²¾åº¦æŸå¤±çš„é—®é¢˜ï¼Œå¾ˆå¯èƒ½åœ¨æ¯”è¾ƒå€¼çš„æ—¶å€™ï¼Œå¾—åˆ°ä¸æ­£ç¡®çš„ç»“æœã€‚å¦‚æœå­˜å‚¨çš„æ•°æ®èŒƒå›´è¶…è¿‡ decimal çš„èŒƒå›´ï¼Œå»ºè®®å°†æ•°æ®æ‹†æˆæ•´æ•°å’Œå°æ•°å¹¶åˆ†å¼€å­˜å‚¨</li><li>ã€å¼ºåˆ¶ã€‘å¦‚æœå­˜å‚¨çš„å­—ç¬¦ä¸²é•¿åº¦èƒ½å¤Ÿç¡®å®šå®Œå…¨ç›¸ç­‰ï¼Œä½¿ç”¨ char å®šé•¿å­—ç¬¦ä¸²ç±»å‹</li><li>ã€å¼ºåˆ¶ã€‘varchar æ˜¯å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œä¸é¢„å…ˆåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œé•¿åº¦ä¸è¦è¶…è¿‡ 5000ï¼Œå¦‚æœå­˜å‚¨é•¿åº¦å¤§äºæ­¤å€¼ï¼Œå®šä¹‰å­—æ®µç±»å‹ä¸º textï¼Œç‹¬ç«‹å‡ºæ¥ä¸€å¼ è¡¨ï¼Œç”¨ä¸»é”®æ¥å¯¹åº”ï¼Œé¿å…å½±å“å…¶å®ƒå­—æ®µç´¢å¼•æ•ˆç‡</li><li>ã€å¯é€‰ã€‘è¡¨å¿…å¤‡ä¸‰å­—æ®µï¼šid, create_time, update_time<br> è¯´æ˜ï¼šå…¶ä¸­ id å¿…ä¸ºä¸»é”®ï¼Œå•è¡¨æ—¶è‡ªå¢ã€æ­¥é•¿ä¸º 1ã€‚create_time, update_timeçš„ç±»å‹å‡ä¸º datetime ç±»å‹ï¼Œå‰è€…ç°åœ¨æ—¶è¡¨ç¤ºä¸»åŠ¨å¼åˆ›å»ºï¼Œåè€…è¿‡å»åˆ†è¯è¡¨ç¤ºè¢«åŠ¨å¼æ›´æ–°</li><li>ã€å¯é€‰ã€‘å°½é‡é¿å…ä½¿ç”¨timestampï¼Œtimestampæ•°æ®æœ€å¤§å€¼åŒ—äº¬æ—¶é—´2038-01-19 11:14:07</li><li>ã€å¼ºåˆ¶ã€‘ä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µå®šä¹‰ä¸ºON UPDATE CURRENT_TIMESTAMP<br>è¯´æ˜ï¼šMySQL 5.6ä¹‹å‰ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€åˆ—è‡ªåŠ¨æ›´æ–°æ—¶é—´åˆ—ï¼›5.7ä»¥åæ”¯æŒå¤šåˆ—ï¼Œä½†å¦‚æœå®šä¹‰äº†å¤šåˆ—ï¼Œåªæœ‰æœ€å‰é¢çš„é‚£ä¸€åˆ—æ‰ä¼šè‡ªåŠ¨æ›´æ–°æ—¶é—´</li><li>ã€å¯é€‰ã€‘è¡¨ä¸­ä¸šåŠ¡å­—æ®µå°½é‡ä¸è¦ç”¨timestampï¼Œå¯ç”¨datetimeä»£æ›¿ï¼ŒåŸå› è§ç¬¬9ç‚¹</li><li>ã€æ¨èã€‘è¡¨çš„å‘½åæœ€å¥½æ˜¯éµå¾ª<code>ä¸šåŠ¡åç§°_è¡¨çš„ä½œç”¨</code></li><li>ã€æ¨èã€‘å•è¡¨è¡Œæ•°è¶…è¿‡ 500 ä¸‡è¡Œæˆ–è€…å•è¡¨å®¹é‡è¶…è¿‡ 2GBï¼Œæ‰æ¨èè¿›è¡Œåˆ†åº“åˆ†è¡¨</li><li>ã€æ¨èã€‘å»ºåº“ã€å»ºè¡¨å­—ç¬¦ç¼–ç å°½é‡ä½¿ç”¨utf8mb4</li><li>ã€å¼ºåˆ¶ã€‘ä¸´æ—¶è¡¨å¿…é¡»ä»¥<code>tmp_</code>å¼€å¤´ã€ä»¥æ—¥æœŸç»“å°¾ï¼Œå¤‡ä»½è¡¨å¿…é¡»ä»¥<code>bak_</code>å¼€å¤´ã€ä»¥æ—¥æœŸç»“å°¾</li><li>ã€å¼ºåˆ¶ã€‘é¿å…ä½¿ç”¨ENUMç±»å‹<br>è¯´æ˜ï¼šä¿®æ”¹ENUMå€¼éœ€è¦ä½¿ç”¨ALTERè¯­å¥ï¼›ENUMç±»å‹çš„ORDER BYæ“ä½œæ•ˆç‡ä½ï¼Œéœ€è¦é¢å¤–æ“ä½œ</li></ol><h4 id="äºŒã€ç´¢å¼•è§„çº¦"><a href="#äºŒã€ç´¢å¼•è§„çº¦" class="headerlink" title="äºŒã€ç´¢å¼•è§„çº¦"></a>äºŒã€ç´¢å¼•è§„çº¦</h4><ol><li>ã€å¼ºåˆ¶ã€‘ä¸šåŠ¡ä¸Šå…·æœ‰å”¯ä¸€ç‰¹æ€§çš„å­—æ®µï¼Œå³ä½¿æ˜¯ç»„åˆå­—æ®µï¼Œä¹Ÿå¿…é¡»å»ºæˆå”¯ä¸€ç´¢å¼•<br>è¯´æ˜ï¼šä¸è¦ä»¥ä¸ºå”¯ä¸€ç´¢å¼•å½±å“äº† insert é€Ÿåº¦ï¼Œè¿™ä¸ªé€Ÿåº¦æŸè€—å¯ä»¥å¿½ç•¥ï¼Œä½†æé«˜æŸ¥æ‰¾é€Ÿåº¦æ˜¯æ˜æ˜¾çš„ï¼›å¦å¤–ï¼Œå³ä½¿åœ¨åº”ç”¨å±‚åšäº†éå¸¸å®Œå–„çš„æ ¡éªŒæ§åˆ¶ï¼Œåªè¦æ²¡æœ‰å”¯ä¸€ç´¢å¼•ï¼Œæ ¹æ®å¢¨è²å®šå¾‹ï¼Œå¿…ç„¶æœ‰è„æ•°æ®äº§ç”Ÿ</li><li>ã€å¼ºåˆ¶ã€‘é¡µé¢æœç´¢ä¸¥ç¦å·¦æ¨¡ç³Šæˆ–è€…å…¨æ¨¡ç³Š</li><li>ã€æ¨èã€‘å¦‚æœæœ‰ order by çš„åœºæ™¯ï¼Œè¯·æ³¨æ„åˆ©ç”¨ç´¢å¼•çš„æœ‰åºæ€§ã€‚order by æœ€åçš„å­—æ®µæ˜¯ç»„åˆç´¢å¼•çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”æ”¾åœ¨ç´¢å¼•ç»„åˆé¡ºåºçš„æœ€åï¼Œé¿å…å‡ºç° file_sort çš„æƒ…å†µï¼Œå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚<br>æ­£ä¾‹ï¼šwhere a&#x3D;? and b&#x3D;? order by c; ç´¢å¼•ï¼ša_b_c<br>åä¾‹ï¼šç´¢å¼•å¦‚æœå­˜åœ¨èŒƒå›´æŸ¥è¯¢ï¼Œé‚£ä¹ˆç´¢å¼•æœ‰åºæ€§æ— æ³•åˆ©ç”¨ï¼Œå¦‚ï¼šWHERE a&gt;10 ORDER BY b; ç´¢å¼• a_b æ— æ³•æ’åº</li><li>ã€æ¨èã€‘åˆ©ç”¨å»¶è¿Ÿå…³è”æˆ–è€…å­æŸ¥è¯¢ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯<br>è¯´æ˜ï¼šMySQL å¹¶ä¸æ˜¯è·³è¿‡ offset è¡Œï¼Œè€Œæ˜¯å– offset+N è¡Œï¼Œç„¶åè¿”å›æ”¾å¼ƒå‰ offset è¡Œï¼Œè¿”å› N è¡Œï¼Œé‚£å½“offset ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæ•ˆç‡å°±éå¸¸çš„ä½ä¸‹ï¼Œè¦ä¹ˆæ§åˆ¶è¿”å›çš„æ€»é¡µæ•°ï¼Œè¦ä¹ˆå¯¹è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„é¡µæ•°è¿›è¡Œ SQLæ”¹å†™<br>æ­£ä¾‹ï¼šå…ˆå¿«é€Ÿå®šä½éœ€è¦è·å–çš„ id æ®µï¼Œç„¶åå†å…³è”ï¼š<pre class="line-numbers language-none"><code class="language-none">SELECT t1.* FROM è¡¨ 1 as t1, (select id from è¡¨ 1 where æ¡ä»¶ LIMIT 100000,20 ) as t2 where t1.id&#x3D;t2.id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>ã€æ¨èã€‘SQL æ€§èƒ½ä¼˜åŒ–çš„ç›®æ ‡ï¼šè‡³å°‘è¦è¾¾åˆ° range çº§åˆ«ï¼Œè¦æ±‚æ˜¯ ref çº§åˆ«ï¼Œå¦‚æœå¯ä»¥æ˜¯ constsæœ€å¥½<br>è¯´æ˜ï¼š<br>1ï¼‰ consts å•è¡¨ä¸­æœ€å¤šåªæœ‰ä¸€ä¸ªåŒ¹é…è¡Œï¼ˆä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•ï¼‰ï¼Œåœ¨ä¼˜åŒ–é˜¶æ®µå³å¯è¯»å–åˆ°æ•°æ®ã€‚<br>2ï¼‰ ref æŒ‡çš„æ˜¯ä½¿ç”¨æ™®é€šçš„ç´¢å¼•ï¼ˆnormal indexï¼‰ã€‚<br>3ï¼‰ range å¯¹ç´¢å¼•è¿›è¡ŒèŒƒå›´æ£€ç´¢ã€‚<br>åä¾‹ï¼šexplain è¡¨çš„ç»“æœï¼Œtype&#x3D;indexï¼Œç´¢å¼•ç‰©ç†æ–‡ä»¶å…¨æ‰«æï¼Œé€Ÿåº¦éå¸¸æ…¢ï¼Œè¿™ä¸ª index çº§åˆ«æ¯”rangeè¿˜ä½ï¼Œä¸å…¨è¡¨æ‰«ææ˜¯å°å·«è§å¤§å·«</li><li>ã€æ¨èã€‘å»ºç»„åˆç´¢å¼•çš„æ—¶å€™ï¼ŒåŒºåˆ†åº¦æœ€é«˜çš„åœ¨æœ€å·¦è¾¹<br>æ­£ä¾‹ï¼šå¦‚æœ where a&#x3D;? and b&#x3D;?ï¼Œa åˆ—çš„å‡ ä¹æ¥è¿‘äºå”¯ä¸€å€¼ï¼Œé‚£ä¹ˆåªéœ€è¦å•å»º idx_a ç´¢å¼•å³å¯<br>è¯´æ˜ï¼šå­˜åœ¨éç­‰å·å’Œç­‰å·æ··åˆåˆ¤æ–­æ¡ä»¶æ—¶ï¼Œåœ¨å»ºç´¢å¼•æ—¶ï¼Œè¯·æŠŠç­‰å·æ¡ä»¶çš„åˆ—å‰ç½®ã€‚å¦‚ï¼šwhere c&gt;? and d&#x3D;? é‚£ä¹ˆå³ä½¿ c çš„åŒºåˆ†åº¦æ›´é«˜ï¼Œä¹Ÿå¿…é¡»æŠŠ d æ”¾åœ¨ç´¢å¼•çš„æœ€å‰åˆ—ï¼Œå³å»ºç«‹ç»„åˆç´¢å¼• idx_d_c</li><li>ã€æ¨èã€‘é˜²æ­¢å› å­—æ®µç±»å‹ä¸åŒé€ æˆçš„éšå¼è½¬æ¢ï¼Œå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li></ol><h4 id="ä¸‰ã€SQLè¯­å¥"><a href="#ä¸‰ã€SQLè¯­å¥" class="headerlink" title="ä¸‰ã€SQLè¯­å¥"></a>ä¸‰ã€SQLè¯­å¥</h4><ol><li>ã€æ¨èã€‘ä¸è¦ä½¿ç”¨ count(åˆ—å)æˆ– count(å¸¸é‡)æ¥æ›¿ä»£ count(<em>)ï¼Œcount(</em>)æ˜¯ SQL92 å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œè·Ÿæ•°æ®åº“æ— å…³ï¼Œè·Ÿ NULL å’Œé NULL æ— å…³<br>è¯´æ˜ï¼š<code>count(*)</code>ä¼šç»Ÿè®¡å€¼ä¸º NULL çš„è¡Œï¼Œè€Œ count(åˆ—å)ä¸ä¼šç»Ÿè®¡æ­¤åˆ—ä¸º NULL å€¼çš„è¡Œ</li><li>ã€å¼ºåˆ¶ã€‘count(distinct col) è®¡ç®—è¯¥åˆ—é™¤ NULL ä¹‹å¤–çš„ä¸é‡å¤è¡Œæ•°ï¼Œæ³¨æ„ count(distinct col1, col2) å¦‚æœå…¶ä¸­ä¸€åˆ—å…¨ä¸º NULLï¼Œé‚£ä¹ˆå³ä½¿å¦ä¸€åˆ—æœ‰ä¸åŒçš„å€¼ï¼Œä¹Ÿè¿”å›ä¸º 0</li><li>ã€å¼ºåˆ¶ã€‘å½“æŸä¸€åˆ—çš„å€¼å…¨æ˜¯ NULL æ—¶ï¼Œcount(col)çš„è¿”å›ç»“æœä¸º 0ï¼Œä½† sum(col)çš„è¿”å›ç»“æœä¸ºNULLï¼Œå› æ­¤ä½¿ç”¨ sum()æ—¶éœ€æ³¨æ„ NPE é—®é¢˜<br>æ­£ä¾‹ï¼šå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥é¿å… sum çš„ NPE é—®é¢˜ï¼šSELECT IFNULL(SUM(column), 0) FROM table</li><li>ã€å¼ºåˆ¶ã€‘ä½¿ç”¨ ISNULL()æ¥åˆ¤æ–­æ˜¯å¦ä¸º NULL å€¼<br>è¯´æ˜ï¼šNULL ä¸ä»»ä½•å€¼çš„ç›´æ¥æ¯”è¾ƒéƒ½ä¸º NULL</li><li>ã€å¼ºåˆ¶ã€‘ç¦æ­¢ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå­˜å‚¨è¿‡ç¨‹éš¾ä»¥è°ƒè¯•å’Œæ‰©å±•ï¼Œæ›´æ²¡æœ‰ç§»æ¤æ€§</li><li>ã€æ¨èã€‘in æ“ä½œèƒ½é¿å…åˆ™é¿å…ï¼Œè‹¥å®åœ¨é¿å…ä¸äº†ï¼Œéœ€è¦ä»”ç»†è¯„ä¼° in åè¾¹çš„é›†åˆå…ƒç´ æ•°é‡ï¼Œæ§åˆ¶åœ¨ 1000 ä¸ªä¹‹å†…</li><li>ã€å‚è€ƒã€‘TRUNCATE TABLE æ¯” DELETE é€Ÿåº¦å¿«ï¼Œä¸”ä½¿ç”¨çš„ç³»ç»Ÿå’Œäº‹åŠ¡æ—¥å¿—èµ„æºå°‘ï¼Œä½† TRUNCATEæ— äº‹åŠ¡ä¸”ä¸è§¦å‘ triggerï¼Œæœ‰å¯èƒ½é€ æˆäº‹æ•…ï¼Œæ•…ä¸å»ºè®®åœ¨å¼€å‘ä»£ç ä¸­ä½¿ç”¨æ­¤è¯­å¥</li><li>ã€å¼ºåˆ¶ã€‘deleteã€updateç­‰SQLè¯­å¥ä¸­å¿…é¡»åŒ…å«whereæ¡ä»¶ï¼Œå‡å°æ•°æ®å½±å“èŒƒå›´</li><li>ã€æ¨èã€‘å°½é‡é¿å…ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠå­æŸ¥è¯¢ä¼˜åŒ–ä¸ºjoinæ“ä½œ<br> è¯´æ˜ï¼š<ul><li>å­æŸ¥è¯¢çš„ç»“æœé›†æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼Œé€šå¸¸å­æŸ¥è¯¢çš„ç»“æœé›†ä¼šè¢«å­˜å‚¨åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œä¸è®ºæ˜¯å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨éƒ½ä¸ä¼šå­˜åœ¨ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢æ€§èƒ½ä¼šå—åˆ°ä¸€å®šçš„å½±å“</li><li>ç‰¹åˆ«æ˜¯å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ä¹Ÿå°±è¶Šå¤§</li><li>ç”±äºå­æŸ¥è¯¢ä¼šäº§ç”Ÿå¤§é‡çš„ä¸´æ—¶è¡¨ä¹Ÿæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ä¼šæ¶ˆè€—è¿‡å¤šçš„CPUå’ŒIOèµ„æºï¼Œäº§ç”Ÿå¤§é‡çš„æ…¢æŸ¥è¯¢</li></ul></li><li>ã€æ¨èã€‘WHEREä»å¥ä¸­å°½é‡ä¸è¦å¯¹åˆ—è¿›è¡Œå‡½æ•°è½¬æ¢å’Œè®¡ç®—ï¼Œå¯ä»¥é€šè¿‡ç¨‹åºä¸­è½¬æ¢åé€šè¿‡å‚æ•°ä¼ å…¥<br>æ­£ä¾‹ï¼šwhere create_time &gt;&#x3D; â€˜20220101â€™ and create_time &lt; â€˜20220102â€™<br>åä¾‹ï¼šwhere date(create_time)&#x3D;â€™20220101â€™</li><li>ã€æ¨èã€‘åœ¨æ˜æ˜¾ä¸ä¼šæœ‰é‡å¤å€¼æ—¶ä½¿ç”¨UNION ALLè€Œä¸æ˜¯UNION<br>è¯´æ˜ï¼š<ul><li>UNIONä¼šæŠŠä¸¤ä¸ªç»“æœé›†çš„æ‰€æœ‰æ•°æ®æ”¾åˆ°ä¸´æ—¶è¡¨ä¸­åå†è¿›è¡Œå»é‡æ“ä½œ</li><li>UNION ALLä¸ä¼šå†å¯¹ç»“æœé›†è¿›è¡Œå»é‡æ“ä½œ</li></ul></li><li>ã€æ¨èã€‘æ‹†åˆ†å¤æ‚çš„å¤§SQLä¸ºå¤šä¸ªå°SQL<br>è¯´æ˜ï¼š<ul><li>å¤§SQLåœ¨é€»è¾‘ä¸Šæ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å ç”¨å¤§é‡CPUè¿›è¡Œè®¡ç®—çš„SQL</li><li>SQLæ‹†åˆ†åå¯ä»¥é€šè¿‡å¹¶è¡Œæ‰§è¡Œæ¥æé«˜å¤„ç†æ•ˆç‡</li></ul></li><li>ã€å¼ºåˆ¶ã€‘è¶…100ä¸‡è¡Œçš„æ‰¹é‡å†™ï¼ˆUPDATEã€DELETEã€INSERTï¼‰æ“ä½œï¼Œå¿…é¡»è¦åˆ†æ‰¹å¤šæ¬¡è¿›è¡Œæ“ä½œ<br>è¯´æ˜ï¼š<ul><li>binlogæ—¥å¿—ä¸ºrowæ ¼å¼æ—¶ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—</li><li>å®¹æ˜“äº§ç”Ÿå¤§äº‹åŠ¡æ“ä½œ</li><li>binlogæ—¥å¿—ä¸ºrowæ ¼å¼æ—¶ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—</li></ul></li><li>ã€æ¨èã€‘æ•°æ®é‡è¶…è¿‡50ä¸‡æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨NOT EXISTæ›¿ä»£NOT IN</li></ol><h4 id="å››ã€ORMæ˜ å°„"><a href="#å››ã€ORMæ˜ å°„" class="headerlink" title="å››ã€ORMæ˜ å°„"></a>å››ã€ORMæ˜ å°„</h4><ol><li>ã€å¼ºåˆ¶ã€‘åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œä¸€å¾‹ä¸è¦ä½¿ç”¨ * ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œéœ€è¦å“ªäº›å­—æ®µå¿…é¡»æ˜ç¡®å†™æ˜<br> è¯´æ˜ï¼š<ul><li>å¢åŠ æŸ¥è¯¢åˆ†æå™¨è§£ææˆæœ¬ã€‚</li><li>å¢å‡å­—æ®µå®¹æ˜“ä¸ resultMap é…ç½®ä¸ä¸€è‡´</li><li>æ— ç”¨å­—æ®µå¢åŠ ç½‘ç»œæ¶ˆè€—ï¼Œå°¤å…¶æ˜¯ text ç±»å‹çš„å­—æ®µ</li></ul></li><li>ã€æ¨èã€‘sql.xml é…ç½®å‚æ•°å°½é‡ä½¿ç”¨#{}ï¼Œå°½é‡ä¸è¦ä½¿ç”¨${}ï¼Œ æ­¤ç§æ–¹å¼å®¹æ˜“å‡ºç° SQL æ³¨å…¥ï¼Œå¦‚æœè¦ä½¿ç”¨ä¹Ÿéœ€è¦åšæ‹¼æ¥æ ¡éªŒ</li></ol><h4 id="äº”ã€å…¶ä»–"><a href="#äº”ã€å…¶ä»–" class="headerlink" title="äº”ã€å…¶ä»–"></a>äº”ã€å…¶ä»–</h4><ol><li>ã€æ¨èã€‘å†™å¥½çš„SQLï¼Œä¹ æƒ¯æ€§åœ°explainæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’</li><li>ã€æ¨èã€‘ä¸å»ºè®®ä½¿ç”¨å¤–é”®çº¦æŸï¼ˆforeign keyï¼‰</li><li>ã€æ¨èã€‘å»ºè®®ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œ</li><li>ã€æ¨èã€‘ç¨‹åºè¿æ¥ä¸åŒçš„æ•°æ®åº“ä½¿ç”¨ä¸åŒçš„è´¦å·<br>è¯´æ˜ï¼šä¸ºæ•°æ®åº“è¿ç§»å’Œåˆ†åº“åˆ†è¡¨ç•™å‡ºä½™åœ°ï¼›é™ä½ä¸šåŠ¡è€¦åˆåº¦ï¼›é¿å…æƒé™è¿‡å¤§è€Œäº§ç”Ÿçš„å®‰å…¨é£é™©</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisä½¿ç”¨è§„èŒƒ</title>
      <link href="/2022/01/07/redis-shi-yong-gui-fan/"/>
      <url>/2022/01/07/redis-shi-yong-gui-fan/</url>
      
        <content type="html"><![CDATA[<p>æ ¹æ®æ—¥å¸¸åœ¨ä½¿ç”¨redisæ—¶å½¢æˆçš„ï¼Œæ¬¢è¿å¤§å®¶è¡¥å……</p><h1 id="Redisä½¿ç”¨è§„èŒƒ"><a href="#Redisä½¿ç”¨è§„èŒƒ" class="headerlink" title="Redisä½¿ç”¨è§„èŒƒ"></a>Redisä½¿ç”¨è§„èŒƒ</h1><h4 id="ä¸€ã€keyã€valueè§„èŒƒ"><a href="#ä¸€ã€keyã€valueè§„èŒƒ" class="headerlink" title="ä¸€ã€keyã€valueè§„èŒƒ"></a>ä¸€ã€keyã€valueè§„èŒƒ</h4><ol><li>ã€å¼ºåˆ¶ã€‘å¿…é¡»ä»¥ä¸šåŠ¡å(æˆ–æ•°æ®åº“å)ä¸ºå‰ç¼€ï¼Œç”¨å†’å·:åˆ†éš”ï¼Œæ¯”å¦‚ ä¸šåŠ¡å:è¡¨å:id</li><li>ã€å¼ºåˆ¶ã€‘keyè®¾è®¡å¿…é¡»ç®€æ´<ul><li>ä¿è¯è¯­ä¹‰çš„å‰æä¸‹ï¼Œæ§åˆ¶keyçš„é•¿åº¦ï¼Œå½“keyè¾ƒå¤šæ—¶ï¼Œå†…å­˜å ç”¨ä¹Ÿä¸å®¹å¿½è§†ã€‚</li><li>ä¸è¦åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼šç©ºæ ¼ã€æ¢è¡Œã€å•åŒå¼•å·ä»¥åŠå…¶ä»–è½¬ä¹‰å­—ç¬¦</li></ul></li><li>ã€å¼ºåˆ¶ã€‘stringç±»å‹æ§åˆ¶åœ¨10KBä»¥å†…<br>è¯´æ˜ï¼šé˜²æ­¢ç½‘å¡æµé‡ã€æ…¢æŸ¥è¯¢</li><li>ã€æ¨èã€‘hashã€listã€setã€zsetå…ƒç´ ä¸ªæ•°ä¸è¦è¶…è¿‡1ä¸‡ã€‚å¦‚æœæ•°é‡è¿‡å¤§ï¼Œå¯ä»¥åˆ†æˆå¤šä¸ªkey</li><li>ã€æ¨èã€‘ä¸è¦ä½¿ç”¨delåˆ é™¤éå­—ç¬¦ä¸²çš„bigkey, ä½¿ç”¨hscanã€sscanã€zscanæ–¹å¼æ¸è¿›å¼åˆ é™¤<br>è¯´æ˜ï¼šå› ä¸ºæ—¶é—´å¤æ‚åº¦æ˜¯ O(N), hscanã€sscanã€zscanæ–¹å¼æ¸è¿›å¼åˆ é™¤<ul><li>å¦‚æœæ˜¯Hashç±»å‹çš„å¤§Keyï¼Œæ¨èä½¿ç”¨hscan + hdel</li><li>å¦‚æœæ˜¯Listç±»å‹çš„å¤§Keyï¼Œæ¨èä½¿ç”¨ltrim</li><li>å¦‚æœæ˜¯Setç±»å‹çš„å¤§Keyï¼Œæ¨èä½¿ç”¨sscan + srem</li><li>å¦‚æœæ˜¯SortedSetç±»å‹çš„å¤§Keyï¼Œæ¨èä½¿ç”¨zscan + zrem</li></ul></li><li>ã€æ¨èã€‘å°½é‡è®¾ç½®è¿‡æœŸæ—¶é—´<br>è¯´æ˜ï¼šæ¡ä»¶å…è®¸å¯ä»¥æ‰“æ•£è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢é›†ä¸­è¿‡æœŸï¼Œä¸è¿‡æœŸçš„æ•°æ®é‡ç‚¹å…³æ³¨idletimeã€‚é‡åˆ°å¤§bigkey è¿‡æœŸï¼Œä¼šè§¦å‘delï¼Œé€ æˆä¸»çº¿ç¨‹é˜»å¡</li></ol><h4 id="äºŒã€å‘½ä»¤è§„èŒƒ"><a href="#äºŒã€å‘½ä»¤è§„èŒƒ" class="headerlink" title="äºŒã€å‘½ä»¤è§„èŒƒ"></a>äºŒã€å‘½ä»¤è§„èŒƒ</h4><ol><li>ã€å¼ºåˆ¶ã€‘ç¦ç”¨keys<br>è¯´æ˜ï¼šKeys å‘½ä»¤æ•ˆç‡æä½ï¼Œå±äº O(N)æ“ä½œï¼Œä¼šé˜»å¡å…¶ä»–æ­£å¸¸å‘½ä»¤ï¼Œåœ¨ cluster ä¸Šï¼Œä¼šæ˜¯ç¾éš¾æ€§çš„æ“ä½œ</li><li>ã€å¼ºåˆ¶ã€‘ç¦ç”¨flushallã€flushdb<br>è¯´æ˜ï¼šå‘½ä»¤ä¼šæ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Œå±äºé«˜å±æ“ä½œ</li><li>ã€å¼ºåˆ¶ã€‘ä¸¥ç¦å¯¹ zset çš„ä¸è®¾èŒƒå›´æ“ä½œ</li><li>ã€å¼ºåˆ¶ã€‘ZRANGEã€ ZRANGEBYSCOREç­‰å¤šä¸ªæ“ä½œ ZSET çš„å‡½æ•°ï¼Œä¸¥ç¦ä½¿ç”¨ ZRANGE myzset 0 -1 ç­‰è¿™ç§ä¸è®¾ç½®èŒƒå›´çš„æ“ä½œã€‚å¦‚è¦ä½¿ç”¨è¯·æŒ‡å®šèŒƒå›´ï¼Œå¦‚ ZRANGE myzset 0 100ã€‚å¦‚ä¸ç¡®å®šé•¿åº¦ï¼Œå¯ä½¿ç”¨ ZCARD åˆ¤æ–­é•¿åº¦</li><li>ã€å¼ºåˆ¶ã€‘ä¸¥ç¦å¯¹å¤§æ•°æ®é‡ Key ä½¿ç”¨ HGETALL</li><li>ã€æ¨èã€‘è°¨æ…ä½¿ç”¨ sunion, sinter, sdiffç­‰ä¸€äº›èšåˆæ“ä½œï¼Œå¦‚æœè¦ç”¨ï¼Œéœ€è¦æå‰æŠ¥å¤‡</li></ol><h4 id="ä¸‰ã€å…¶ä»–ä½¿ç”¨è¦æ±‚"><a href="#ä¸‰ã€å…¶ä»–ä½¿ç”¨è¦æ±‚" class="headerlink" title="ä¸‰ã€å…¶ä»–ä½¿ç”¨è¦æ±‚"></a>ä¸‰ã€å…¶ä»–ä½¿ç”¨è¦æ±‚</h4><ol><li>ã€æ¨èã€‘å¿…è¦æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨monitorå‘½ä»¤ï¼Œä½†åœ¨ç”Ÿäº§ä¸Šè¦æ³¨æ„ä¸è¦é•¿æ—¶é—´ä½¿ç”¨</li><li>ã€æ¨èã€‘rediså®ä¾‹é»˜è®¤æ”¯æŒ16ä¸ªæ•°æ®åº“ï¼Œå¯ä»¥æŠŠä¸åŒçš„ä¸šåŠ¡åˆ†åˆ°ä¸åŒçš„åº“ã€‚ä½†å°½é‡ä¸æ˜¯åˆ‡æ¢åº“(å³selectåº“)ï¼Œå¦‚æœéœ€è¦è·¨åº“çš„é€šè¿‡keyåæ¥å¤„ç†</li><li>ã€æ¨èã€‘ å¦‚æœæœ‰æ‰¹é‡æ“ä½œï¼Œä¼˜å…ˆä½¿ç”¨mgetã€msetæˆ–pipelineï¼Œæé«˜æ•ˆç‡ï¼Œä½†è¦æ³¨æ„æ§åˆ¶ä¸€æ¬¡æ‰¹é‡æ“ä½œçš„å…ƒç´ ä¸ªæ•°</li><li>ã€å¼ºåˆ¶ã€‘ä¸è¦åœ¨luaè„šæœ¬ä¸­ä½¿ç”¨æ¯”è¾ƒè€—æ—¶çš„ä»£ç ï¼Œæ¯”å¦‚é•¿æ—¶é—´çš„sleepã€å¤§å¾ªç¯ç­‰ï¼Œ luaè„šæœ¬çš„æ‰§è¡Œè¶…æ—¶æ—¶é—´ä¸º5ç§’é’Ÿ</li><li>ã€æ¨èã€‘åªç”¨æ¥ä¿å­˜çƒ­æ•°æ®ï¼Œä¸å‡†å½“ä½œè½åœ°æ•°æ®åº“ä½¿ç”¨ï¼Œå³redisä¸­çš„æ•°æ®éœ€è¦åœ¨å…¶ä»–æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°</li></ol><h4 id="å››ã€é›†ç¾¤ä½¿ç”¨"><a href="#å››ã€é›†ç¾¤ä½¿ç”¨" class="headerlink" title="å››ã€é›†ç¾¤ä½¿ç”¨"></a>å››ã€é›†ç¾¤ä½¿ç”¨</h4><p>Redisé›†ç¾¤ç‰ˆæœ¬åœ¨ä½¿ç”¨Luaä¸Šæœ‰ç‰¹æ®Šè¦æ±‚</p><ol><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰keyéƒ½åº”è¯¥ç”± KEYS æ•°ç»„æ¥ä¼ é€’ï¼Œredis.call&#x2F;pcall é‡Œé¢è°ƒç”¨çš„rediså‘½ä»¤ï¼Œkeyçš„ä½ç½®ï¼Œå¿…é¡»æ˜¯KEYS array, å¦åˆ™ç›´æ¥è¿”å›errorï¼Œâ€-ERR bad lua script for redis cluster, all the keys that the script uses should be passed using the KEYS arrayâ€</li><li>ã€å¼ºåˆ¶ã€‘æ‰€æœ‰keyï¼Œå¿…é¡»åœ¨1ä¸ªslotä¸Šï¼Œå¦åˆ™ç›´æ¥è¿”å›error, â€œ-ERR eval&#x2F;evalsha command keys must in same slotâ€<br>è¯´æ˜ï¼šredisåœ¨ä½¿ç”¨hashç®—æ³•å°†é”®æ˜ å°„åˆ°slotæ—¶ï¼Œåªä¼šè®¡ç®—{}é‡Œé¢çš„å†…å®¹ï¼Œè‹¥{}å†…çš„å†…å®¹ç›¸åŒï¼Œåˆ™å°†é”®æ˜ å°„åˆ°åŒä¸€ä¸ªslot</li></ol><h4 id="äº”ã€ä»£ç ä½¿ç”¨"><a href="#äº”ã€ä»£ç ä½¿ç”¨" class="headerlink" title="äº”ã€ä»£ç ä½¿ç”¨"></a>äº”ã€ä»£ç ä½¿ç”¨</h4><ol><li>ã€æ¨èã€‘valueä¸ºstringæ—¶ï¼Œåºåˆ—åŒ–å°½é‡å°‘é‡‡ç”¨JDKè‡ªå¸¦çš„åºåˆ—åŒ–æ–¹å¼ï¼ˆJdkSerializationRedisSerializerï¼‰ï¼Œå› ä¸ºåºåˆ—åŒ–é€Ÿåº¦æ…¢</li><li>ã€å¼ºåˆ¶ã€‘ç›®å‰å·²ç»æä¾›puzzle-cacheå…¬å…±ç»„ä»¶ï¼Œå¼€å‘è¿‡ç¨‹ä¸­å°½é‡ä½¿ç”¨æ­¤ç»„ä»¶ï¼Œç»Ÿä¸€åºåˆ—åŒ–æ–¹å¼</li><li>ã€å¼ºåˆ¶ã€‘åŒä¸€å·¥ç¨‹ä¸­ï¼Œç”±ç»Ÿä¸€çš„ç±»ä¿ç®¡keyï¼Œä¸å‡†åœ¨ä¸šåŠ¡ç±»ä¸­ç§è‡ªå®šä¹‰key</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§„èŒƒ </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å°çš„æ€»ç»“</title>
      <link href="/2021/05/26/zhong-tai-de-zong-jie/"/>
      <url>/2021/05/26/zhong-tai-de-zong-jie/</url>
      
        <content type="html"><![CDATA[<p>åŸå…¬å¸ç»“åˆä¸šæ€æ­å»ºäº†ä¸€å¥—å•†åŸçš„ä¸šåŠ¡ä¸­å°ï¼Œæœ‰äº†è¿™å¥—ä¸­å°åå¯ä»¥å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªæ–°çš„åº”ç”¨åº”å¯¹å¸‚åœºçš„å¤šå˜å’Œå…¬å¸ä¸šæ€çš„æ‰©å±•ï¼Œå¯¹æ­¤ç»“åˆç½‘ä¸Šæ–‡æ¡£ã€è§†é¢‘æ€»ç»“çš„ä¸€äº›çœ‹æ³•</p><h2 id="ä¸­å°ä»·å€¼"><a href="#ä¸­å°ä»·å€¼" class="headerlink" title="ä¸­å°ä»·å€¼"></a>ä¸­å°ä»·å€¼</h2><p>ä¸­å°æ˜¯ä¸€ç§ç»„ç»‡å¿ƒæ™ºï¼Œä¹Ÿæ˜¯ä¸€ç§ç»è¥ç†å¿µï¼Œæä¾›å…¬å¸çš„ç»„ç»‡æ•ˆç‡ã€ååŒæ•ˆç‡ã€è¿è¥æ•ˆç‡</p><h2 id="ä¸­å°æ€»ç»“"><a href="#ä¸­å°æ€»ç»“" class="headerlink" title="ä¸­å°æ€»ç»“"></a>ä¸­å°æ€»ç»“</h2><ol><li>ä¸­å°å¹¶ä¸æ€»æ˜¯èƒ½å¤Ÿæç‚¼å…±æ€§éœ€æ±‚<br> 1.1 ä¸­å°å’Œä¸šåŠ¡æ–¹å¤©ç„¶å­˜åœ¨å…±æ€§éœ€æ±‚çš„ä¸åŒè¯‰æ±‚ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼Œä¸­å°å¼€å§‹ä¼šè®¤ä¸ºä¸æ˜¯å…±æ€§éœ€æ±‚ï¼Œå› ä¸ºæ˜¯æ–°æå‡ºæ¥çš„ï¼Œè€Œä¸šåŠ¡æ–¹è®¤ä¸ºè¿™ä¸ªå¯ä»¥æç‚¼æˆä¸€äº›å…±æ€§éœ€æ±‚ï¼Œä¸€ä¸ªæ–°éœ€æ±‚å¾ˆéš¾åˆ¤æ–­ä¸ºæ˜¯å¦æ˜¯å…±æ€§éœ€æ±‚ã€‚å¦‚æœå…ˆæŒ‰ç‰¹æ€§éœ€æ±‚ï¼Œå¯èƒ½ä¼šå…ˆå¼€å‘ï¼Œç„¶åå…¶ä»–ä¸šåŠ¡æ–¹æå‡ºæ¥ååˆæç‚¼æˆå…±æ€§éœ€æ±‚ã€‚</li><li>ä¸­å°æŠ±å¤§ä¸šåŠ¡çš„å¤§è…¿ï¼Œå°ä¸šåŠ¡æŠ±å¤§ä¸šåŠ¡å¤§è…¿<br> 2.1 ä¸šåŠ¡ä¼šåˆ†ä¼˜å…ˆçº§ï¼Œä¸­å°ä¼˜å…ˆæ»¡è¶³å¤§ä¸šåŠ¡<br> 2.2 ä¸­å°çš„KPIåªèƒ½é€šè¿‡å¤§ä¸šåŠ¡å®ç°<br> 2.3 å°ä¸šåŠ¡ä¹‹ç—›ï¼Œâ€œä½ è¿™ä¸ªéœ€æ±‚ä¸é€šç”¨ï¼Œä¸æ»¡è¶³å…±æ€§â€</li><li>ä¸­å°çš„è½®å­ä¹Ÿä¼šå˜åŒ–ï¼Œä¸šåŠ¡è¢«åŠ¨å‡çº§<br> 3.1  ä¸­å°ç³»ç»Ÿçš„æ¶æ„å’Œæ¥å£éœ€è¦ä¸æ–­æ¼”è¿›ã€‚å¦‚æœ<br> 3.2  å…ˆç‰¹æ€§å†å…±æ€§ï¼Œè€ä¸šåŠ¡å·²æœ‰åŠŸèƒ½éœ€è¦åˆ‡æ¢<br> 3.3 ä¸šåŠ¡è¢«åŠ¨å‡çº§ï¼Œå‡çº§é¢‘ç‡æ¯”è‡ªå·±ç‹¬ç«‹å‘å±•è¦é«˜</li><li>ä¸­å°æ˜¯æŸç±»ä¸šåŠ¡çš„ä¸­å°ï¼Œä¸æ˜¯æ‰€æœ‰ä¸šåŠ¡çš„ä¸­å°<br> 4.1 ä¸šåŠ¡ç›¸ä¼¼æ‰æœ‰å…±æ€§éœ€æ±‚ï¼Œä¸šåŠ¡å·®å¼‚è¶Šå¤§ä¸­å°ä»·å€¼è¶Šå°</li><li>è¦æŠŠæ¶æ„ã€æ¥å£ã€æ¨¡å‹ç»Ÿä¸€</li></ol><h2 id="ä¸­å°ã€å¹³å°åŒºåˆ«"><a href="#ä¸­å°ã€å¹³å°åŒºåˆ«" class="headerlink" title="ä¸­å°ã€å¹³å°åŒºåˆ«"></a>ä¸­å°ã€å¹³å°åŒºåˆ«</h2><p>å¹³å°æ˜¯å’Œä¸šåŠ¡æ— å…³çš„<br>ä¸­å°å°†ä¸šåŠ¡é‡Œé¢å…±æ€§æŠ½å–å‡ºæ¥ï¼Œå½¢æˆä¸šåŠ¡çš„æœåŠ¡</p><h2 id="ä¸­å°ã€å¾®æœåŠ¡åŒºåˆ«"><a href="#ä¸­å°ã€å¾®æœåŠ¡åŒºåˆ«" class="headerlink" title="ä¸­å°ã€å¾®æœåŠ¡åŒºåˆ«"></a>ä¸­å°ã€å¾®æœåŠ¡åŒºåˆ«</h2><p>ä¸­å°å¯ä»¥é€šè¿‡å¾®æœåŠ¡å»å®ç°ï¼Œå¾®æœåŠ¡å¯ä»¥é€šè¿‡æ¶æ„å»å®ç°ï¼Œä¸­å°æ˜¯ä¸€ç§ç»„ç»‡ä¸Šçš„æ¦‚å¿µ</p><h2 id="ä¸­å°å»ºè®®"><a href="#ä¸­å°å»ºè®®" class="headerlink" title="ä¸­å°å»ºè®®"></a>ä¸­å°å»ºè®®</h2><ol><li>å…ˆåšå¥½<code>æŠ€æœ¯å¹³å°</code></li><li>ä¸­å°ä¸æ˜¯é“¶å¼¹ã€‚è‡³å°‘æœ‰è¶…è¿‡3ä¸ªç›¸ä¼¼å¹³è¡Œçš„ä¸šåŠ¡çº¿æ‰è€ƒè™‘ä¸­å°</li><li>ä¸è¦ä¸€å¼€å§‹å°±åšä¸€ä¸ªå¤§è€Œå…¨çš„å¹³å°ï¼Œå…ˆæ‰¾ä¸€ä¸ªå­åŸŸè¯•ç‚¹ï¼›ä¸è¦è¯•å›¾åšä¸€ä¸ªæ»¡è¶³æ‰€æœ‰ä¸šåŠ¡çº¿çš„ä¸­å°</li><li>ä¸­å°çš„é¢†å¯¼è¦å’Œä¸šåŠ¡çº¿åŒçº§åˆ«çš„é«˜å±‚ï¼Œä¸ç„¶è¦æˆä¸ºä¸šåŠ¡çº¿çš„å¤–åŒ…å›¢é˜Ÿ</li><li>åšå¥½ä¸­å°çš„èµ„æºæŠ•å…¥ç»Ÿè®¡å’Œåˆ†æï¼Œè¿™ä¸ªå¾ˆéªŒè¯„ä¼°</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
